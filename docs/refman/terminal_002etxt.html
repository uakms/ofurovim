<!DOCTYPE html>
<html lang="ja">
<!-- Created by GNU Texinfo 6.5, http://www.gnu.org/software/texinfo/ -->
<head>

<title>terminal.txt (Vim Reference Manual)</title>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<meta name="description" content="terminal.txt (Vim Reference Manual)">
<meta name="keywords" content="terminal.txt (Vim Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2any">
<link href="Mu-Ci-.html#g_t_76ee_6b21" rel="start" title="目次">
<link href="Indexes-CP.html#Indexes-CP" rel="index" title="Indexes CP">
<link href="Mu-Ci-.html#g_t_76ee_6b21" rel="up" title="目次">
<link href="popup_002etxt.html#popup_002etxt" rel="next" title="popup.txt">
<link href="term_002etxt.html#term_002etxt" rel="prev" title="term.txt">
<style>
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>
<link rel="stylesheet" type="text/css" href="style.css">


</head>

<body lang="ja">
<a name="terminal_002etxt"></a>
<div class="header">
<p>
Up: <a href="Mu-Ci-.html#g_t_76ee_6b21" accesskey="u" rel="up">目次</a> &nbsp; [<a href="Indexes-CP.html#Indexes-CP" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<a name="taminaruuindounosapoto"></a>
<h2 class="unnumbered">ターミナルウィンドウのサポート</h2>
<pre class="verbatim">*terminal.txt*  For Vim バージョン 8.1.  Last change: 2019 Jul 04


                VIMリファレンスマニュアル    by Bram Moolenaar
</pre>

<a name="terminal"></a><a name="terminal_002dwindow"></a><a name="index-terminal"></a>
<a name="index-terminal_002dwindow"></a>
<p>端末ウィンドウサポート
</p>

<p>端末機能はオプションなので、あなたの Vim が對應してゐるかは次のコマンドを使つて確認できます:
</p><pre class="verbatim">echo has('terminal')
</pre><p>結果が &quot;1&quot; ならば對應してゐます。
</p>

<table>
<tr><td width="60%">1. 基本的な使ひ方</td><td width="40%">|<a href="#terminal_002duse">terminal-use</a>|</td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;キー入力</td><td width="40%">|<a href="#terminal_002dtyping">terminal-typing</a>|</td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;サイズと色</td><td width="40%">|<a href="#terminal_002dsize_002dcolor">terminal-size-color</a>|</td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;コマンドの文法</td><td width="40%">|<a href="#g_t_003aterminal">:terminal</a>|</td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;サイズ變更</td><td width="40%">|<a href="#terminal_002dresizing">terminal-resizing</a>|</td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;ターミナルモード</td><td width="40%">|<a href="#Terminal_002dmode">Terminal-mode</a>|</td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;カーソルスタイル</td><td width="40%">|<a href="#terminal_002dcursor_002dstyle">terminal-cursor-style</a>|</td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;セッション</td><td width="40%">|<a href="#terminal_002dsession">terminal-session</a>|</td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;特別なキー</td><td width="40%">|<a href="#terminal_002dspecial_002dkeys">terminal-special-keys</a>|</td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;Unix</td><td width="40%">|<a href="#terminal_002dunix">terminal-unix</a>|</td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;MS-Windows</td><td width="40%">|<a href="#terminal_002dms_002dwindows">terminal-ms-windows</a>|</td></tr>
<tr><td width="60%">2. Terminal 函數</td><td width="40%">|<a href="#terminal_002dfunction_002ddetails">terminal-function-details</a>|</td></tr>
<tr><td width="60%">3. 端末通信</td><td width="40%">|<a href="#terminal_002dcommunication">terminal-communication</a>|</td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;Vim からジョブへ: term_sendkeys()</td><td width="40%">|<a href="#terminal_002dto_002djob">terminal-to-job</a>|</td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;ジョブから Vim へ: JSON API</td><td width="40%">|<a href="#terminal_002dapi">terminal-api</a>|</td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;クライアントサーバー機能を使ふ</td><td width="40%">|<a href="#terminal_002dclient_002dserver">terminal-client-server</a>|</td></tr>
<tr><td width="60%">4. リモートテスト</td><td width="40%">|<a href="#terminal_002dtesting">terminal-testing</a>|</td></tr>
<tr><td width="60%">5. 畫面ダンプの差分</td><td width="40%">|<a href="#terminal_002ddiff">terminal-diff</a>|</td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;Vim の畫面ダンプテストを書く</td><td width="40%">|<a href="#terminal_002ddumptest">terminal-dumptest</a>|</td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;畫面ダンプを作成する</td><td width="40%">|<a href="#terminal_002dscreendump">terminal-screendump</a>|</td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;畫面ダンプを比較する</td><td width="40%">|<a href="#terminal_002ddiffscreendump">terminal-diffscreendump</a>|</td></tr>
<tr><td width="60%">6. デバッグ</td><td width="40%">|<a href="#terminal_002ddebug">terminal-debug</a>|</td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;はじめに</td><td width="40%">|<a href="#termdebug_002dstarting">termdebug-starting</a>|</td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;セッション例</td><td width="40%">|<a href="#termdebug_002dexample">termdebug-example</a>|</td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;コードをステップ實行する</td><td width="40%">|<a href="#termdebug_002dstepping">termdebug-stepping</a>|</td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;變數を檢査する</td><td width="40%">|<a href="#termdebug_002dvariables">termdebug-variables</a>|</td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;その他のコマンド</td><td width="40%">|<a href="#termdebug_002dcommands">termdebug-commands</a>|</td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;プロンプトモード</td><td width="40%">|<a href="#termdebug_002dprompt">termdebug-prompt</a>|</td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;通信</td><td width="40%">|<a href="#termdebug_002dcommunication">termdebug-communication</a>|</td></tr>
<tr><td width="60%">&nbsp;&nbsp;&nbsp;&nbsp;カスタマイズ</td><td width="40%">|<a href="#termdebug_002dcustomizing">termdebug-customizing</a>|</td></tr>
</table>

<p>{Vim が |<a href="various_002etxt.html#g_t_002bterminal">+terminal</a>| 機能付きでコンパイルされたときのみ有效}
</p>
<p>端末機能を使ふには |<a href="various_002etxt.html#g_t_002bjob">+job</a>| そして |<a href="various_002etxt.html#g_t_002bchannel">+channel</a>| 機能が必要です。
</p>
<a name="terminal_002duse"></a><a name="index-terminal_002duse"></a>
<a name="g_t1_002e-Ji-Ben-De-naShi-iFang-"></a>
<h3 class="section">1. 基本的な使ひ方</h3>

<p>これは Vim のウィンドウ內で端末エミュレーターを實行する機能です。端末エミュレーターに接續すると 1 つのジョブが開始されます。例としてシェルを實行するならば以下のやうになります:
</p><pre class="verbatim">:term bash
</pre>
<p>またビルドコマンドを實行するにはかうなります:
</p><pre class="verbatim">:term make myprogram
</pre>
<p>ジョブは Vim とは非同期的に動作し、他のウィンドウで編輯中であつてもジョブからの出力は隨時端末ウィンドウに反映されます。
</p>

<a name="terminal_002dtyping"></a><a name="index-terminal_002dtyping"></a>
<a name="kiRu-Li-"></a>
<h4 class="unnumberedsubsec">キー入力</h4>
<p>端末ウィンドウにキーボードのフォーカスがある時には、入力したキーはジョブに送られます。これには可能ならば pty を使用します。端末ウィンドウ外をクリックすれば、キーボードフォーカスを外に動かせます。
</p>
<a name="t_005fCTRL_002dW_005fCTRL_002dW"></a><a name="t_005fCTRL_002dW_005f_003a"></a><a name="index-t_005fCTRL_002dW_005fCTRL_002dW"></a>
<a name="index-t_005fCTRL_002dW_005f_003a"></a>
<p>ウィンドウや他の <kbd>CTRL-W</kbd> コマンドを操作するために <kbd>CTRL-W</kbd> を使へます。例へば:
</p><table>
<tr><td width="40%"><kbd>CTRL-W CTRL-W</kbd></td><td width="60%">次のウィンドウにフォーカスを移動する</td></tr>
<tr><td width="40%"><kbd>CTRL-W :</kbd></td><td width="60%">Ex コマンドに入る</td></tr>
</table>
<p>他のコマンドについては |<a href="index_002etxt.html#CTRL_002dW">CTRL-W</a>| 參照してください。
</p>
<a name="t_005fCTRL_002dW_005f_002e"></a><a name="t_005fCTRL_002dW_005fN"></a><a name="index-t_005fCTRL_002dW_005f_002e"></a>
<a name="index-t_005fCTRL_002dW_005fN"></a>
<a name="Duan-Mo-uindoudenoTe-Bie-naCao-Zuo-_003a"></a>
<h4 class="unnumberedsubsubsec">端末ウィンドウでの特別な操作:</h4>
<table>
<tr><td width="40%"><kbd>CTRL-W .</kbd></td><td width="60%">端末內のジョブに <kbd>CTRL-W</kbd> を送る</td></tr>
<tr><td width="40%"><kbd>CTRL-W</kbd> <kbd>CTRL-\</kbd></td><td width="60%">端末內のジョブに <kbd>CTRL-\</kbd> を送る</td></tr>
<tr><td width="40%"><kbd>CTRL-W N</kbd></td><td width="60%">Terminal-Normal モードに移行, |<a href="#Terminal_002dmode">Terminal-mode</a>| を參照</td></tr>
<tr><td width="40%"><kbd>CTRL-\ CTRL-N</kbd></td><td width="60%">Terminal-Normal モードに移行, |<a href="#Terminal_002dmode">Terminal-mode</a>| を參照
<a name="t_005fCTRL_002dW_005fquote"></a><a name="index-t_005fCTRL_002dW_005fquote"></a></td></tr>
<tr><td width="40%"><kbd>CTRL-W &quot;</kbd> {reg}</td><td width="60%">レジスタ {reg} の內容を貼り付け式の評價結果を插入するためのレジスタ = も機能する</td></tr>
<tr><td width="40%"><kbd>CTRL-W CTRL-C</kbd></td><td width="60%">ジョブを停止する, 下記の |<a href="#t_005fCTRL_002dW_005fCTRL_002dC">t_CTRL-W_CTRL-C</a>| を參照
<a name="t_005fCTRL_002dW_005fgt"></a><a name="index-t_005fCTRL_002dW_005fgt"></a></td></tr>
<tr><td width="40%"><kbd>CTRL-W gt</kbd></td><td width="60%">次のタブページに移動する。&lsquo;<code>gt</code>&lsquo; と同じ
<a name="t_005fCTRL_002dW_005fgT"></a><a name="index-t_005fCTRL_002dW_005fgT"></a></td></tr>
<tr><td width="40%"><kbd>CTRL-W gT</kbd></td><td width="60%">前のタブページに移動する。&lsquo;<code>gT</code>&lsquo; と同じ</td></tr>
</table>

<p><kbd>CTRL-W</kbd> の代はりに別のキーを使ふにはオプション &rsquo;<samp>termwinkey</samp>&rsquo; を參照してください。ただし &rsquo;<samp>termwinkey</samp>&rsquo; を 2 回タイプすると &rsquo;<samp>termwinkey</samp>&rsquo; がジョブへ送信されます。例:
</p><table>
<tr><td width="40%">&rsquo;<samp>termwinkey</samp>&rsquo; <kbd>CTRL-W</kbd></td><td width="60%">次のウィンドウにフォーカスを移動する</td></tr>
<tr><td width="40%">&rsquo;<samp>termwinkey</samp>&rsquo; <code class="tt-key">:</code></td><td width="60%">Ex コマンドに入る</td></tr>
<tr><td width="40%">&rsquo;<samp>termwinkey</samp>&rsquo; &rsquo;<samp>termwinkey</samp>&rsquo;</td><td width="60%">端末內のジョブに &rsquo;<samp>termwinkey</samp>&rsquo; を送信する</td></tr>
<tr><td width="40%">&rsquo;<samp>termwinkey</samp>&rsquo; <code class="tt-key">.</code></td><td width="60%">端末內のジョブに &rsquo;<samp>termwinkey</samp>&rsquo; を送信する</td></tr>
<tr><td width="40%">&rsquo;<samp>termwinkey</samp>&rsquo; <code class="tt-key">CTRL-\</code></td><td width="60%">端末內のジョブに <kbd>CTRL-W</kbd> を送信する</td></tr>
<tr><td width="40%">&rsquo;<samp>termwinkey</samp>&rsquo; <code class="tt-key">N</code></td><td width="60%">Terminal-Normal モードへ移行する。以下を參照</td></tr>
<tr><td width="40%">&rsquo;<samp>termwinkey</samp>&rsquo; <kbd>CTRL-N</kbd></td><td width="60%"><kbd>CTRL-W N</kbd> と同じ |<a href="#t_005fCTRL_002dW_005fN">t_CTRL-W_N</a>|</td></tr>
<tr><td width="40%">&rsquo;<samp>termwinkey</samp>&rsquo; <kbd>CTRL-C</kbd></td><td width="60%"><kbd>CTRL-W CTRL-C</kbd> と同じ |<a href="#t_005fCTRL_002dW_005fCTRL_002dC">t_CTRL-W_CTRL-C</a>|</td></tr>
</table>
<a name="t_005fCTRL_002d_005c_005fCTRL_002dN"></a><a name="index-t_005fCTRL_002d_005c_005fCTRL_002dN"></a>
<p>他のモードと同じやうに、ノーマルモードへ移行するための特別なキーの組み合はせである <kbd>CTRL-\ CTRL-N</kbd> が利用できます。
<a name="t_005fCTRL_002dW_005fCTRL_002dC"></a><a name="index-t_005fCTRL_002dW_005fCTRL_002dC"></a>
ジョブを强制停止するのに <kbd>CTRL-W CTRL-C</kbd> を使へます。MS-Windows では <kbd>CTRL-BREAK</kbd> でも同樣にジョブを停止できます。
</p>
<p><kbd>CTRL-C</kbd> を入力した場合、その效果は pty がどのやうに構成されてゐるかに從ひます。シンプルなコマンドにおいては SIGINT がジョブに送られ、結果的にジョブが停止するでせう。中には SIGINT を無視するコマンドもあるでせうし、また (Vim がさうしてゐるやうに) <kbd>CTRL-C</kbd> をプログラム自身で取り扱ふものもあるでせう。
</p>
<p>入力したキーを別のものに讀み返させるには端末モードマッピング、詳細は |<a href="map_002etxt.html#g_t_003atmap">:tmap</a>| を使用してください。これはどのやうなマッピングでも定義できますが、端末內で實行されてゐるジョブに送信されるキー入力にのみ作用します。例へば、F1 キーで Terminal-Normal モードに切り替へるには:
</p><pre class="verbatim">tnoremap &lt;F1&gt; &lt;C-W&gt;N
</pre><p>Esc を使ふこともできますが、他のキーが壞れないやうにする必要があります (カーソルキーは Esc で始まるので、それらは壞れるかもしれません):
</p><pre class="verbatim">tnoremap &lt;Esc&gt; &lt;C-W&gt;N
set notimeout ttimeout timeoutlen=100
</pre><a name="options_002din_002dterminal"></a><a name="index-options_002din_002dterminal"></a>
<p>端末ウィンドウを開いて &rsquo;<samp>buftype</samp>&rsquo; を &quot;<var>terminal</var>&quot; に設定すると、TerminalOpen 自動コマンドイベントが發生します。これにより、ウィンドウとバッファ專用のオプションを設定することが可能です。例:
</p><pre class="verbatim">au TerminalOpen * if &amp;buftype == 'terminal' | setlocal bufhidden=hide | endif
</pre><p>&lt;abuf&gt; は端末バッファに設定されてゐますが、ウィンドウが存在しない場合 (隱された端末) は閒違つたバッファにオプションが設定されるため、この例では &amp;buftype のチェックが行はれます。
</p>
<p>マウスイベント (クリックやドラッグ) は端末に渡されます。マウス移動イベントは Vim 自身が受け取つたときのみ渡されます。&rsquo;<samp>balloonevalterm</samp>&rsquo; が有效になつてゐる端末の場合です。
</p>

<a name="terminal_002dsize_002dcolor"></a><a name="index-terminal_002dsize_002dcolor"></a>
<a name="saizutoSe-"></a>
<h4 class="unnumberedsubsec">サイズと色</h4>
<p>端末ウィンドウのサイズを制禦するにはオプション &rsquo;<samp>termwinsize</samp>&rsquo; を參照してください。(TODO: 端末がウィンドウよりも大きい場合にはスクロールすることを記述する)
</p>
<p>端末內のジョブは端末の色を變更できます。デフォルトの前景色及び背景色は Vim の Normal ハイライトグループにより決定されます。
</p>
<p>カラー端末を開始する際に、背景に白と黑どちらの系統の色を使用するかは、オプション &rsquo;<samp>background</samp>&rsquo; を用ゐて決定します。
</p>
<p>異なる色を使ふ場合には Terminal ハイライトグループを利用できます。例:
</p><pre class="verbatim">hi Terminal ctermbg=lightgrey ctermfg=blue guibg=lightgrey guifg=blue
</pre><a name="g_003aterminal_005fansi_005fcolors"></a><a name="index-g_003aterminal_005fansi_005fcolors"></a>
<p>新しい端末ウィンドウでデフォルトで使用される 16 個のANSI カラーは、變數 &lsquo;<var>g:terminal_ansi_colors</var>&lsquo; を使用して設定することができます。これは、16 個の色名または 16 進數の色コードのリストでなければなりません。これは、|<a href="syntax_002etxt.html#highlight_002dguifg">highlight-guifg</a>| で受け入れられるものと同樣です。 GUI カラーを使用しない場合、端末ウィンドウは常に端末基礎の 16 個の ANSI カラーを使用します。
</p>
<p>|<a href="#term_005fsetansicolors_0028_0029">term_setansicolors()</a>| 函數を使用して色を變更したり、|<a href="#term_005fgetansicolors_0028_0029">term_getansicolors()</a>| を使用して現在使用されてゐる色を取得することができます。
</p>

<a name="g_t_003ater"></a><a name="g_t_003aterminal"></a><a name="index-_003ater"></a>
<a name="index-_003aterminal"></a>
<a name="komandonoWenFa-"></a>
<h4 class="unnumberedsubsec">コマンドの文法</h4>

<dl compact="compact">
<dt>:[range]ter[minal] [options] [command]</dt>
<dd><p>新しい端末ウィンドウを開きます。
</p>
<p>[command] が指定された場合、それをジョブとして實行し、端末の入出力を接續します。
</p>
<p>[command] が指定されなかつた場合、オプション &rsquo;<samp>shell</samp>&rsquo; を使用します。
</p>
<p>[command] が NONE の場合ジョブは開始されず、端末の pty は gdb のやうなコマンドによつて利用できます。
</p>
<p>[command] がない場合、デフォルトの動作はシェルが終了したときに端末を閉ぢます。この動作は ++noclose 引數で變更できます。
</p>
<p>[command] が指定されてゐる場合、デフォルトの動作は端末を端末ノーマルモードで開いたままにします。この動作は ++close 引數で變更できます。
</p>
<p>新しいバッファが作られ、 [command] もしくは &rsquo;<samp>shell</samp>&rsquo; に &quot;!&quot; が前置された名前が與へられます。すでに同じ名前のバッファが存在する場合には、カッコに圍まれた番號が付與されます。例へば &quot;gdb&quot; が存在するなら 2 つ目の端末には &quot;!gdb (1)&quot; といふ名前が使はれます。
</p>
<p>[range] が與へられた場合は、指定された範圍の行がジョブの入力として使はれます。その際の端末ウィンドウではキー入力ができなくなります。MS-Windows においては以下の ++eof オプションも參照してください。
</p>
<a name="term_002b_002bclose"></a><a name="term_002b_002bopen"></a><a name="index-term_002b_002bclose"></a>
<a name="index-term_002b_002bopen"></a>
<p>サポートされる [options] は以下の通り:
</p><table>
<tr><td width="30%">++close</td><td width="70%">ジョブが終了した際には自動的に端末ウィンドウを閉ぢる。</td></tr>
<tr><td width="30%">++noclose</td><td width="70%">ジョブが終了しても自動的に端末ウィンドウを<strong>閉ぢ</strong>ません。</td></tr>
<tr><td width="30%">++open</td><td width="70%">ジョブが終了した際にウィンドウが表示されてゐない場合に、ウィンドウを表示する。
<blockquote>
<p><strong>Note:</strong> <br>
割り込み的に發生しうることに留意。
</p></blockquote>
<p>++close, ++noclose と ++open は最後に指定されたものが有效です。
</p></td></tr>
<tr><td width="30%">++curwin</td><td width="70%">現在のウィンドウで端末を開き、現在のウィンドウを分割しない。現在のバッファを抛棄( |<a href="editing_002etxt.html#abandon">abandon</a>| )できない場合は失敗する。</td></tr>
<tr><td width="30%">++hidden</td><td width="70%">端末を隱しバッファとして開く。ウィンドウは使用されない。</td></tr>
<tr><td width="30%">++norestore</td><td width="70%">セッションファイルに端末ウィンドウを含めません。</td></tr>
<tr><td width="30%">++kill={how}</td><td width="70%">端末ウィンドウを閉ぢるときに {how} でジョブを終了させます。値については |<a href="#term_005fsetkill_0028_0029">term_setkill()</a>| を參照してください。</td></tr>
<tr><td width="30%">++rows={height}</td><td width="70%">端末ウィンドウの高さとして {height} を使ひます。もし、端末が Vim の完全な高さ (端末ウィンドウの上や下にウィンドウがない) を使用する場合、必要に應じてコマンドラインの高さが現象します。</td></tr>
<tr><td width="30%">++cols={width}</td><td width="70%">端末ウィンドウの幅として {width} を使ひます。もし、端末が Vim の完全な幅 (端末ウィンドウの左や右にウィンドウがない) を使用する場合、この値は無視されます。</td></tr>
<tr><td width="30%">++eof={text}</td><td width="70%">[range] を使つた場合: 最後の行を送信したあとに指定したテキストが送られる。空白を含むことはできない。 CR が 1 つ付け加へられる。MS-Windows ではデフォルトでは CTRL-D が送られる。

<p>例: シェルには &quot;++eof=exit&quot; を、Python には &quot;++eof=exit()&quot; を指定する。特殊 コードが &lsquo;<code>:map</code>&lsquo; と同樣に利用できる。例: &quot;&lt;C-Z&gt;&quot; は CTRL-Z を示す。
</p></td></tr>
<tr><td width="30%">++type={pty}</td><td width="70%">(MS-Windows のみ): 假想コンソールとして {pty} を使用する。値については &rsquo;<samp>termwintype</samp>&rsquo; を參照。</td></tr>
</table>

<p>より詳細なオプションを使ひたいならば |<a href="#term_005fstart_0028_0029">term_start()</a>| 函數を使つてください。
</p></dd>
</dl>
<p>ウィンドウを垂直に分割したいなら、次を使ひます:
</p><pre class="verbatim">:vertical terminal
</pre><p>もしくは短く:
</p><pre class="verbatim">:vert ter
</pre>
<p>端末に關聯付けられたバッファが强制的にアンロードもしくは削除された場合には、&lsquo;<code>job_stop(job, &quot;kill&quot;)</code>&lsquo; を呼んだのと同じやうにそのジョブが殺されます。
普通にウィンドウを閉ぢると |<a href="#E947">E947</a>| が返ります。kill メソッドが &quot;++kill={how}&quot; か |<a href="#term_005fsetkill_0028_0029">term_setkill()</a>| で設定されてゐる時にウィンドウを閉ぢると、その方法でジョブを强制停止または中斷します。例:
</p><pre class="verbatim">:term ++kill=term tail -f /tmp/log
</pre>
<p>ジョブが實行され續けるとウィンドウはそのバッファが變更されたかのやうに振る舞ひます。 &lsquo;<code>CTRL-W :quit</code>&lsquo; でウィンドウを閉ぢようとしても失敗します。&lsquo;<code>CTRL-W :quit!</code>&lsquo; を使ふとジョブは終了します。ウィンドウのテキストは失はれます。バッファは依然存在しますが、&lsquo;<code>:buffer</code>&lsquo; でウィンドウに割り當てても空のバッファが表示されます。
</p>
<p>&lsquo;<code>CTRL-W :close</code>&lsquo; で閉ぢようとしてもまた失敗します。&lsquo;<code>CTRL-W :close!</code>&lsquo; はウィンドウを閉ぢ、バッファを隱し狀態にします。
</p>
<p>&lsquo;<code>CTRL-W :hide</code>&lsquo; を使ふとジョブを實行したまま、端末ウィンドウを閉ぢバッファを隱し狀態にできます。&lsquo;<code>:buffer</code>&lsquo; コマンドで現在のウィンドウを端末ウィンドウにすることができます。未保存の變更があつた場合にはこれは失敗しますが、通常と同じやうに ! で强制できます。
</p>
<p>バックグラウンドジョブをウィンドウ無しで實行し、終了したらウィンドウに表示するには、次のやうにオプションを指定します:
</p><pre class="verbatim">:term ++hidden ++open make
</pre><blockquote>
<p><strong>Note:</strong> <br>
ウィンドウが豫期せぬタイミングで開かれ、あなたが行つてゐる操作に割り込む可能性があることに留意してください。
</p></blockquote>

<a name="E947"></a><a name="E948"></a><a name="index-E947"></a>
<a name="index-E948"></a>
<p>ジョブが實行され續けると、バッファが變更されたとみなされ Vim を簡單には終了できなくなります。|<a href="editing_002etxt.html#abandon">abandon</a>| を參照してください。
</p>
<p>ジョブが終了しバッファになんの變更も及ぼさなかつた場合、そのウィンドウを閉ぢるとバッファは削除されます。
</p>
<p>端末バッファを變更するにはオプション &rsquo;<samp>modifiable</samp>&rsquo; をセットする必要があります。これはジョブが終了した後にのみ行なへます。バッファを最初に變更した瞬閒に普通のバッファになりハイライトは削除されます。バッファを保存可能にするために |<a href="editing_002etxt.html#g_t_003afile">:file</a>| でバッファの名前を、コマンド名から變更することもできます。
</p>

<a name="terminal_002dresizing"></a><a name="index-terminal_002dresizing"></a>
<a name="saizuBian-Geng-"></a>
<h4 class="unnumberedsubsec">サイズ變更</h4>
<p>端末のサイズは 3 つのモードのいづれか 1 つで決まります:
</p>
<ol>
<li> オプション &rsquo;<samp>termwinsize</samp>&rsquo; が空の場合: 端末サイズはウィンドウのサイズに從ふ。最小で 2 行、10 桁。

</li><li> オプション &rsquo;<samp>termwinsize</samp>&rsquo; が &quot;<var>rows*cols</var>&quot; の場合、&quot;<var>rows</var>&quot; を最小行數、&quot;<var>cols</var>&quot; を最小桁數とする。

</li><li> オプション &rsquo;<samp>termwinsize</samp>&rsquo; が &quot;<var>rowsXcols</var>&quot; (&quot;X&quot; は大文字小文字を問はない) の場合: 端末サイズは指定された行數と桁數で固定される。もしもウィンドウがそれよりも大きい場合には、使用されない空の領域ができる。
</li></ol>

<p>ウィンドウサイズが端末サイズよりも小さい場合、端末の一部の領域 (左下に相當する部分) のみが描畫されます。
</p>
<p>端末の現在のサイズを取得するのに函數 |<a href="#term_005fgetsize_0028_0029">term_getsize()</a>| が使へます。|<a href="#term_005fsetsize_0028_0029">term_setsize()</a>| は 1 か 2 のモードの時にだけ、すなはち &rsquo;<samp>termwinsize</samp>&rsquo; が &quot;<var>rowsXcols</var>&quot; 形式ではない時に使へます。
</p>

<a name="Terminal_002dmode"></a><a name="Terminal_002dJob"></a><a name="index-Terminal_002dmode"></a>
<a name="index-Terminal_002dJob"></a>
<a name="Terminal_002dJob-to-Terminal_002dNormal-modo"></a>
<h4 class="unnumberedsubsec">Terminal-Job と Terminal-Normal モード</h4>
<p>ジョブが實行中には端末の內容はジョブの制禦下にあります。それにはカーソルの位置も含まれます。入力したキーはジョブに送られます。端末の內容はいつでも更新されえます。これを Terminal-Job モードと呼びます。
</p>
<p><kbd>CTRL-W N</kbd> (もしくは &rsquo;termwinkey&rsquo; N) を入力すると Terminal-Normal モードに遷移します。このモードでは端末ウィンドウのコンテンツは Vim の制禦下に置かれ、ジョブの出力は一時保留されます。<kbd>CTRL-\ CTRL-N</kbd> でも同じやうになります。
</p>
<p>|<a href="map_002etxt.html#g_t_003atmap">:tmap</a>| のマッピングは Terminal-Job モードにおいて作用します。|<a href="#term_005fsendkeys_0028_0029">term_sendkeys()</a>| で送つたキーには tmap は適用されませんが、|<a href="eval_002etxt.html#feedkeys_0028_0029">feedkeys()</a>| で送つたキーには適用されます。
</p>
<p>Terminal-Job モードから插入モードに移る方法はありません。
</p>
<a name="Terminal_002dNormal"></a><a name="E946"></a><a name="index-Terminal_002dNormal"></a>
<a name="index-E946"></a>
<p>Terminal-Normal モードでは、Vim の普通のコマンドでカーソルを自由に動かせます。視覺的にテキストをマークしたり、テキストをヤンクしたり思ひのままです。しかしバッファの內容を變更することはできません。&rsquo;i&rsquo; や &rsquo;a&rsquo; など插入モードを開始するコマンドを使ふと Terminal-Job モードに戾ります。結果としてウィンドウは端末のコンテンツを反映させるために更新されます。|<a href="insert_002etxt.html#g_t_003astartinsert">:startinsert</a>| は無效です。
</p>
<p>Terminal-Normal モードではステータスラインとウィンドウタイトルには &quot;(Terminal)&quot; と表示されます。Terminal-Normal モード中にジョブが終了してしまつた場合にはそれが &quot;(Terminal-finished)&quot; に變はります。
</p>
<p>ジョブが端末內で行を出力し內容がスクロールすると、それらの行は記憶され Terminal-Normal モードで表示されます。行數は &rsquo;<samp>'termwinscroll</samp>&rsquo; オプションによつて制限されます。この制限を超えると、スクロールされた行の最初の 10% が削除され失はれます。
</p>

<a name="terminal_002dcursor_002dstyle"></a><a name="index-terminal_002dcursor_002dstyle"></a>
<a name="kasorusutairu"></a>
<h4 class="unnumberedsubsec">カーソルスタイル</h4>
<p>デフォルトでは端末ウィンドウのカーソルには點滅しないブロックが使はれます。カーソルの點滅狀態や形を變更するのに、普通の xterm のエスケープシーケンスが使はれます。端末ウィンドウからフォーカスが外れる際に Vim は元々のカーソルを復元します。
</p>
<p>xterm を &quot;-bc&quot; 引數で起動した場合、または他の方法でカーソルの點滅を發生させた場合、が1つの例外となります。それらにより點滅フラグが逆轉したことが問題の引き金となります。なぜなら Vim はその逆轉を檢出できず、端末ウィンドウのカーソルの點滅も逆轉します。
</p>

<a name="terminal_002dsession"></a><a name="index-terminal_002dsession"></a>
<a name="setusiyon-1"></a>
<h4 class="unnumberedsubsec">セッション</h4>
<p>可能かつ必要であれば、セッションファイルを使用する歲に端末ウィンドウが復元されます。
</p>
<p>&quot;terminal&quot; が &rsquo;<samp>sessionoptions</samp>&rsquo; から削除された場合、端末ウィンドウは復元されません。
</p>
<p>端末內のジョブが終了した場合、ウィンドウは復元されません。
</p>
<p>端末を復元できる場合は、その端末を開くために使はれたコマンドが再び使はれます。これを變更するには |<a href="#term_005fsetrestore_0028_0029">term_setrestore()</a>| 函數を使用します。これは、コマンドを &quot;NONE&quot; に設定して特定の端末を復元しない場合にも使用できます。
</p>

<a name="terminal_002dspecial_002dkeys"></a><a name="index-terminal_002dspecial_002dkeys"></a>
<a name="Te-Bie-naki"></a>
<h4 class="unnumberedsubsec">特別なキー</h4>
<p>端末エミュレーターは xterm をシミュレートするので、Vim と xterm の兩方が認識するエスケープシーケンスのみが端末ウィンドウで利用可能になります。もし、端末で實行中のジョブに他のエスケープシーケンスを渡したい場合は、轉送を設定する必要があります。例:
</p><pre class="verbatim">tmap &lt;expr&gt; &lt;Esc&gt;]b SendToTerm(&quot;\&lt;Esc&gt;]b&quot;)
func SendToTerm(what)
  call term_sendkeys('', a:what)
  return ''
endfunc
</pre>

<a name="terminal_002dunix"></a><a name="index-terminal_002dunix"></a>
<a name="Unix-2"></a>
<h4 class="unnumberedsubsec">Unix</h4>
<p>UNIX ではすべての種類のコマンドを實行可能とするために pty を用ゐてゐます。端末內で Vim ですら實行できるのです！これは以下のやうにデバッグに利用できます。
</p>
<p>實行中のジョブに情報を傳へるのに以下の環境變數が利用できます:
</p><table>
<tr><td width="30%">TERM</td><td width="70%">端末の名前、&rsquo;<samp>term</samp>&rsquo; オプションまたは GUI では <var>$TERM</var> から。&quot;xterm&quot; で始まらなければ &quot;xterm&quot; にフォールバックする</td></tr>
<tr><td width="30%">ROWS</td><td width="70%">端末の初期行數</td></tr>
<tr><td width="30%">LINES</td><td width="70%">ROWS と同じ</td></tr>
<tr><td width="30%">COLUMNS</td><td width="70%">端末の初期桁數</td></tr>
<tr><td width="30%">COLORS</td><td width="70%">色數 &rsquo;<samp>t_Co</samp>&rsquo; (GUIでは 256*256*256)</td></tr>
<tr><td width="30%">VIM_SERVERNAME</td><td width="70%">v:servername</td></tr>
<tr><td width="30%">VIM_TERMINAL</td><td width="70%">v:version</td></tr>
</table>


<a name="terminal_002dms_002dwindows"></a><a name="index-terminal_002dms_002dwindows"></a>
<a name="MS_002dWindows-2"></a>
<h4 class="unnumberedsubsec">MS-Windows</h4>
<p>MS-Windows ではすべての種類のコマンドを實行可能とするために winpty を用ゐてゐます。あたりまへのことですが、ここで實行するコマンドは端末の中で動くもので、獨自のウィンドウを開くものであつてはいけません。
</p>
<p>winpty 內の以下の 2 つのファイルが必要です:
</p>
<pre class="verbatim">winpty.dll
winpty-agent.exe
</pre>
<p>これらは以下のページからダウンロードできます:
</p>
<p><a href="https://github.com/rprichard/winpty">https://github.com/rprichard/winpty</a>
</p>
<p>これらのファイルを環境變數 PATH のいづれかに置くだけです。必要ならばオプション &rsquo;<samp>winptydll</samp>&rsquo; でファイルの場所を指定できます。もしも 32 ビット版と 64 ビット版を同じディレクトリに置きたいのであれば、Vim のビルドに合はせてそれぞれを winpty32.dll もしくは winpty64.dll といふ名前に變更してください。
<a name="ConPTY"></a><a name="E982"></a><a name="index-ConPTY"></a>
<a name="index-E982"></a>
MS-Windows 10 の最新バージョン (&quot;October 2018 Update&quot; 以降) では、winpty は必要なくなりました。それらのバージョンでは、|<a href="#g_t_003aterminal">:terminal</a>| はターミナルアプリケーションをホストするための Windows の組み込みサポート &quot;ConPTY&quot; を使用します。ConPTY が使用されてゐると、あゐまいな幅の文字に關するレンダリングアーティファクトが發生する可能性があります。そのやうな問題に遭遇した場合は、&quot;winpty&quot; をインストールしてください。ConPTY の問題が修正されるまでは、&quot;winpty&quot; が優先されます。
</p>
<p>環境變數は實行中のジョブに情報を渡すために使用されます:
</p><pre class="verbatim">VIM_SERVERNAME	v:servername
</pre>

<a name="terminal_002dfunction_002ddetails"></a><a name="index-terminal_002dfunction_002ddetails"></a>
<a name="g_t2_002e-Terminal-Guan-Shu-"></a>
<h3 class="section">2. Terminal 函數</h3>

<a name="term_005fdumpdiff_0028_0029"></a><a name="index-term_005fdumpdiff_0028_0029"></a>
<dl compact="compact">
<dt>term_dumpdiff({filename}, {filename} [, {options}])</dt>
<dd><p>2 ファイルの差分を表示してゐる新しいウィンドウを開く。ファイルは |<a href="#term_005fdumpwrite_0028_0029">term_dumpwrite()</a>| で作成されてゐなければならない。
</p>
<p>diff に失敗した場合はバッファ番號もしくは 0 を返す。|<a href="#terminal_002ddiff">terminal-diff</a>| も參照。
</p>
<blockquote>
<p><strong>Note:</strong> <br>
これは 2 バイト文字ではまだ動作しないことに注意。
</p></blockquote>

<p>バッファの上部は最初のファイルの內容を含み、下部は 2 番目のファイルの內容を含む。眞ん中の部分は差分を表示する。それぞれのパートはイコールのラインで區切られる。
</p>
<p>もしも {options} に引數があるなら、次のやうな要素を持つ辭書になつてゐなければならない:
</p><table>
<tr><td width="30%">&quot;term_name&quot;</td><td width="70%">初期ファイル名の代はりのバッファ名に使ふための名前</td></tr>
<tr><td width="30%">&quot;term_rows&quot;</td><td width="70%">&rsquo;<samp>termwinsize</samp>&rsquo; を使ふ代はりの端末が使ふ高さのサイズ</td></tr>
<tr><td width="30%">&quot;term_cols&quot;</td><td width="70%">&rsquo;<samp>termwinsize</samp>&rsquo; を使ふ代はりの端末が使ふ幅のサイズ</td></tr>
<tr><td width="30%">&quot;vertical&quot;</td><td width="70%">ウィンドウを垂直に分割する</td></tr>
<tr><td width="30%">&quot;curwin&quot;</td><td width="70%">カレントウィンドウを使ひウィンドウは分割しない; もしもカレントバッファを破毀 |<a href="editing_002etxt.html#abandon">abandon</a>| することができないならば失敗する。</td></tr>
<tr><td width="30%">&quot;bufnr&quot;</td><td width="70%">新規バッファを作成せず、存在してゐる &quot;bufnr&quot; バッファを使用します。このバッファは term_dumpdiff() や term_dumpload() で前もつて作成されてゐて、ウィンドウ中で見えてゐなければなりません。</td></tr>
<tr><td width="30%">&quot;norestore&quot;</td><td width="70%">セッションファイルに端末ウィンドウを追加しない</td></tr>
</table>

<p>眞ん中のそれぞれの文字は差異を示してゐる。もしも複數の差異があるのなら、このリストの最初のものだけが使はれる:
</p><table>
<tr><td width="10%">X</td><td width="90%">文字が異なる</td></tr>
<tr><td width="10%">w</td><td width="90%">幅が異なる</td></tr>
<tr><td width="10%">f</td><td width="90%">前景色が異なる</td></tr>
<tr><td width="10%">b</td><td width="90%">背景色が異なる</td></tr>
<tr><td width="10%">a</td><td width="90%">屬性が異なる</td></tr>
<tr><td width="10%">+</td><td width="90%">1 つ目のファイルの位置が缺損してゐる</td></tr>
<tr><td width="10%">-</td><td width="90%">2 つ目のファイルの位置が缺損してゐる</td></tr>
</table>

<p>&quot;s&quot; キーを使ふと上と下の部分が交換される。これは差異を見つけやすくする。
</p>
<a name="term_005fdumpload_0028_0029"></a><a name="index-term_005fdumpload_0028_0029"></a>
</dd>
<dt>term_dumpload({filename} [, {options}])</dt>
<dd><p>{filename} の內容を表示してゐる新しいウィンドウを開く。ファイルは |<a href="#term_005fdumpwrite_0028_0029">term_dumpwrite()</a>| で作成されてゐなければならない。失敗した場合はバッファ番號もしくは 0 を返す。|<a href="#terminal_002ddiff">terminal-diff</a>| も參照。
</p>
<p>{options} の詳細は |<a href="#term_005fdumpdiff_0028_0029">term_dumpdiff()</a>| を參照。
</p>
<a name="term_005fdumpwrite_0028_0029"></a><a name="index-term_005fdumpwrite_0028_0029"></a>
</dd>
<dt>term_dumpwrite({buf}, {filename} [, {options}])</dt>
<dd><p>ファイル {filename} 內の {buf} のターミナル畫面の內容をダンプする。これは |<a href="#term_005fdumpload_0028_0029">term_dumpload()</a>| と |<a href="#term_005fdumpdiff_0028_0029">term_dumpdiff()</a>| で使はれるフォーマットを使ふ。
</p>
<a name="E958"></a><a name="index-E958"></a>
<p>もしもターミナル中のジョブがすでに終了してゐるのなら、E958 のエラーが與へられる。
</p>
<a name="E953"></a><a name="index-E953"></a>
<p>もしも {filename} がすでに存在してゐるなら、E953 のエラーが與へられる。|<a href="#terminal_002ddiff">terminal-diff</a>| も參照。
</p>
<p>{options} は次のオプションを持つ辭書:
</p><table>
<tr><td width="30%">&quot;rows&quot;</td><td width="70%">ダンプする行の最大値</td></tr>
<tr><td width="30%">&quot;columns&quot;</td><td width="70%">ダンプする列の最大値</td></tr>
</table>

<a name="term_005fgetaltscreen_0028_0029"></a><a name="index-term_005fgetaltscreen_0028_0029"></a>
</dd>
<dt>term_getaltscreen({buf})</dt>
<dd><p>{buf} のターミナルがオルタネートスクリーンを使つてゐるなら 1 を返す。
</p>
<p>{buf} は |<a href="#term_005fgetsize_0028_0029">term_getsize()</a>| と同樣に使はれる。
</p>
<p>{Vim が |<a href="various_002etxt.html#g_t_002bterminal">+terminal</a>| 機能付きでコンパイルされたときのみ有效}
</p>
<a name="term_005fgetansicolors_0028_0029"></a><a name="index-term_005fgetansicolors_0028_0029"></a>
</dd>
<dt>term_getansicolors({buf})</dt>
<dd><p>ターミナル {buf} で使はれてゐる ANSI カラーパレットを取得する。16 の長さのリストを返す。それぞれの項目は 16 進數の &quot;#rrggbb&quot; フォーマットで表はされてゐるカラーです。|<a href="#term_005fsetansicolors_0028_0029">term_setansicolors()</a>| と |<a href="#g_003aterminal_005fansi_005fcolors">g:terminal_ansi_colors</a>| も參照。もしもどちらも使はれてゐなければ、デフォルト色が返される。
</p>
<p>{buf} は |<a href="#term_005fgetsize_0028_0029">term_getsize()</a>| と同樣に使はれる。もしもバッファが存在しないか端末ウィンドウでなければ、空のリストが返される。
</p>
<p>{Vim が |<a href="various_002etxt.html#g_t_002bterminal">+terminal</a>| 機能付きでコンパイルされたとき、かつ GUI が有效のとき、かつ/または |<a href="various_002etxt.html#g_t_002btermguicolors">+termguicolors</a>| 機能付きでコンパイルされたときのみ有效}
</p>
<a name="term_005fgetattr_0028_0029"></a><a name="index-term_005fgetattr_0028_0029"></a>
</dd>
<dt>term_getattr({attr}, {what})</dt>
<dd><p>與へられた {attr}。要素中で term_scrape() によつて返された値。{what} がオンかどうかを返す。 {what} は次のうちのどれか:
</p><table>
<tr><td width="10%">bold</td><td width="90%"></td></tr>
<tr><td width="10%">italic</td><td width="90%"></td></tr>
<tr><td width="10%">underline</td><td width="90%"></td></tr>
<tr><td width="10%">strike</td><td width="90%"></td></tr>
<tr><td width="10%">reverse</td><td width="90%"></td></tr>
</table>
<p>{Vim が |<a href="various_002etxt.html#g_t_002bterminal">+terminal</a>| 機能付きでコンパイルされたときのみ有效}
</p>
<a name="term_005fgetcursor_0028_0029"></a><a name="index-term_005fgetcursor_0028_0029"></a>
</dd>
<dt>term_getcursor({buf})</dt>
<dd><p>ターミナル {buf} のカーソル位置を取得する。2 つの數値と辭書のリストを返す: [row, col, dict]。
</p>
<p>&quot;row&quot; と &quot;col&quot; は原點で、1 番目のスクリーンのセルは row が 1 で column が 1。これはターミナル自身のカーソルの位置で Vim ウィンドウのものではない。
</p>
<p>&quot;dict&quot; は 3 つの數値を持てる:
</p><table>
<tr><td width="20%">&quot;visible&quot;</td><td width="80%">カーソルが可視なら 1、不可視なら 0</td></tr>
<tr><td width="20%">&quot;blink&quot;</td><td width="80%">カーソルが點滅なら 1、點滅でないなら 0</td></tr>
<tr><td width="20%">&quot;shape&quot;</td><td width="80%">カーソルの形がブロックなら 1、アンダーラインなら 2、バーティカルなら 3。</td></tr>
<tr><td width="20%">&quot;color&quot;</td><td width="80%">カーソルの色。例へば &quot;green&quot;</td></tr>
</table>

<p>{buf} はターミナルウィンドウのバッファ番號でなければならない。バッファが存在しないか、ターミナルウィンドウでなければ、空のリストが返される。
</p>
<p>{Vim が |<a href="various_002etxt.html#g_t_002bterminal">+terminal</a>| 機能付きでコンパイルされたときのみ有效}
</p>
<a name="term_005fgetjob_0028_0029"></a><a name="index-term_005fgetjob_0028_0029"></a>
</dd>
<dt>term_getjob({buf})</dt>
<dd><p>ターミナルウィンドウの {buf} と關聯付けられたジョブを取得する。{buf} は |<a href="#term_005fgetsize_0028_0029">term_getsize()</a>| として使はれる。ジョブがない場合は |<a href="eval_002etxt.html#v_003anull">v:null</a>| を返す。
</p>
<p>{Vim が |<a href="various_002etxt.html#g_t_002bterminal">+terminal</a>| 機能付きでコンパイルされたときのみ有效}
</p>
<a name="term_005fgetline_0028_0029"></a><a name="index-term_005fgetline_0028_0029"></a>
</dd>
<dt>term_getline({buf}, {row})</dt>
<dd><p>ターミナルウィンドウの {buf} からテキストの 1 行を取得する。{buf} は |<a href="#term_005fgetsize_0028_0029">term_getsize()</a>| として使はれる。
</p>
<p>1 番目の行は {row} を 1 つ持つてゐる。{row} が &quot;.&quot; のとき、カーソル行が使はれる。{row} が正しくなければ、空文字列が返される。
</p>
<p>それぞれの文字の屬性を取得するには |<a href="#term_005fscrape_0028_0029">term_scrape()</a>| を使ふ。
</p>
<p>{Vim が |<a href="various_002etxt.html#g_t_002bterminal">+terminal</a>| 機能付きでコンパイルされたときのみ有效}
</p>
<a name="term_005fgetscrolled_0028_0029"></a><a name="index-term_005fgetscrolled_0028_0029"></a>
</dd>
<dt>term_getscrolled({buf})</dt>
<dd><p>ターミナル {buf} の上方にスクロールされた行數を返す。これは |<a href="#term_005fgetline_0028_0029">term_getline()</a>| と |<a href="eval_002etxt.html#getline_0028_0029">getline()</a>| で使はれる行番號のオフセット。
そのため:
</p><pre class="verbatim">term_getline(buf, N)
</pre><p>は次と同じ:
</p><pre class="verbatim">getline(N + term_getscrolled(buf))
</pre><p>(その行が存在するなら)。
</p>
<p>{buf} は |<a href="#term_005fgetsize_0028_0029">term_getsize()</a>| として使はれる。
</p>
<p>{Vim が |<a href="various_002etxt.html#g_t_002bterminal">+terminal</a>| 機能付きでコンパイルされたときのみ有效}
</p>
<a name="term_005fgetsize_0028_0029"></a><a name="index-term_005fgetsize_0028_0029"></a>
</dd>
<dt>term_getsize({buf})</dt>
<dd><p>ターミナル {buf} のサイズを取得する。2 つの數値を持つリストを返す: [rows, cols]。これはターミナルのサイズであつて、ターミナルを持つてゐるウィンドウのサイズではない。
</p>
<p>{buf} はターミナルウィンドウのバッファ番號でなければならない。カレントバッファのために空文字列を使ふ。バッファが存在しないか、ターミナルウィンドウでなければ、空リストが返される。
</p>
<p>{Vim が |<a href="various_002etxt.html#g_t_002bterminal">+terminal</a>| 機能付きでコンパイルされたときのみ有效}
</p>
<a name="term_005fgetstatus_0028_0029"></a><a name="index-term_005fgetstatus_0028_0029"></a>
</dd>
<dt>term_getstatus({buf})</dt>
<dd><p>ターミナル {buf} のステータスを取得する。次の項目のコンマ區切りのリストを返す:
</p><table>
<tr><td width="30%">running</td><td width="70%">ジョブは動作中</td></tr>
<tr><td width="30%">finished</td><td width="70%">ジョブは停止</td></tr>
<tr><td width="30%">normal</td><td width="70%">Terminal-Normal モード中</td></tr>
</table>
<p>&quot;running&quot; もしくは &quot;finished&quot; のどちらかが常に存在する。
</p>
<p>{buf} はターミナルウィンドウのバッファ番號でなければならない。バッファが存在しないか、ターミナルウィンドウでなければ、空文字列が返される。
</p>
<p>{Vim が |<a href="various_002etxt.html#g_t_002bterminal">+terminal</a>| 機能付きでコンパイルされたときのみ有效}
</p>
<a name="term_005fgettitle_0028_0029"></a><a name="index-term_005fgettitle_0028_0029"></a>
</dd>
<dt>term_gettitle({buf})</dt>
<dd><p>ターミナル {buf} のタイトルを取得する。これはターミナル內で設定されたジョブのタイトル。
</p>
<p>{buf} はターミナルウィンドウのバッファ番號でなければならない。バッファが存在しないか、ターミナルウィンドウでなければ、空文字列が返される。
</p>
<p>{Vim が |<a href="various_002etxt.html#g_t_002bterminal">+terminal</a>| 機能付きでコンパイルされたときのみ有效}
</p>
<a name="term_005fgettty_0028_0029"></a><a name="index-term_005fgettty_0028_0029"></a>
</dd>
<dt>term_gettty({buf} [, {input}])</dt>
<dd><p>ターミナルウィンドウ {buf} に關聯付けらてた制禦中のターミナルの名前を取得する。{buf} は |<a href="#term_005fgetsize_0028_0029">term_getsize()</a>| として使はれる。
</p>
<p>{input} が省略されるか 0 なら、書き込んでゐる名前を返す (stdout)。{input} が 1 なら、讀み込んでゐる名前を返す (stdin)。UNIX ではどちらも同じ名前を返す。
</p>
<p>{Vim が |<a href="various_002etxt.html#g_t_002bterminal">+terminal</a>| 機能付きでコンパイルされたときのみ有效}
</p>
<a name="term_005flist_0028_0029"></a><a name="index-term_005flist_0028_0029"></a>
</dd>
<dt>term_list()</dt>
<dd><p>ターミナルウィンドウのためのすべてのバッファのバッファ番號を持つリスト
</p>
<p>{Vim が |<a href="various_002etxt.html#g_t_002bterminal">+terminal</a>| 機能付きでコンパイルされたときのみ有效}
</p>
<a name="term_005fscrape_0028_0029"></a><a name="index-term_005fscrape_0028_0029"></a>
</dd>
<dt>term_scrape({buf}, {row})</dt>
<dd><p>{buf} のターミナルスクリーンの {row} の內容を取得する。{buf} のためには |<a href="#term_005fgetsize_0028_0029">term_getsize()</a>| を參照。
</p>
<p>1 番目の行は {row} を 1 つ持つてゐる。{row} が &quot;.&quot; のとき、カーソル行が使はれる。{row} が正しくなければ、空文字列が返される。
</p>
<p>それぞれのスクリーンセルのための辭書を含むリストを返す:
</p><table>
<tr><td width="20%">&quot;chars&quot;</td><td width="80%">セルの文字</td></tr>
<tr><td width="20%">&quot;fg&quot;</td><td width="80%">#rrggbb 形式の前景色</td></tr>
<tr><td width="20%">&quot;bg&quot;</td><td width="80%">#rrggbb 形式の背景色</td></tr>
<tr><td width="20%">&quot;attr&quot;</td><td width="80%">セルの屬性。個々のフラグを取得するには |<a href="#term_005fgetattr_0028_0029">term_getattr()</a>| を使ふ</td></tr>
<tr><td width="20%">&quot;width&quot;</td><td width="80%">セルの幅: 1 もしくは 2</td></tr>
</table>
<p>{Vim が |<a href="various_002etxt.html#g_t_002bterminal">+terminal</a>| 機能付きでコンパイルされたときのみ有效}
</p>
<a name="term_005fsendkeys_0028_0029"></a><a name="index-term_005fsendkeys_0028_0029"></a>
</dd>
<dt>term_sendkeys({buf}, {keys})</dt>
<dd><p>ターミナル {buf} にキーストローク {keys} を送る。{buf} は |<a href="#term_005fgetsize_0028_0029">term_getsize()</a>| として使はれる。
</p>
<p>{keys} はキーの連續として解釋される。例へば、&quot;\&lt;c-x&gt;&quot; は <kbd>CTRL-X</kbd> を意味する。
</p>
<p>{Vim が |<a href="various_002etxt.html#g_t_002bterminal">+terminal</a>| 機能付きでコンパイルされたときのみ有效}
</p>
<a name="term_005fsetansicolors_0028_0029"></a><a name="index-term_005fsetansicolors_0028_0029"></a>
</dd>
<dt>term_setansicolors({buf}, {colors})</dt>
<dd><p>ターミナル {buf} で使はれてゐる ANSI カラーパレットを設定する。{colors} は 正しい 16 ANSI カラーか、|<a href="syntax_002etxt.html#highlight_002dguifg">highlight-guifg</a>| で認められてゐるやうな 16 進數のカラーコードのリストでなければならない。|<a href="#term_005fgetansicolors_0028_0029">term_getansicolors()</a>| と |<a href="#g_003aterminal_005fansi_005fcolors">g:terminal_ansi_colors</a>| も參照。
</p>
<p>カラーは通常、以下のとほり:
</p><table>
<tr><td width="20%">0</td><td width="80%">black</td></tr>
<tr><td width="20%">1</td><td width="80%">dark red</td></tr>
<tr><td width="20%">2</td><td width="80%">dark green</td></tr>
<tr><td width="20%">3</td><td width="80%">brown</td></tr>
<tr><td width="20%">4</td><td width="80%">dark blue</td></tr>
<tr><td width="20%">5</td><td width="80%">dark magenta</td></tr>
<tr><td width="20%">6</td><td width="80%">dark cyan</td></tr>
<tr><td width="20%">7</td><td width="80%">light grey</td></tr>
<tr><td width="20%">8</td><td width="80%">dark grey</td></tr>
<tr><td width="20%">9</td><td width="80%">red</td></tr>
<tr><td width="20%">10</td><td width="80%">green</td></tr>
<tr><td width="20%">11</td><td width="80%">yellow</td></tr>
<tr><td width="20%">12</td><td width="80%">blue</td></tr>
<tr><td width="20%">13</td><td width="80%">magenta</td></tr>
<tr><td width="20%">14</td><td width="80%">cyan</td></tr>
<tr><td width="20%">15</td><td width="80%">white</td></tr>
</table>

<p>これらのカラーは &rsquo;<samp>termguicolors</samp>&rsquo; が設定されてゐるときに GUI と端末で使はれる。GUI カラーが使はれてゐないとき (GUI モードもしくは &rsquo;<samp>termguicolors</samp>&rsquo; が設定されてゐる)、端末ウィンドウは常に、端末の根柢にある 16 ANSI カラーを使ふ。
</p>
<p>{Vim が |<a href="various_002etxt.html#g_t_002bterminal">+terminal</a>| 機能付きでコンパイルされたとき、かつ GUI が有效のとき、かつ/または |<a href="various_002etxt.html#g_t_002btermguicolors">+termguicolors</a>| 機能付きでコンパイルされたときのみ有效}
</p>
<a name="term_005fsetkill_0028_0029"></a><a name="index-term_005fsetkill_0028_0029"></a>
</dd>
<dt>term_setkill({buf}, {how})</dt>
<dd><p>Vim を終了もしくは他の方法で端末ウィンドウを閉ぢようとしてゐるとき、{how} は端末のジョブを停止することができるかどうか明確にする。
</p>
<p>{how} が空 (既定) のとき、ジョブは停止されず、終了しようとしたことは |<a href="#E947">E947</a>| の結果を生じる。さもなければ、{how} はジョブに送られたシグナルが何であるかを明示する。値については |<a href="eval_002etxt.html#job_005fstop_0028_0029">job_stop()</a>| を參照。
</p>
<p>シグナルが送られたあと、Vim はジョブが實際に停止するのを確認するまでの時閒 (秒) 待機するだらう。
</p>
<a name="term_005fsetrestore_0028_0029"></a><a name="index-term_005fsetrestore_0028_0029"></a>
</dd>
<dt>term_setrestore({buf}, {command})</dt>
<dd><p>端末內のジョブを復歸するために、セッションファイル內に書き込むコマンドを設定する。セッションファイルに書き込まれる行は:
</p><pre class="verbatim">terminal ++curwin ++cols=%d ++rows=%d {command}
</pre><p>コマンドが適切にエスケープされてゐるか確認すること。
</p>
<p>&rsquo;shell&rsquo; を實行するには 空 {command} を使ふ。
</p>
<p>このウィンドウを復歸しないやうにするには &quot;NONE&quot; を使ふ。
</p>
<p>{Vim が |<a href="various_002etxt.html#g_t_002bterminal">+terminal</a>| 機能付きでコンパイルされたときのみ有效}
</p>
<a name="term_005fsetsize_0028_0029"></a><a name="E955"></a><a name="index-term_005fsetsize_0028_0029"></a>
<a name="index-E955"></a>
</dd>
<dt>term_setsize({buf}, {rows}, {cols})</dt>
<dd><p>ターミナル {buf} のサイズを設定する。もしも可能ならターミナルを含んでゐるウィンドウのサイズも調整されるだらう。もしも {rows} や {cols} がゼロかマイナスならば、サイズは變更されない。
</p>
<p>{buf} は端末ウィンドウのバッファ番號でなければならない。現在のバッファに適用するには空文字列を使ふ。もしもバッファが存在しないか端末ウィンドウでなければ、エラーになる。
</p>
<p>{Vim が |<a href="various_002etxt.html#g_t_002bterminal">+terminal</a>| 機能付きでコンパイルされたときのみ有效}
</p>
<a name="term_005fstart_0028_0029"></a><a name="index-term_005fstart_0028_0029"></a>
</dd>
<dt>term_start({cmd} [, {options}])</dt>
<dd><p>ターミナルウィンドウを開きその中で {cmd} を起動する。
</p>
<p>{cmd} は文字列もしくは |<a href="eval_002etxt.html#job_005fstart_0028_0029">job_start()</a>| のやうなリストになりうる。文字列 &quot;NONE&quot; はジョブを開始することなくターミナルウィンドウを開くのに使はれる。ターミナルの pty は gdb のやうなコマンドによつて使はれる。
</p>
<p>ターミナルウィンドウのバッファ番號を返す。{cmd} が實行できないときは、ウィンドウを開いてエラーメッセジを表示する。
</p>
<p>ウィンドウを開くのに失敗すると 0 が返される。
</p>
<p>{options} は |<a href="eval_002etxt.html#job_005fstart_0028_0029">job_start()</a>| で使はれるものと似てゐる。|<a href="channel_002etxt.html#job_002doptions">job-options</a>| を參照。しかしながら、すべてのオプションが使はれるわけではない。次のものがサポートされてゐる:
すべてのタイムアウトオプション
</p><div class="example">
<pre class="example">&quot;stoponexit&quot;, &quot;cwd&quot;, &quot;env&quot;
&quot;callback&quot;, &quot;out_cb&quot;, &quot;err_cb&quot;, &quot;exit_cb&quot;, &quot;close_cb&quot;
&quot;in_io&quot;, &quot;in_top&quot;, &quot;in_bot&quot;, &quot;in_name&quot;, &quot;in_buf&quot;
&quot;out_io&quot;, &quot;out_name&quot;, &quot;out_buf&quot;, &quot;out_modifiable&quot;, &quot;out_msg&quot;
&quot;err_io&quot;, &quot;err_name&quot;, &quot;err_buf&quot;, &quot;err_modifiable&quot;, &quot;err_msg&quot;
</pre></div>
<p>少なくとも標準入力が 1 つであるが、標準出力か標準エラーはターミナルに接續されてゐなければならない。I/O がターミナルに接續されてゐるときは、その部分のコールバック函數は使はれない。
</p>
<p>特別なオプションがある:
</p><table>
<tr><td width="30%">&quot;term_name&quot;</td><td width="70%">バッファ名に使ふ名前。コマンド名の代はり</td></tr>
<tr><td width="30%">&quot;term_rows&quot;</td><td width="70%">ターミナルで使ふ高さ。&rsquo;<samp>termwinsize</samp>&rsquo; の代はり</td></tr>
<tr><td width="30%">&quot;term_cols&quot;</td><td width="70%">ターミナルで使ふ幅。&rsquo;<samp>termwinsize</samp>&rsquo; の代はり</td></tr>
<tr><td width="30%">&quot;vertical&quot;</td><td width="70%">ウィンドウを垂直に分割する。
<blockquote>
<p><strong>Note:</strong> <br>
その他のウィンドウ位置は |<a href="windows_002etxt.html#g_t_003abelowright">:belowright</a>| のやうなコマンド修飾子によつて定義されうることに注意。
</p></blockquote></td></tr>
<tr><td width="30%">&quot;curwin&quot;</td><td width="70%">カレントウィンドウを使ふ。ウィンドウは分割しない。カレントバッファを抛棄 |<a href="editing_002etxt.html#abandon">abandon</a>| できなければ失敗する</td></tr>
<tr><td width="30%">&quot;hidden&quot;</td><td width="70%">ウィンドウを開かない</td></tr>
<tr><td width="30%">&quot;norestore&quot;</td><td width="70%">セッションファイルのためにターミナルウィンドウを追加しない</td></tr>
<tr><td width="30%">&quot;term_kill&quot;</td><td width="70%">端末ウィンドウを閉ぢようとしたときにすること。|<a href="#term_005fsetkill_0028_0029">term_setkill()</a>| を參照</td></tr>
<tr><td width="30%">&quot;term_finish&quot;</td><td width="70%">ジョブが終了したときの處理:
<table>
<tr><td width="20%">&quot;close&quot;:</td><td width="80%">すべてウィンドウを閉ぢる</td></tr>
<tr><td width="20%">&quot;open&quot;:</td><td width="80%">必要ならばウィンドウを開く</td></tr>
</table>
<blockquote>
<p><strong>Note:</strong> <br>
&quot;open&quot; は中斷できることに注意。
</p></blockquote>
<p>|<a href="#term_002b_002bclose">term++close</a>| と |<a href="#term_002b_002bopen">term++open</a>| を參照。
</p></td></tr>
<tr><td width="30%">&quot;term_opencmd&quot;</td><td width="70%">&quot;term_finish&quot; のために &quot;open&quot; が使はれるとき、ウィンドウを開くためのコマンド。バッファ番號の先に &quot;%d&quot; がなければならない。例へば &quot;10split|buffer %d&quot;。これが指定されてゐなければ、&quot;botright sbuf %d&quot; が使はれる。</td></tr>
<tr><td width="30%">&quot;eof_chars&quot;</td><td width="70%">ターミナルに書き込まれるすべてのバッファ行のあとに送られるテキスト。これが設定されてゐないとき、MS-Windows では CTRL-D が使はれる。Python では CTRL-Z か &quot;exit()&quot; が使はれる。シェルでは &quot;exit&quot; が使はれる。CR は常に付加される。</td></tr>
<tr><td width="30%">&quot;ansi_colors&quot;</td><td width="70%">16 ANSI カラーの名前か GUI カラーモードで使はれてゐる ANSI パレットで定義されてゐる 16 進數のカラーコードのリスト。|<a href="#g_003aterminal_005fansi_005fcolors">g:terminal_ansi_colors</a>| を參照</td></tr>
<tr><td width="30%">&quot;tty_type&quot;</td><td width="70%">(MS-Windows のみ): 使用する pty を明示しまう。値については &rsquo;<samp>termwintype</samp>&rsquo; を參照してください。</td></tr>
</table>
<p>{Vim が |<a href="various_002etxt.html#g_t_002bterminal">+terminal</a>| 機能付きでコンパイルされたときのみ有效}
</p>
</dd>
<dt>term_wait({buf} [, {time}])</dt>
<dd><a name="term_005fwait_0028_0029"></a><a name="index-term_005fwait_0028_0029"></a>
<p>處理する {buf} の更新を待つ。
</p>
<p>{buf} は |<a href="#term_005fgetsize_0028_0029">term_getsize()</a>| として使はれる。
</p>
<p>{time} はアップデートまでのミリ秒。設定されてゐなければ 10 ミリ秒が使はれる。
</p>
<p>{Vim が |<a href="various_002etxt.html#g_t_002bterminal">+terminal</a>| 機能付きでコンパイルされたときのみ有效}
</p></dd>
</dl>

<a name="terminal_002dcommunication"></a><a name="index-terminal_002dcommunication"></a>
<a name="g_t3_002e-Duan-Mo-Tong-Xin-"></a>
<h3 class="section">3. 端末通信</h3>

<p>端末內で實行中のジョブと通信するには、いくつかの方法があります:
</p><ul>
<li> |<a href="#term_005fsendkeys_0028_0029">term_sendkeys()</a>| でテキストやエスケープシーケンスを Vim に送信する。
</li><li> JSON API を使用して、エンコードされたコマンドをジョブから Vim に送信する。
</li><li> |<a href="remote_002etxt.html#client_002dserver">client-server</a>| 機構を使ひます。これは X server と MS-Windows のマシンで動作します。
</li></ul>


<a name="terminal_002dto_002djob"></a><a name="index-terminal_002dto_002djob"></a>
<a name="Vim-karaziyobuhe_003a-term_005fsendkeys_0028_0029"></a>
<h4 class="unnumberedsubsec">Vim からジョブへ: term_sendkeys()</h4>
<p>これにより、端末內で實行中のジョブをリモート制禦することができます。これは一方向の機構です。ジョブは Vim に合圖することで表示を更新することができます。例へば、シェルが端末內で實行されてゐる場合、次の操作を實行できます:
</p><pre class="verbatim">call term_sendkeys(buf, &quot;ls *.java\&lt;CR&gt;&quot;)
</pre>
<p>これは、キーを受け取つたときに正しいことをする適切な狀態になるやうなジョブを必要とします。上記の例では、シェルはコマンドの入力を待つ必要があります。
</p>
<p>この目的のために作成されたジョブでは、JSON API エスケープシーケンスを別の方向で使用できます。例:
</p><pre class="verbatim">call term_sendkeys(buf, &quot;\&lt;Esc&gt;]51;[&quot;response&quot;]\x07&quot;)
</pre>

<a name="terminal_002dapi"></a><a name="index-terminal_002dapi"></a>
<a name="ziyobukara-Vim-he_003a-JSON-API"></a>
<h4 class="unnumberedsubsec">ジョブから Vim へ: JSON API</h4>
<p>ジョブは特殊なエスケープシーケンスを使用して JSON を Vim に送ることができます。JSON は Vim が理解できるコマンドをエンコードします。そのやうなメッセージの例:
</p><pre class="verbatim">&lt;Esc&gt;]51;[&quot;drop&quot;, &quot;README.md&quot;]&lt;07&gt;
</pre>
<p>本體は常にリストになつてをり、終はりを見つけやすいです: &lsquo;<samp>]&lt;07&gt;</samp>&rsquo;。&lsquo;<samp>&lt;Esc&gt;]51;msg&lt;07&gt;</samp>&rsquo; シーケエンスは &quot;Emacs shell&quot; のために xterm によつて豫約されてゐます。私たちがここでやつてゐることに似てゐます。
</p>
<a name="Xian-Zai-sapotosareteirukomando_003a"></a>
<h4 class="unnumberedsubsubsec">現在サポートされてゐるコマンド:</h4>

<dl compact="compact">
<dt>call {funcname} {argument}</dt>
<dd><p>ユーザー定義函數を {argument} で呼び出します。函數は 2 つの引數で呼び出されます: 端末のバッファ番號とデコードされた JSON 引數 {argument} です。
</p>
<p>函數名は端末 API 用に意圖されてゐない函數を誤つて呼び出すのを避けるため、&quot;Tapi_&quot; で始まる必要があります。
</p>
<p>ユーザー函數は引數の正常性チェックをする必要があります。
函數は |<a href="#term_005fsendkeys_0028_0029">term_sendkeys()</a>| を使つて返信を送り返すことができます。
</p>
<p>JSON での例:
</p><pre class="verbatim">[&quot;call&quot;, &quot;Tapi_Impression&quot;, [&quot;play&quot;, 14]]
</pre><p>次のやうに定義された函數を呼び出します:
</p><pre class="verbatim">function Tapi_Impression(bufnum, arglist)
  if len(a:arglist) == 2
    echomsg &quot;impression &quot; . a:arglist[0]
    echomsg &quot;count &quot; . a:arglist[1]
  endif
endfunc
</pre><p>&lsquo;<code>:echo</code>&lsquo; からの出力は再描畫によつて消去されかもしれません。&lsquo;<code>:echomsg</code>&lsquo; を使ひ、&lsquo;<code>:messages</code>&lsquo; でそれを見ることができます。
</p>
</dd>
<dt>drop {filename} [options]</dt>
<dd><p>Vim に &lsquo;<code>:drop</code>&lsquo; コマンドのやうにファイルを開かせます。もし、{filename} が既にウィンドウで開かれてゐたら、そのウィンドウに切り替へます。それ以外の場合は、{filename} を編輯するための新しいウィンドウを開きます。
</p><blockquote>
<p><strong>Note:</strong> <br>
ジョブと Vim の兩方がカレントディレクトリを變更する可能性があるので、フルパスを使用することをお勸めします。
</p></blockquote>

<p>[options] は新しくウィンドウを開いた時にだけ使はれます。與へる場合、それは辭書でなければなりません。|<a href="editing_002etxt.html#g_t_002b_002bopt">++opt</a>| と同樣に、これらのエントリは認識されます:
</p><table>
<tr><td width="30%">&quot;ff&quot;</td><td width="70%">ファイルフォーマット: &quot;dos&quot;, &quot;mac&quot; もしくは &quot;unix&quot;</td></tr>
<tr><td width="30%">&quot;fileformat&quot;</td><td width="70%">同上</td></tr>
<tr><td width="30%">&quot;enc&quot;</td><td width="70%">&rsquo;<samp>fileencoding</samp>&rsquo; を上書きします</td></tr>
<tr><td width="30%">&quot;encoding&quot;</td><td width="70%">同上</td></tr>
<tr><td width="30%">&quot;bin&quot;</td><td width="70%">&rsquo;<samp>binary</samp>&rsquo; を設定します</td></tr>
<tr><td width="30%">&quot;binary&quot;</td><td width="70%">同上</td></tr>
<tr><td width="30%">&quot;nobin&quot;</td><td width="70%">&rsquo;<samp>binary</samp>&rsquo; をリセットします</td></tr>
<tr><td width="30%">&quot;nobinary&quot;</td><td width="70%">同上</td></tr>
<tr><td width="30%">&quot;bad&quot;</td><td width="70%">不正な文字のための振る舞ひを指定します。|<a href="editing_002etxt.html#g_t_002b_002bbad">++bad</a>| を參照</td></tr>
</table>


<p>JSON での例:
</p><pre class="verbatim">[&quot;drop&quot;, &quot;path/file.txt&quot;, {&quot;ff&quot;: &quot;dos&quot;}]
</pre></dd>
</dl>

<p>Vim にこのエスケープシーケエンスを送信させるトリック:
</p><pre class="verbatim">exe &quot;set t_ts=\&lt;Esc&gt;]51; t_fs=\x07&quot;
let &amp;titlestring = '[&quot;call&quot;,&quot;Tapi_TryThis&quot;,[&quot;hello&quot;,123]]'
redraw
set t_ts&amp; t_fs&amp;
</pre>
<p>論理的根據: コマンドや式を許可しないのはなぜですか？セキュリティ上の問題が生じる可能性があるためです。
</p>

<a name="terminal_002dclient_002dserver"></a><a name="index-terminal_002dclient_002dserver"></a>
<a name="kuraiantosabaJi-Neng-woShi-u"></a>
<h4 class="unnumberedsubsec">クライアントサーバー機能を使ふ</h4>
<p>これは v:servername が空ではない場合にのみ機能します。必要に應じて、端末を開く前に次のやうに設定することができます:
</p><pre class="verbatim">call remote_startserver('vim-server')
</pre>
<p><code>$VIM_SERVERNAME</code> はサーバー名を渡すために端末內に設定されます。
</p>
<p>ジョブでは、次のやうなことをおこなふことができます:
</p><pre class="verbatim">vim --servername $VIM_SERVERNAME --remote +123 some_file.c
</pre><p>これによりファイル &quot;<samp>some_file.c</samp>&quot; が開き、123 行目にカーソルが置かれます。
</p>
<a name="terminal_002dtesting"></a><a name="index-terminal_002dtesting"></a>
<a name="g_t4_002e-rimototesuto"></a>
<h3 class="section">4. リモートテスト</h3>

<p>Vim のほとんどのテストは Vim のなかでスクリプトを實行してゐます。テスト對象のコードと干涉してしまふやうな、幾つかのテストではこれは機能しません。これを避けるために端末ウィンドウ內でさらに Vim を實行してゐます。そのテストではキーストロークを端末に送信し、その結果として端末畫面の狀態が變はるのを檢査します。
</p>
<a name="Guan-Shu--1"></a>
<h4 class="unnumberedsubsec">函數</h4>

<table>
<tr><td width="30%">|<a href="#term_005fsendkeys_0028_0029">term_sendkeys()</a>|</td><td width="70%">端末にキーストロークを送信する (tmap の影響を受けない)</td></tr>
<tr><td width="30%">|<a href="#term_005fwait_0028_0029">term_wait()</a>|</td><td width="70%">端末畫面が更新されるのを待つ</td></tr>
<tr><td width="30%">|<a href="#term_005fscrape_0028_0029">term_scrape()</a>|</td><td width="70%">端末畫面の內容を檢査する</td></tr>
</table>


<a name="terminal_002ddiff"></a><a name="index-terminal_002ddiff"></a>
<a name="g_t5_002e-Hua-Mian-danpunoChai-Fen-"></a>
<h3 class="section">5. 畫面ダンプの差分</h3>

<p>場合によつては、Vim が正しい文字を畫面に表示するかどうかテストするのは面倒かもしれません。例へば、構文の强調表示。これを簡單にするために、端末の畫面ダンプを取つてそれを豫想される畫面ダンプと比較することが可能です。
</p>
<p>Vim はウィンドウのサイズ、テキスト、色、その他の屬性を表示します。 Vim の畫面サイズ、フォント、その他のプロパティは關係ありません。したがつて、この機構はシステム閒で移植可能です。從來のスクリーンショットでは、フォントサイズやフォントファミリーなど、すべての違ひが反映されます。
</p>

<a name="terminal_002ddumptest"></a><a name="index-terminal_002ddumptest"></a>
<a name="Vim-noHua-Mian-danputesutowoShu-ku"></a>
<h4 class="unnumberedsubsec">Vim の畫面ダンプテストを書く</h4>
<p>例については、src/testdir/test_syntax.vim の Test_syntax_c() 函數を參照してください。主要な部分は:
</p><ul>
<li> テストするファイルを作成します。構文のハイライトをテストするのに便利です。空のバッファで Vim を起動することもできます。
</li><li> 特定のサイズの端末で Vim を實行します。デフォルトは 75 桁で 20 行です。これはダンプが常にこのサイズであることを確認します。RunVimInTerminal() 函數がこれを處理します。Vim コマンドの引數を渡します。
</li><li> |<a href="#term_005fsendkeys_0028_0029">term_sendkeys()</a>| を使用して任意のコマンドを Vim に送信します。例へば:
<pre class="verbatim">call term_sendkeys(buf, &quot;:echo &amp;lines &amp;columns\&lt;CR&gt;&quot;)
</pre></li><li> VerifyScreenDump() を使用して、畫面が期待どほりの狀態になつてゐることを確認します。これは、參照する畫面ダンプが src/testdir/dumps/ ディレクトリに存在することを前提としてゐます。 &quot;.dump&quot; なしの名前を渡します。テスト函數の名前とシーケンス番號を使用してファイルがどのやうなテストで使用されてゐるかを知ることができます。
</li><li> コマンド送信と狀態の確認を繰り返します。
</li><li> 最後に StopVimInTerminal() を呼び出して Vim を停止します。
</li></ul>

<p>初めてこれを行ふときにはスクリーンダンプはまだありません。空のファイルを作成します。例:
</p><pre class="verbatim">touch src/testdir/dumps/Test_function_name_01.dump
</pre>
<p>テストが失敗したら、參照ダンプと失敗したダンプを比較するコマンドを提供します。例:
</p><pre class="verbatim">call term_dumpdiff(&quot;Test_func.dump.failed&quot;, &quot;dumps/Test_func.dump&quot;)
</pre>
<p>カレントディレクトリを src/testdir に設定して、Vim でこのコマンドを使用します。テストに滿足したら、參照の代はりに失敗したダンプを移動します:
</p><pre class="verbatim">:!mv Test_func.dump.failed dumps/Test_func.dump
</pre>

<a name="terminal_002dscreendump"></a><a name="index-terminal_002dscreendump"></a>
<a name="Hua-Mian-danpuwoZuo-Cheng-suru"></a>
<h4 class="unnumberedsubsec">畫面ダンプを作成する</h4>

<p>畫面ダンプを作成するには、端末で Vim (または他のプログラム) を實行し、目的の狀態を表示させます。その後、|<a href="#term_005fdumpwrite_0028_0029">term_dumpwrite()</a>| 函數を使用して畫面ダンプファイルを作成します。例:
</p><pre class="verbatim">:call term_dumpwrite(77, &quot;mysyntax.dump&quot;)
</pre>
<p>この &quot;77&quot; は端末のバッファ番號です。それを見るためには &lsquo;:ls!&lsquo; を使用してください。
</p>
<p>|<a href="#term_005fdumpload_0028_0029">term_dumpload()</a>| で畫面ダンプを見ることができます:
</p><pre class="verbatim">:call term_dumpload(&quot;mysyntax.dump&quot;)
</pre>
<p>Vim がまつたく同じ畫面を表示してゐることを確認するには、まつたく同じ方法で Vim を再度實行し、目的の狀態を表示します。次に、別のファイル名を使用して畫面ダンプを再度作成します:
</p><pre class="verbatim">:call term_dumpwrite(88, &quot;test.dump&quot;)
</pre>
<p>ファイルがまつたく同じものであることを主張するには |<a href="eval_002etxt.html#assert_005fequalfile_0028_0029">assert_equalfile()</a>| を使ひます:
</p><pre class="verbatim">call assert_equalfile(&quot;mysyntax.dump&quot;, &quot;test.dump&quot;)
</pre>
<p>違ひがある場合、v:errors はエラーメッセージを含みます。
</p>

<a name="terminal_002ddiffscreendump"></a><a name="index-terminal_002ddiffscreendump"></a>
<a name="Hua-Mian-danpuwoBi-Jiao-suru"></a>
<h4 class="unnumberedsubsec">畫面ダンプを比較する</h4>

<p>|<a href="eval_002etxt.html#assert_005fequalfile_0028_0029">assert_equalfile()</a>| は、何が違ふのかを簡單に見分けることはできません。問題を見つけるには、|<a href="#term_005fdumpdiff_0028_0029">term_dumpdiff()</a>| を使用します:
</p><pre class="verbatim">call term_dumpdiff(&quot;mysyntax.dump&quot;, &quot;test.dump&quot;)
</pre>
<p>これで 3 つの部分からなるウィンドウが開きます:
</p><ol>
<li> 1 番目のダンプの內容
</li><li> 1 番目と 2 番目のダンプの差分
</li><li> 2 番目のダンプの內容
</li></ol>

<p>通常、2 番目の部分で何が違ふかを見ることができます。1 番目または 2 番目ダンプの位置に關聯付けるには &rsquo;<samp>ruler</samp>&rsquo; を使用します。文字の意味は次のやうになつてゐる:
</p><table>
<tr><td width="10%">X</td><td width="90%">文字の差異</td></tr>
<tr><td width="10%">&gt;</td><td width="90%">1 番目にあつて 2 番目にはないカーソル</td></tr>
<tr><td width="10%">&lt;</td><td width="90%">2 番目にあつて 1 番目にはないカーソル</td></tr>
<tr><td width="10%">w</td><td width="90%">文字幅の差異 (シングル對ダブル幅)</td></tr>
<tr><td width="10%">f</td><td width="90%">前景色の差異</td></tr>
<tr><td width="10%">b</td><td width="90%">背景色の差異</td></tr>
<tr><td width="10%">a</td><td width="90%">特徵の差異 (太字、下線、反轉など)</td></tr>
<tr><td width="10%">?</td><td width="90%">どちらにもない文字</td></tr>
<tr><td width="10%">+</td><td width="90%">1 番目にはない文字</td></tr>
<tr><td width="10%">-</td><td width="90%">2 番目にはない文字</td></tr>
</table>

<p>あるいは、&quot;s&quot; を押して、1 番目と 2 番目のダンプを入れ替へます。これを何度か實行して、テキストの文脈における相違を見つけ出すことができます。
</p>
<a name="terminal_002ddebug"></a><a name="terminal_002ddebugger"></a><a name="index-terminal_002ddebug"></a>
<a name="index-terminal_002ddebugger"></a>
<a name="g_t6_002e-debatugu"></a>
<h3 class="section">6. デバッグ</h3>

<p>Vim のウィンドウでソースコードを表示しながらプログラムを gdb でデバッグするのに、端末デバッグプラグインが利用できます。これは Vim の中だけで完結するので、SSH 接續が 1 つあればリモートで機能します。
</p>
<p>|<a href="various_002etxt.html#g_t_002bterminal">+terminal</a>| 機能がない場合、プラグインは可能であれば &quot;prompt&quot; バッファタイプを使用します。實行中のプログラムは、新しく開かれた端末ウィンドウを使用します。詳細は |<a href="#termdebug_002dprompt">termdebug-prompt</a>| を參照してください。
</p>

<a name="termdebug_002dstarting"></a><a name="index-termdebug_002dstarting"></a>
<a name="hazimeni-2"></a>
<h4 class="unnumberedsubsec">はじめに</h4>
<p>以下のコマンドでプラグインを讀み込みます:
</p><pre class="verbatim">packadd termdebug
</pre><a name="g_t_003aTermdebug"></a><a name="index-_003aTermdebug"></a>
<p>デバッグを開始するには &lsquo;<code>:TermDebug</code>&lsquo; または &lsquo;<code>:TermdebugCommand</code>&lsquo; に續けてコマンド名を入力します。例:
</p><pre class="verbatim">:TermDebug vim
</pre>
<p>これにより 2 つのウィンドウが開きます:
</p>
<table>
<tr><td width="30%">gdb のウィンドウ</td><td width="70%">&quot;gdb vim&quot; を實行した端末ウィンドウ。ここでは直接 gdb とやりとりできる。バッファ名は &quot;!gdb&quot;</td></tr>
<tr><td width="30%">プログラムのウィンドウ</td><td width="70%">實行したプログラムの端末ウィンドウ。gdb 內で &quot;run&quot; をしてプログラムの I/O が發生するとこのウィンドウに反映される。その內容は gdb の制禦下にない。バッファ名は &quot;gdb program&quot;</td></tr>
</table>

<p>現在のウィンドウはソースコードを表示するのに使はれます。gdb が一時停止した際に、可能ならばその場所が表示されます。現在の位置を示すためにハイライトグループ debugPC を使つてサインが利用されます。
</p>
<p>現在のウィンドウの內容が變更されると、現在の gdb の位置を表示するために別のウィンドウが開きます。&lsquo;<code>:Winbar</code>&lsquo; を使つてウィンドウツールバーを追加することができます。
</p>
<p>實行中のプログラムを操作するにはその端末にフォーカスを合はせます。以降の操作は普通の端末ウィンドウと同樣です。
</p>
<p>デバッガの終了は、通常は gdb のウィンドウで &quot;quit&quot; とタイプすると、開いてゐる 2 つのウィンドウが閉ぢられます。
</p>
<p>一度にアクティブにできるデバッガは 1 つだけです。
<a name="g_t_003aTermdebugCommand"></a><a name="index-_003aTermdebugCommand"></a>
デバッグ中のコマンドに特定のコマンドを與へる場合は、&lsquo;<code>:TermdebugCommand</code>&lsquo; コマンドの後にコマンド名と追加パラメータを使用できます。
</p><pre class="verbatim">:TermdebugCommand vim --clean -c ':set nu'
</pre>
<p>&lsquo;<code>:Termdebug</code>&lsquo; と &lsquo;<code>:TermdebugCommand</code>&lsquo; はオプションの &quot;!&quot; をサポートしてゐます。gdb ウィンドウで一時停止せずにコマンドをすぐに開始します (そしてカーソルはデバッグされたウィンドウに表示されます) 例へば:
</p><pre class="verbatim">:TermdebugCommand! vim --clean
</pre>
<p>すでに實行中の實行可能ファイルに gdb をアタッチするか、コアファイルを使用するには、追加の引數を渡します。例:
</p><pre class="verbatim">:Termdebug vim core
:Termdebug vim 98343
</pre>
<p>引數が指定されてゐない場合、gdb ウィンドウが表示されます。このウィンドウでは、例へば gdb の &lsquo;<code>file</code>&lsquo; コマンドを使つて、どのコマンドを實行するか指定する必要があります。
</p>

<a name="termdebug_002dexample"></a><a name="index-termdebug_002dexample"></a>
<a name="setusiyonLi"></a>
<h4 class="unnumberedsubsec">セッション例</h4>
<p>Vim の &quot;src&quot; ディレクトリを起動して、Vim をビルドします:
</p><pre class="verbatim">% make
</pre><p>Vim を起動します:
</p><pre class="verbatim">% ./vim
</pre><p>termdebug プラグインを讀み込んで、Vim のデバッグを開始します:
</p><pre class="verbatim">:packadd termdebug
:Termdebug vim
</pre><p>これで、3 つのウィンドウが表示されます:
</p><ul>
<li> source  - 開始直後はボタン付きウィンドウツールバーがあります
</li><li> gdb     - ここに gdb コマンドを入力できます
</li><li> program - 實行されたプログラムはこのウィンドウを使用します
</li></ul>

<p><kbd>CTRL-W CTRL-W</kbd> またはマウスを使用して、ウィンドウ閒でフォーカスを移動できます。gdbウィンドウにフォーカスを當てて、次のやうに入力します:
</p><pre class="verbatim">break ex_help
run
</pre><p>Vim は programウィンドウで實行を開始します。そこにフォーカスを置いて入力します:
</p><pre class="verbatim">:help gui
</pre><p>Gdb は ex_help ブレークポイントまで實行します。source ウィンドウに <samp>ex_cmds.c</samp> ファイルが表示されます。ブレークポイントが設定されてゐる目印欄に赤い &quot;1 &quot; のマーカーが表示されます。デバッガが停止した行が强調表示されます。今すぐプログラムを進めることができます。マウスを使ひませう: ウィンドウツールバーの &quot;Next&quot; ボタンをクリックしてください。デバッガがソースコードの行を實行すると、强調表示されます。
</p>
<p>for ループが强調表示されるまで、&quot;Next&quot; を數回クリックします。カーソルを &quot;eap-&gt;arg&quot; の最後に置き、ツールバーの &quot;Eval&quot; をクリックします。これが表示されます:
</p><pre class="verbatim">&quot;eap-&gt;arg&quot;: 0x555555e68855 &quot;gui&quot;
</pre><p>かうすることで、ローカル變數の値を調べることができます。また、gdb ウィンドウにフォーカスを當てて、&quot;print&quot; コマンドを使用することもできます。例:
</p><pre class="verbatim">print *eap
</pre><p>マウスポインタの動きがうまくいつてゐれば、マウスが gdb で評價できるテキストの上に置かれたときに Vim はバルーンを表示します。
</p>
<p>次に、source ウィンドウに戾り、for ループの後の最初の行にカーソルを置いて、次のやうに入力します:
</p><pre class="verbatim">:Break
</pre><p>新しいブレークポイントを示す &quot;&gt;&gt;&quot; マーカーが表示されます。ツールバーの &quot;Cont&quot; をクリックして、コードをブレークポイントまで實行させます。
</p>
<p>より高度なコマンドを gdb ウィンドウに入力することができます。たとへば、次のやうに入力します:
</p><pre class="verbatim">watch curbuf
</pre><p>ツールバーの &quot;Cont&quot; をクリックします (または、gdb ウィンドウで &quot;cont&quot; と入力します)。do_ecmd() にある &quot;curbuf&quot; の値が變更されるまで、實行が繼續されます。このウォッチポイントを再度削除するには、gdb ウィンドウで次のやうに入力します:
</p><pre class="verbatim">delete 3
</pre>
<p>gdb ウィンドウに次のやうに入力すると、スタックが表示されます:
</p><pre class="verbatim">where
</pre><p>スタックフレームを移動します。例へば:
</p><pre class="verbatim">frame 3
</pre><p>source ウィンドウには、より深いレベルに呼び出された時點のコードが表示されます。
</p>

<a name="termdebug_002dstepping"></a><a name="index-termdebug_002dstepping"></a>
<a name="kodowosutetupuShi-Xing-suru"></a>
<h4 class="unnumberedsubsec">コードをステップ實行する</h4>
<p>gdb ウィンドウにフォーカスを移しコマンドを入力します。一般的なものは以下:
</p><ul>
<li> CTRL-C    プログラムを中斷する
</li><li> next      現在の行を實行し、次の行 (の手前) で停止する
</li><li> step      現在の行を實行し、次の文 (の手前) で停止する。函數の內側に入る
</li><li> finish    現在の函數を拔けるまで實行する
</li><li> where     スタックを表示する
</li><li> frame N   N 番目のスタックフレームに移動する
</li><li> continue  實行を再開する
</li></ul>

<a name="g_t_003aRun"></a><a name="g_t_003aArguments"></a><a name="index-_003aRun"></a>
<a name="index-_003aArguments"></a>
<p>ソースコードを表示してゐるウィンドウで、これらのコマンドを gdb の制禦に使用できます:
</p><table>
<tr><td width="30%">&lsquo;:Run&lsquo; [args]</td><td width="70%">[args] または以前の引數でプログラムを實行します</td></tr>
<tr><td width="30%">&lsquo;:Arguments&lsquo; {args}</td><td width="70%">次の &lsquo;<code>:Run</code>&lsquo; のために引數を設定します

<a name="g_t_003aBreak"></a><a name="index-_003aBreak"></a></td></tr>
<tr><td width="30%">:Break</td><td width="70%">現在の行にブレークポイントを設定する。サインが表示される
<a name="g_t_003aClear"></a><a name="index-_003aClear"></a></td></tr>
<tr><td width="30%">:Clear</td><td width="70%">現在の行のブレークポイントを削除する

<a name="g_t_003aStep"></a><a name="index-_003aStep"></a></td></tr>
<tr><td width="30%">:Step</td><td width="70%">gdb の &quot;step&quot; コマンドを實行する
<a name="g_t_003aOver"></a><a name="index-_003aOver"></a></td></tr>
<tr><td width="30%">:Over</td><td width="70%">gdb の &quot;next&quot; コマンドを實行する (&lsquo;<code>:Next</code>&lsquo; だと Vim のコマンドとかぶるので)
<a name="g_t_003aFinish"></a><a name="index-_003aFinish"></a></td></tr>
<tr><td width="30%">:Finish</td><td width="70%">gdb の &quot;finish&quot; コマンドを實行する
<a name="g_t_003aContinue"></a><a name="index-_003aContinue"></a></td></tr>
<tr><td width="30%">:Continue</td><td width="70%">gdb の &quot;continue&quot; コマンドを實行する
<a name="g_t_003aStop"></a><a name="index-_003aStop"></a></td></tr>
<tr><td width="30%">:Stop</td><td width="70%">プログラムを中斷する</td></tr>
</table>

<p>&rsquo;<samp>mouse</samp>&rsquo; が設定されてゐる場合、プラグインはこれらのエントリを持つウィンドウツールバーを追加します:
</p><pre class="verbatim">Step          `:Step`
Next          `:Over`
Finish        `:Finish`
Cont          `:Continue`
Stop          `:Stop`
Eval          `:Evaluate`
</pre><p>この方法で、マウスを使用して最も一般的なコマンドを實行できます。マウスのクリックを有效にするには、&rsquo;<samp>mouse</samp>&rsquo; オプションを設定する必要があります。
<a name="g_t_003aWinbar"></a><a name="index-_003aWinbar"></a>
開いてゐる他のウィンドウにウィンドウツールバーを追加することができます:
</p><pre class="verbatim">:Winbar
</pre>
<p>gdb がソース行で停止し、現在ソースコードを表示してゐるウィンドウがない場合、ソースコード用の新しいウィンドウが作成されます。これは、ソースコードウィンドウのバッファが變更され、破毀できない場合でも發生します。
</p>
<p>Gdb は各ブレークポイントに番號を與へます。Vim 內では、赤い背景で、目印欄に表示されます。次の gdb コマンドを使用できます。
</p><ul>
<li> info break: ブレークポイントの一覽
</li><li> delete N: ブレークポイント N を削除
</li></ul>
<p>また、カーソルがブレークポイントの行にある場合は &lsquo;<code>:Clear</code>&lsquo; コマンドを使ふことができます。または、右クリックのメニュー項目 &quot;Clear breakpoint&quot; を使用することもできます。
</p>

<a name="termdebug_002dvariables"></a><a name="g_t_003aEvaluate"></a><a name="index-termdebug_002dvariables"></a>
<a name="index-_003aEvaluate"></a>
<a name="Bian-Shu-woJian-Cha-suru"></a>
<h4 class="unnumberedsubsec">變數を檢査する</h4>
<table>
<tr><td width="30%">&lsquo;:Evaluate&lsquo;</td><td width="70%">カーソルの下の式を評價する</td></tr>
<tr><td width="30%">&lsquo;K&lsquo;</td><td width="70%">上に同じ</td></tr>
<tr><td width="30%">&lsquo;:Evaluate&lsquo; {expr}</td><td width="70%">{expr} を評價する</td></tr>
<tr><td width="30%">&lsquo;:&rsquo;&lt;,&rsquo;&gt;Evaluate&lsquo;</td><td width="70%">ビジュアル選擇したテキストを評價する</td></tr>
</table>

<p>これは gdb ウィンドウで &quot;print&quot; コマンドを使つたのに相當します。&lsquo;:Evaluate&lsquo; は &lsquo;:Ev&lsquo; に短縮できます。
</p>

<a name="termdebug_002dcommands"></a><a name="index-termdebug_002dcommands"></a>
<a name="sonoTa-nokomando"></a>
<h4 class="unnumberedsubsec">その他のコマンド</h4>
<table>
<tr><td><a name="g_t_003aGdb"></a><a name="index-_003aGdb"></a></td></tr>
<tr><td width="30%">:Gdb</td><td width="70%">gdb ウィンドウに移動する
<a name="g_t_003aProgram"></a><a name="index-_003aProgram"></a></td></tr>
<tr><td width="30%">:Program</td><td width="70%">デバッグ中のプログラムウィンドウに移動する
<a name="g_t_003aSource"></a><a name="index-_003aSource"></a></td></tr>
<tr><td width="30%">:Source</td><td width="70%">ソースコードのウィンドウに移動する。ウィンドウがなければ作成する</td></tr>
</table>


<a name="termdebug_002dprompt"></a><a name="index-termdebug_002dprompt"></a>
<a name="puronputomodo"></a>
<h4 class="unnumberedsubsec">プロンプトモード</h4>
<p>|<a href="various_002etxt.html#g_t_002bterminal">+terminal</a>| 機能がサポートされてゐない場合や MS-Windows 上の場合、gdb は &rsquo;<samp>buftype</samp>&rsquo; が &quot;<var>prompt</var>&quot; に設定されたバッファで動作します。これは少し違つた働きをします:
</p><ul>
<li> コマンドを入力してゐる閒、gdb ウィンドウは插入モードになります。&lt;Esc&gt; でノーマルモードにして、バッファ閒を移動したり、コピー/ペーストなどをおこなふことができます。&lsquo;<code>a</code>&lsquo; や &lsquo;<code>i</code>&lsquo; のやうな插入モードを開始するコマンドで gdb コマンドの編輯に戾ります。
</li><li> デバッグ中のプログラムは別のウィンドウで實行されます。MS-Windows では、これは新しいコンソールウィンドウです。Unix では、|<a href="various_002etxt.html#g_t_002bterminal">+terminal</a>| 機能が利用可能な場合、端末ウィンドウが開いてデバッグされたプログラムを實行します。
</li></ul>

<a name="termdebug_005fuse_005fprompt"></a><a name="index-termdebug_005fuse_005fprompt"></a>
<p>プロンプトモードは、|<a href="various_002etxt.html#g_t_002bterminal">+terminal</a>| 機能が有效な場合でも使用できます:
</p><pre class="verbatim">let g:termdebug_use_prompt = 1
</pre>

<a name="termdebug_002dcommunication"></a><a name="index-termdebug_002dcommunication"></a>
<a name="Tong-Xin-"></a>
<h4 class="unnumberedsubsec">通信</h4>
<p>Vim が gdb と通信するために他に隱されたバッファを利用します。バッファ名は &quot;gdb communicate&quot; です。このバッファは消さないでください。消してしまふとデバッガが動作しなくなつてしまふでせう。
</p>
<p>gdb は奇妙な動作をしてゐますが、プラグインはその問題を囘避するために最善を盡くしてゐます。例へば、gdb ウィンドウで &quot;continue&quot; と入力した後に、<kbd>CTRL-C</kbd> を使用して實行中のプログラムを中斷することができます。しかし、MI コマンド &quot;-exec-continue&quot; を使用した後、<kbd>CTRL-C</kbd> を押しても中斷しません。したがつて、通信チャネルを使用する代はりに、&lsquo;<code>:Continue</code>&lsquo; コマンドに &quot;continue&quot; が使用されてゐることがわかります。
</p>

<a name="kasutamaizu"></a>
<h4 class="unnumberedsubsec">カスタマイズ</h4>

<a name="termdebug_002dcustomizing"></a><a name="index-termdebug_002dcustomizing"></a>
<a name="GDB-komando"></a>
<h4 class="unnumberedsubsubsec">GDB コマンド</h4>

<p>gdb コマンド以外のデバッガを使ふには、 &lsquo;<code>:Termdebug</code>&lsquo; を實行する前に &quot;<var>termdebugger</var>&quot; 變數を變更してください:
</p><pre class="verbatim">let termdebugger = &quot;mygdb&quot;
</pre><a name="gdb_002dversion"></a><a name="index-gdb_002dversion"></a>
<p>gdb と完全互換のあるデバッガのみが使へます。Vim は gdb の操作に GDB/MI インターフェイスを利用してゐます。&quot;new-ui&quot; コマンドは gdb バージョン 7.12 以降が必要です。このエラーが發生した場合:
</p><pre class="verbatim">Undefined command: &quot;new-ui&quot;. Try &quot;help&quot;.
</pre><p>あなたの gdb が古すぎます。
</p>

<a name="hl_002ddebugPC"></a><a name="hl_002ddebugBreakpoint"></a><a name="index-hl_002ddebugPC"></a>
<a name="index-hl_002ddebugBreakpoint"></a>
<a name="kara"></a>
<h4 class="unnumberedsubsubsec">カラー</h4>

<p>サインの色は以下のハイライトグループで調整できます:
</p><table>
<tr><td width="40%">debugPC</td><td width="60%">現在の位置</td></tr>
<tr><td width="40%">debugBreakpoint</td><td width="60%">ブレークポイント</td></tr>
</table>

<p>&rsquo;<samp>background</samp>&rsquo; オプションが &quot;<var>light</var>&quot; の時のデフォルトは以下のとほりです:
</p><pre class="verbatim">hi debugPC term=reverse ctermbg=lightblue guibg=lightblue
hi debugBreakpoint term=reverse ctermbg=red guibg=red
</pre>
<p>&rsquo;<samp>background</samp>&rsquo; オプションが &quot;<var>dark</var>&quot; の時は以下のとほりです:
</p><pre class="verbatim">hi debugPC term=reverse ctermbg=darkblue guibg=darkblue
hi debugBreakpoint term=reverse ctermbg=red guibg=red
</pre>

<a name="termdebug_005fshortcuts"></a><a name="index-termdebug_005fshortcuts"></a>
<a name="siyotokatuto-1"></a>
<h4 class="unnumberedsubsubsec">ショートカット</h4>

<p>TermDebugSendCommand() 函數を使用して、任意のウィンドウで動作する gdb を制禦する獨自のショートカット (マッピング) を定義できます。例:
</p><pre class="verbatim">map ,w :call TermDebugSendCommand('where')&lt;CR&gt;
</pre><p>引數は gdb コマンドです。
</p>

<a name="termdebug_005fpopup"></a><a name="index-termdebug_005fpopup"></a>
<a name="potupuatupumeniyu-1"></a>
<h4 class="unnumberedsubsubsec">ポップアップメニュー</h4>

<p>デフォルトで Termdebug プラグインは &rsquo;<samp>mousemodel</samp>&rsquo; を &quot;<var>popup_setpos</var>&quot; に設定し、これらのエントリをポップアップメニューに追加します:
</p><pre class="verbatim">Set breakpoint          `:Break`
Clear breakpoint        `:Clear`
Evaluate                `:Evaluate`
</pre><p>あなたがこれを望まないならば、それを無效にしてください:
</p><pre class="verbatim">let g:termdebug_popup = 0
</pre>

<a name="termdebug_005fwide"></a><a name="index-termdebug_005fwide"></a>
<a name="Vim-nouindouFu-"></a>
<h4 class="unnumberedsubsubsec">Vim のウィンドウ幅</h4>

<p>デバッグを開始した際に Vim のウィンドウ幅を變更し、垂直分割を利用するには次のやうに設定します:
</p><pre class="verbatim">let g:termdebug_wide = 163
</pre><p>これは &lsquo;<code>:Termdebug</code>&lsquo; を實行した際に &amp;columns を 163 に設定します。元の値はデバッガが終了する際に復元されます。
</p>
<p>g:termdebug_wide が設定されてゐて、&amp;columns がすでに g:termdebug_wide より大きい場合、&amp;columns を變更せずに垂直分割が使用されます。&amp;columns を變更せずに垂直分割を行ふには、1 に設定します。(端末が Vim によつてサイズ變更できない場合に便利です)
</p>


<hr>
<div class="header">
<p>
Up: <a href="Mu-Ci-.html#g_t_76ee_6b21" accesskey="u" rel="up">目次</a> &nbsp; [<a href="Indexes-CP.html#Indexes-CP" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>

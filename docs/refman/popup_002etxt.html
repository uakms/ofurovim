<!DOCTYPE html>
<html lang="ja">
<!-- Created by GNU Texinfo 6.5, http://www.gnu.org/software/texinfo/ -->
<head>

<title>popup.txt (Vim Reference Manual)</title>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<meta name="description" content="popup.txt (Vim Reference Manual)">
<meta name="keywords" content="popup.txt (Vim Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2any">
<link href="Mu-Ci-.html#g_t_76ee_6b21" rel="start" title="目次">
<link href="Indexes-CP.html#Indexes-CP" rel="index" title="Indexes CP">
<link href="Mu-Ci-.html#g_t_76ee_6b21" rel="up" title="目次">
<link href="indent_002etxt.html#indent_002etxt" rel="next" title="indent.txt">
<link href="terminal_002etxt.html#terminal_002etxt" rel="prev" title="terminal.txt">
<style>
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>
<link rel="stylesheet" type="text/css" href="style.css">


</head>

<body lang="ja">
<a name="popup_002etxt"></a>
<div class="header">
<p>
Up: <a href="Mu-Ci-.html#g_t_76ee_6b21" accesskey="u" rel="up">目次</a> &nbsp; [<a href="Indexes-CP.html#Indexes-CP" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<a name="potupuatupuuindounosapoto"></a>
<h2 class="unnumbered">ポップアップウィンドウのサポート</h2>
<pre class="verbatim">*popup.txt*    For Vim バージョン 8.1.  Last change: 2019 Jul 18


		  VIMリファレンスマニュアル    by Bram Moolenaar
</pre>

<a name="popup"></a><a name="popup_002dwindow"></a><a name="index-popup"></a>
<a name="index-popup_002dwindow"></a>
<p>フローティングウィンドウにテキストを表示します。
</p>

<table>
<tr><td width="50%">1. 前書き</td><td width="50%">|<a href="#popup_002dintro">popup-intro</a>|</td></tr>
<tr><td width="50%">ウィンドウの位置とサイズ</td><td width="50%">|<a href="#popup_002dposition">popup-position</a>|</td></tr>
<tr><td width="50%">ポップアップウィンドウを閉ぢる</td><td width="50%">|<a href="#popup_002dclose">popup-close</a>|</td></tr>
<tr><td width="50%">ポップアップバッファとウィンドウ</td><td width="50%">|<a href="#popup_002dbuffer">popup-buffer</a>|</td></tr>
<tr><td width="50%">2. 函數</td><td width="50%">|<a href="#popup_002dfunctions">popup-functions</a>|</td></tr>
<tr><td width="50%">詳細</td><td width="50%">|<a href="#popup_002dfunction_002ddetails">popup-function-details</a>|</td></tr>
<tr><td width="50%">3. 使用方法</td><td width="50%">|<a href="#popup_002dusage">popup-usage</a>|</td></tr>
<tr><td width="50%">popup_create() の引數</td><td width="50%">|<a href="#popup_005fcreate_002darguments">popup_create-arguments</a>|</td></tr>
<tr><td width="50%">ポップアップテキストプロパティ</td><td width="50%">|<a href="#popup_002dprops">popup-props</a>|</td></tr>
<tr><td width="50%">ポップアップフィルタ</td><td width="50%">|<a href="#popup_002dfilter">popup-filter</a>|</td></tr>
<tr><td width="50%">ポップアップコールバック</td><td width="50%">|<a href="#popup_002dcallback">popup-callback</a>|</td></tr>
<tr><td width="50%">ポップアップスクロールバー</td><td width="50%">|<a href="#popup_002dscrollbar">popup-scrollbar</a>|</td></tr>
<tr><td width="50%">ポップアップマスク</td><td width="50%">|<a href="#popup_002dmask">popup-mask</a>|</td></tr>
<tr><td width="50%">4. 例</td><td width="50%">|<a href="#popup_002dexamples">popup-examples</a>|</td></tr>
</table>


<p>{|<a href="various_002etxt.html#g_t_002btextprop">+textprop</a>| 機能が無效でコンパイルされたときは使用できません}
</p>
<a name="popup_002dintro"></a><a name="index-popup_002dintro"></a>
<a name="g_t1_002e-Qian-Shu-ki"></a>
<h3 class="section">1. 前書き</h3>

<p>ここではポップアップウィンドウ、つまり通常のウィンドウの上に表示され、プラグインの管理下にあるテキストについて話しをします。通常のウィンドウのやうにポップアップウィンドウのテキストを編輯することはできません。
</p>
<p>ポップアップウィンドウは、次のやうな用途に使用できます:
</p><ul>
<li> コマンドラインを上書きせずに簡單にメッセージを表示する
</li><li> ユーザーにダイアログを表示する
</li><li> タイプ中にコンテキスト情報を表示する
</li><li> 自動補完のための追加情報を與へる
</li></ul>

<p>ポップアップウィンドウのテキストは |<a href="textprop_002etxt.html#text_002dproperties">text-properties</a>| で色を付けることができます。構文ハイライトを使用することもできます。
</p>
<p>デフォルトの色は &quot;<var>Pmenu</var>&quot; です。他の何かを好むならば、&quot;<var>highlight</var>&quot; 引數または &rsquo;<samp>wincolor</samp>&rsquo; オプションを使用してください。例:
</p><div class="example">
<pre class="example">hi MyPopupColor ctermbg=lightblue guibg=lightblue
call setwinvar(winid, '&amp;wincolor', 'MyPopupColor')
</pre></div>

<p>&rsquo;<samp>hlsearch</samp>&rsquo; ハイライトはポップアップウィンドウに表示されません。
</p>
<p>ポップアップウィンドウは他のウィンドウと同樣にウィンドウ ID を持ちますが、動作が異なります。サイズは Vim ウィンドウ全體に及ぶことがあり、それは他のウィンドウと重なります。ポップアップウィンドウも互ひに重なり合ふことがあります。&quot;zindex&quot; プロパティは、何の上に何があるかを指定します。
</p>
<p>ポップアップウィンドウにはバッファがあり、そのバッファは常にポップアップウィンドウに關聯付けられてゐます。このウィンドウはノーマル、ビジュアル、插入モードにはできません。キーボードフォーカスは得られません。&lsquo;<code>setbufline()</code>&lsquo; のやうな函數を使つてバッファ內のテキストを變更することができます。このウィンドウとバッファは通常のウィンドウとバッファの振る舞ひと比較して、たくさんの違ひがあります。|<a href="#popup_002dbuffer">popup-buffer</a>| を參照してください。
</p>
<p>これがあなたが探してゐるものではない場合は、他のポップアップ機能をチェックしてください。
</p><ul>
<li> ポップアップメニューは |<a href="gui_002etxt.html#popup_002dmenu">popup-menu</a>| を參照してください。
</li><li> バルーンは |<a href="debugger_002etxt.html#balloon_002deval">balloon-eval</a>| を參照してください。
</li></ul>


<a name="popup_002dposition"></a><a name="index-popup_002dposition"></a>
<a name="uindounoWei-Zhi-tosaizu"></a>
<h4 class="unnumberedsubsec">ウィンドウの位置とサイズ</h4>

<p>ウィンドウの高さは、通常、バッファ內の折り返しの行數と同じです。&quot;maxheight&quot; プロパティで制限することができます。高さを增やすために空の行を使ふか、または &quot;minheight&quot; プロパティを使ふことができます。
</p>
<p>ウィンドウの幅は、通常、バッファ內の最長の行と同じです。&quot;maxwidth&quot; プロパティで制限することができます。スペースを使つて幅を廣げるか、または &quot;minwidth&quot; プロパティを使ふことができます。
</p>
<p>デフォルトでは &rsquo;<samp>wrap</samp>&rsquo; オプションが設定されてゐるのでテキストは消えません。または、十分なスペースがない場合、ウィンドウは左に移動してテキストをさらに表示します。右寄せの場合、ウィンドウは右に移動してテキストをさらに表示します。この移動については &quot;fixed&quot; プロパティで無效にすることができます。
</p>
<p>Vim は指定した場所にポップアップを表示しようとします。場合によつては、ポップアップが Vim のウィンドウの外側に出ると、他の近い場所に表示されます。例へば、&lsquo;<code>popup_atcursor()</code>&lsquo; を使用すると、ポップアップは現在のカーソル位置のすぐ上に表示されますが、カーソルが Vim のウィンドウの最上部に近い場合は、カーソル位置の下に配置されます。
</p>
<p>Ex コマンドの出力のために畫面がスクロールアップすると、ポップアップも移動するので、ポップアップは出力を隱しません。
</p>
<p>現在のカーソル位置はポップアップウィンドウの下にあつても表示されます。この方法では、テキストが表示されてゐない場合でも、その場所を確認することができます。
</p>

<a name="popup_002dclose"></a><a name="index-popup_002dclose"></a>
<a name="potupuatupuuindouwoBi-ziru"></a>
<h4 class="unnumberedsubsec">ポップアップウィンドウを閉ぢる</h4>

<p>通常、ポップアップウィンドウを生成したプラグインは、これを閉ぢることもまた擔當します。もしもプラグインがどういふわけかハングアップしてしまつたなら、次のやうにしてポップアップウィンドウのすべてを閉ぢることができます:
</p><pre class="verbatim">call popup_clear()
</pre>
<p>通知のやうなポップアップは一定時閒後に閉ぢます。これは &lsquo;<code>popup_create()</code>&lsquo; の &quot;<var>time</var>&quot; プロパティで設定することができます。
</p>
<p>一方で、ポップアップは右上角の X をクリックしたり、ポップアップの內側のどこかをクリックすることによつて閉ぢることもできます。このためには &quot;<var>close</var>&quot; プロパティを有效にする必要があります。既定では通知に設定されてゐます。{譯注: &quot;close&quot; の値が &quot;none&quot; になつてゐる}
</p>

<a name="popup_002dbuffer"></a><a name="index-popup_002dbuffer"></a>
<a name="potupuatupubatuhuatouindou"></a>
<h4 class="unnumberedsubsec">ポップアップバッファとウィンドウ</h4>

<p>もしもポップアップ函數がテキストからポップアップを作成するために呼ばれた場合は、ポップアップウィンドウのテキストとテキストプロパティを保持するための新しいバッファが作成されます。バッファは常にポップアップウィンドウに關聯付けられてゐて、操作は制限されてゐます:
</p><ul>
<li> 無名バッファ
</li><li> &rsquo;<samp>buftype</samp>&rsquo; は &quot;<var>popup</var>&quot;
</li><li> &rsquo;<samp>swapfile</samp>&rsquo; は off
</li><li> &rsquo;<samp>bufhidden</samp>&rsquo; は &quot;<var>hide</var>&quot;
</li><li> &rsquo;<samp>buflisted</samp>&rsquo; は off
</li><li> &rsquo;<samp>undolevels</samp>&rsquo; は -1: アンドゥはできません
</li><li> 他のすべてのバッファローカルおよびウィンドウローカルオプションは Vim のデフォルト値に設定されてゐます
</li></ul>

<p>具體的に言及されたオプションを變更することは可能ですが、何かが壞れてしまふ可能性があるので、そのままにしておくはうが望ましいでせう。
</p>
<p>ウィンドウにはカーソル位置がありますが、カーソルは表示されません。
</p>
<p>ポップアップウィンドウとバッファのコンテキストでコマンドを實行するには &lsquo;<code>win_execute()</code>&lsquo; を使用してください。例:
</p><div class="example">
<pre class="example">call win_execute(winid, 'syntax enable')
</pre></div>

<p>オプションは &lsquo;<code>setwinvar()</code>&lsquo; を使つてウィンドウ上で設定することができます。例:
</p><div class="example">
<pre class="example">call setwinvar(winid, '&amp;wrap', 0)
</pre></div>
<p>そしてオプションは &lsquo;<code>setbufvar()</code>&lsquo; を使つてバッファに設定することができます。例:
</p><div class="example">
<pre class="example">call setbufvar(winbufnr(winid), '&amp;filetype', 'java')
</pre></div>
<blockquote>
<p><strong>Note:</strong> <br>
これは自動コマンドをトリガーしないことに注意してください。必要ならば &lsquo;<code>win_execute()</code>&lsquo; を使用してください。
</p></blockquote>



<a name="popup_002dfunctions"></a><a name="index-popup_002dfunctions"></a>
<a name="g_t2_002e-Guan-Shu-"></a>
<h3 class="section">2. 函數</h3>

<p>ポップアップウィンドウを作成:
</p><table>
<tr><td width="40%">|<a href="#popup_005fcreate_0028_0029">popup_create()</a>|</td><td width="60%">畫面の中央に</td></tr>
<tr><td width="40%">|<a href="#popup_005fatcursor_0028_0029">popup_atcursor()</a>|</td><td width="60%">カーソル位置のすぐ上に。カーソルが移動すると閉ぢる</td></tr>
<tr><td width="40%">|<a href="#popup_005fbeval_0028_0029">popup_beval()</a>|</td><td width="60%">v:beval_ 變數によつて指示されたその位置。マウスが移動すると閉ぢる</td></tr>
<tr><td width="40%">|<a href="#popup_005fnotification_0028_0029">popup_notification()</a>|</td><td width="60%">3 秒閒通知を表示する</td></tr>
<tr><td width="40%">|<a href="#popup_005fdialog_0028_0029">popup_dialog()</a>|</td><td width="60%">パディングとボーダーありで中央に</td></tr>
<tr><td width="40%">|<a href="#popup_005fmenu_0028_0029">popup_menu()</a>|</td><td width="60%">リストから項目を選擇するためのプロンプト</td></tr>
</table>

<p>ポップアップウィンドウの操作:
</p><table>
<tr><td width="40%">|<a href="#popup_005fhide_0028_0029">popup_hide()</a>|</td><td width="60%">ポップアップを一時的に隱す</td></tr>
<tr><td width="40%">|<a href="#popup_005fshow_0028_0029">popup_show()</a>|</td><td width="60%">以前に隱されたポップアップを表示する</td></tr>
<tr><td width="40%">|<a href="#popup_005fmove_0028_0029">popup_move()</a>|</td><td width="60%">ポップアップの位置とサイズを變更する</td></tr>
<tr><td width="40%">|<a href="#popup_005fsetoptions_0028_0029">popup_setoptions()</a>|</td><td width="60%">ポップアップのオプションを上書きする</td></tr>
<tr><td width="40%">|<a href="#popup_005fsettext_0028_0029">popup_settext()</a>|</td><td width="60%">ポップアップバッファの內容を置き換へる</td></tr>
</table>

<p>ポップアップウィンドウを閉ぢる:
</p><table>
<tr><td width="40%">|<a href="#popup_005fclose_0028_0029">popup_close()</a>|</td><td width="60%">1 つのポップアップを閉ぢる</td></tr>
<tr><td width="40%">|<a href="#popup_005fclear_0028_0029">popup_clear()</a>|</td><td width="60%">すべてのポップアップを閉ぢる</td></tr>
</table>

<p>フィルタ函數:
</p><table>
<tr><td width="40%">|<a href="#popup_005ffilter_005fmenu_0028_0029">popup_filter_menu()</a>|</td><td width="60%">アイテムのリストから選擇する</td></tr>
<tr><td width="40%">|<a href="#popup_005ffilter_005fyesno_0028_0029">popup_filter_yesno()</a>|</td><td width="60%">&rsquo;<code class="tt-key">y</code>&rsquo; または &rsquo;<code class="tt-key">n</code>&rsquo; が押されるまでブロックする</td></tr>
</table>

<p>その他:
</p><table>
<tr><td width="40%">|<a href="#popup_005fgetoptions_0028_0029">popup_getoptions()</a>|</td><td width="60%">ポップアップの現在のオプションを取得する</td></tr>
<tr><td width="40%">|<a href="#popup_005fgetpos_0028_0029">popup_getpos()</a>|</td><td width="60%">ポップアップの實際の位置とサイズを取得する</td></tr>
<tr><td width="40%">|<a href="#popup_005flocate_0028_0029">popup_locate()</a>|</td><td width="60%">スクリーン位置でポップアップウィンドウを檢索する</td></tr>
</table>


<a name="popup_002dfunction_002ddetails"></a><a name="index-popup_002dfunction_002ddetails"></a>
<a name="Xiang-Xi-"></a>
<h4 class="unnumberedsubsec">詳細</h4>

<dl compact="compact">
<dd><a name="popup_005fatcursor_0028_0029"></a><a name="index-popup_005fatcursor_0028_0029"></a>
</dd>
<dt>popup_atcursor({what}, {options})</dt>
<dd><p>カーソルの上に {what} を表示して、カーソルが移動したら閉ぢます。これは次のやうに動作します:
</p><pre class="verbatim">call popup_create({what}, {
        \ 'pos': 'botleft',
        \ 'line': 'cursor-1',
        \ 'col': 'cursor',
        \ 'moved': 'WORD',
        \ })
</pre><p>プロパティを變更するには {options} を使用します。
</p>

<a name="popup_005fbeval_0028_0029"></a><a name="index-popup_005fbeval_0028_0029"></a>
</dd>
<dt>popup_beval({what}, {options})</dt>
<dd><p>&rsquo;<samp>ballooneval</samp>&rsquo; からの位置 {what} を表示して、マウスが移動した時に閉ぢます。これは次のやうに動作します:
</p><pre class="verbatim">let pos = screenpos(v:beval_winnr, v:beval_lnum, v:beval_col)
call popup_create({what}, #{
      \ pos: 'botleft',
      \ line: pos.row - 1,
      \ col: pos.col,
      \ mousemoved: 'WORD',
      \ })
</pre><p>特性を變更するには {options} を使ひます。使ひ方については |<a href="#popup_005fbeval_005fexample">popup_beval_example</a>| を參照してください。
</p>

<a name="popup_005fclear_0028_0029"></a><a name="index-popup_005fclear_0028_0029"></a>
</dd>
<dt>popup_clear()</dt>
<dd><p>不作法にふるまふプラグインに對する緊急の解決策: グローバルポップアップとカレントタブポップアップをすべて閉ぢます。
</p>

<a name="popup_005fclose_0028_0029"></a><a name="index-popup_005fclose_0028_0029"></a>
</dd>
<dt>popup_close({id} [, {result}])</dt>
<dd><p>ポップアップ {id} を閉ぢます。ウィンドウと關聯するバッファは削除されます。
</p>
<p>ポップアップがコールバックを持つ場合は、ポップアップウィンドウが削除される直前に呼び出されます。オプションの {result} が存在する場合、それはコールバックの第 2 引數として渡されます。さうでなければ、ゼロがコールバックに渡されます。
</p>

<a name="popup_005fcreate_0028_0029"></a><a name="index-popup_005fcreate_0028_0029"></a>
</dd>
<dt>popup_create({what}, {options})</dt>
<dd><p>次のどれかである {what} を見せるポップアップウィンドウを開きます:
</p><ul>
<li> バッファ番號
</li><li> 文字列
</li><li> 文字列のリスト
</li><li> テキストプロパティを持つテキスト行のリスト
</li></ul>
<p>{what} がバッファ番號ではない場合、バッファは &rsquo;<samp>buftype</samp>&rsquo; オプションに &quot;<var>popup</var>&quot; を設定した狀態で作成されます。ひとたびポップアップが閉ぢられると、このバッファは消去されるでせう。
</p>
<p>{options} は多くのエントリがある辭書です。詳細は |<a href="#popup_005fcreate_002darguments">popup_create-arguments</a>| を參照してください。
</p>
<p>ウィンドウ ID を返します。これは他のポップアップ函數で使用することができます。ウィンドウ內のバッファの番號を取得するには &lsquo;<code>winbufnr()</code>&lsquo; を使用してください:
</p><pre class="verbatim">let winid = popup_create('hello', {})
let bufnr = winbufnr(winid)
call setbufline(bufnr, 2, 'second line')
</pre><p>失敗した場合はゼロが返されます。
</p>

<a name="popup_005fdialog_0028_0029"></a><a name="index-popup_005fdialog_0028_0029"></a>
</dd>
<dt>popup_dialog({what}, {options})</dt>
<dd><p>|<a href="#popup_005fcreate_0028_0029">popup_create()</a>| と同じですが、これらのデフォルトのオプションになります:
</p><pre class="verbatim">call popup_create({what}, #{
        \ pos: 'center',
        \ zindex: 200,
        \ drag: 1,
        \ border: [],
        \ padding: [],
        \})
</pre><p>プロパティを變更するには {options} を使用します。例: 値 &rsquo;<var>popup_filter_yesno</var>&rsquo; を持つ &rsquo;<samp>filter</samp>&rsquo; オプションを追加します。例:
</p><pre class="verbatim">call popup_create('do you want to quit (Yes/no)?', #{
        \ filter: 'popup_filter_yesno',
        \ callback: 'QuitCallback',
        \ })
</pre>
<p>デフォルトではダイアログはドラッグすることができるので、必要であればその下のテキストを讀むことができます。
</p>

</dd>
<dt>popup_filter_menu({id}, {key})</dt>
<dd><a name="popup_005ffilter_005fmenu_0028_0029"></a><a name="index-popup_005ffilter_005fmenu_0028_0029"></a>
<p>ポップアップに使用できるフィルタ。これらのキーを使用することができます:
</p><table>
<tr><td width="30%"><code class="tt-key">j</code> <code class="tt-key">&lt;Down&gt;</code></td><td width="70%">下の項目を選擇する</td></tr>
<tr><td width="30%"><code class="tt-key">k</code> <code class="tt-key">&lt;Up&gt;</code></td><td width="70%">上の項目を選擇する</td></tr>
<tr><td width="30%"><code class="tt-key">&lt;Space&gt;</code> <code class="tt-key">&lt;Enter&gt;</code></td><td width="70%">現在の選擇を受け入れる</td></tr>
<tr><td width="30%"><code class="tt-key">x</code> <code class="tt-key">Esc</code> <kbd>CTRL-C</kbd></td><td width="70%">メニューをキャンセルする</td></tr>
</table>
<p>他のキーは無視されます。
</p>
<p>行をハイライトするためにマッチがセットされます。|<a href="#popup_005fmenu_0028_0029">popup_menu()</a>| を參照してください。
</p>
<p>現在の選擇が受け入れられると、選擇された行のインデックスを第 2 引數としてポップアップメニューの &quot;callback&quot; が呼び出されます。最初のエントリのインデックスは 1 です。メニューをキャンセルすると、-1 でコールバックが呼び出されます。
</p>
<p>ショートカットキーを追加する場合: |<a href="#popup_005fmenu_002dshortcut_002dexample">popup_menu-shortcut-example</a>| を參照してください。
</p>

<a name="popup_005ffilter_005fyesno_0028_0029"></a><a name="index-popup_005ffilter_005fyesno_0028_0029"></a>
</dd>
<dt>popup_filter_yesno({id}, {key})</dt>
<dd><p>ポップアップに使用できるフィルタ。キー &rsquo;<code class="tt-key">y</code>&rsquo;、&rsquo;<code class="tt-key">Y</code>&rsquo; および &rsquo;<code class="tt-key">n</code>&rsquo; または &rsquo;<code class="tt-key">N</code>&rsquo; のみを處理します。第 2 引數として &rsquo;<code class="tt-key">y</code>&rsquo; または &rsquo;<code class="tt-key">Y</code>&rsquo; に 1、&rsquo;<code class="tt-key">n</code>&rsquo; または &rsquo;<code class="tt-key">N</code>&rsquo; に 0 を指定して、ポップアップメニューの &quot;callback&quot; を呼び出します。<code class="tt-key">Esc</code> と &rsquo;<code class="tt-key">x</code>&rsquo; を押すと、&rsquo;<code class="tt-key">n</code>&rsquo; を押すのと同じやうに機能します。<kbd>CTRL-C</kbd> は -1 でコールバックを呼び出します。他のキーは無視されます。
</p>
<p>|<a href="#popup_005fdialog_002dexample">popup_dialog-example</a>| を參照してください。
</p>

<a name="popup_005fgetoptions_0028_0029"></a><a name="index-popup_005fgetoptions_0028_0029"></a>
</dd>
<dt>popup_getoptions({id})</dt>
<dd><p>popup {id} の {options} を辭書で返します。ゼロ値はオプションが設定されなかつたことを意味します。&quot;zindex&quot; の場合、デフォルト値が返されます。ゼロではありません。
</p>
<p>&quot;moved&quot; エントリは、行番號、最小桁と最大桁のリストで、未設定時は [0, 0, 0] です。
</p>
<p>&quot;mousemoved&quot; エントリはスクリーン行、最小桁と最大桁のリストで、未設定時は [0, 0, 0] です。
</p>
<p>すべての値がゼロの場合、&quot;border&quot; と &quot;padding&quot; は含まれません。すべての値が 1 の場合、空のリストが含まれます。
</p>
<p>すべての値が空の場合、&quot;borderhighlight&quot; は含まれません。設定されてゐるときのみ &quot;scrollbarhighlight&quot; と &quot;thumbhighlight&quot; が含まれます。
</p>
<p>グローバルポップアップの場合 &quot;tabpage&quot; には -1 が設定され、カレントタブページの場合は 0 、別のタブページの場合は正の整數が設定されます。
</p>
<p>ポップアップウィンドウ {id} が見つからない場合は空の辭書が返されます。
</p>

<a name="popup_005fgetpos_0028_0029"></a><a name="index-popup_005fgetpos_0028_0029"></a>
</dd>
<dt>popup_getpos({id})</dt>
<dd><p>ポップアップ {id} の位置とサイズを返します。これらのエントリを持つ辭書を返します:
</p><table>
<tr><td width="30%">col</td><td width="70%">ポップアップの畫面の桁、1 から始まる</td></tr>
<tr><td width="30%">line</td><td width="70%">ポップアップの畫面の行、1 から始まる</td></tr>
<tr><td width="30%">width</td><td width="70%">畫面セル內のポップアップ全體の幅</td></tr>
<tr><td width="30%">height</td><td width="70%">畫面セル內のポップアップ全體の高さ</td></tr>
<tr><td width="30%">core_col</td><td width="70%">テキストボックスの畫面の桁</td></tr>
<tr><td width="30%">core_line</td><td width="70%">テキストボックスの畫面の行</td></tr>
<tr><td width="30%">core_width</td><td width="70%">畫面セル內のテキストボックスの幅</td></tr>
<tr><td width="30%">core_height</td><td width="70%">畫面セル內のテキストボックスの高さ</td></tr>
<tr><td width="30%">firstline</td><td width="70%">トップにおけるバッファの行 (スクロールされてゐなければ 1)</td></tr>
<tr><td width="30%">scrollbar</td><td width="70%">スクロールバーが表示されてゐるなら非ゼロ</td></tr>
<tr><td width="30%">visible</td><td width="70%">ポップアップが表示されてゐる場合は 1、非表示の場合は 0</td></tr>
</table>
<blockquote>
<p><strong>Note:</strong> <br>
これらは實際の畫面位置です。適用されるサイズと位置のメカニズムに關して &lsquo;<code>popup_getoptions()</code>&lsquo; の値とは異なります。
</p></blockquote>

<p>&quot;core_&quot; 値はパディングとボーダーを除外してゐます。
</p>
<p>ポップアップウィンドウ {id} が見つからない場合は空の辭書が返されます。
</p>

<a name="popup_005fhide_0028_0029"></a><a name="index-popup_005fhide_0028_0029"></a>
</dd>
<dt>popup_hide({id})</dt>
<dd><p>{id} がポップアップ表示されてゐる場合、それを非表示にします。ポップアップがフィルタを持つてゐる場合は、ポップアップが非表示になつてゐる限り呼び出されません。
<a name="E993"></a><a name="index-E993"></a>
ウィンドウ {id} が存在しない場合は何も起こりません。ウィンドウ {id} が存在するがポップアップウィンドウではない場合、エラーが發生します。
</p>

<a name="popup_005flocate_0028_0029"></a><a name="index-popup_005flocate_0028_0029"></a>
</dd>
<dt>popup_locate({row}, {col})</dt>
<dd><p>スクリーン位置 {row} と {col} におけるポップアップの |<a href="windows_002etxt.html#window_002dID">window-ID</a>| を返します。もしも複數のポップアップがあるなら、一番大きい zindex をもつものが返されます。もしもこの位置にポップアップがないのなら、ゼロが返されます。
</p>

<a name="popup_005fmenu_0028_0029"></a><a name="index-popup_005fmenu_0028_0029"></a>
</dd>
<dt>popup_menu({what}, {options})</dt>
<dd><p>カーソルの近くに {what} を表示し、カーソルキーで項目の 1 つを選擇して處理し、それを閉ぢるには、<code class="tt-key">Space</code> または <code class="tt-key">Enter</code> で項目を選擇します。これを有效にするには、{what} に複數の行が必要です。これは次のやうに機能します:
</p><pre class="verbatim">call popup_create({what}, #{
        \ pos: 'center',
        \ zindex: 200,
        \ drag: 1,
        \ wrap: 0,
        \ border: [],
        \ cursorline: 1,
        \ padding: [0,1,0,1],
        \ filter: 'popup_filter_menu',
        \ })
</pre><p>現在行は、&quot;PopupSelected&quot; を使用してマッチでハイライトされます。&quot;PopupSelected&quot; が未定義の場合は、&quot;PmenuSel&quot; が使はれます。
</p>
<p>プロパティを變更するには {options} を使用します。少なくとも &quot;callback&quot; を選擇された項目を扱ふ函數に設定するべきです。
</p>

<a name="popup_005fmove_0028_0029"></a><a name="index-popup_005fmove_0028_0029"></a>
</dd>
<dt>popup_move({id}, {options})</dt>
<dd><p>ポップアップ {id} を {options} で指定された位置に移動します。{options} にはポップアップ位置を指定する |<a href="#popup_005fcreate_0028_0029">popup_create()</a>| 由來の項目を含むことができます:
</p><table>
<tr><td width="90%">line</td><td width="10%"></td></tr>
<tr><td width="90%">col</td><td width="10%"></td></tr>
<tr><td width="90%">pos</td><td width="10%"></td></tr>
<tr><td width="90%">maxheight</td><td width="10%"></td></tr>
<tr><td width="90%">minheight</td><td width="10%"></td></tr>
<tr><td width="90%">maxwidth</td><td width="10%"></td></tr>
<tr><td width="90%">minwidth</td><td width="10%"></td></tr>
<tr><td width="90%">fixed</td><td width="10%"></td></tr>
</table>
<p>{id} については &lsquo;<code>popup_hide()</code>&lsquo; を參照してください。その他のオプションについては |<a href="#popup_005fsetoptions_0028_0029">popup_setoptions()</a>| を參照してください。
</p>

<a name="popup_005fnotification_0028_0029"></a><a name="index-popup_005fnotification_0028_0029"></a>
</dd>
<dt>popup_notification({what}, {options})</dt>
<dd><p>Vim のウィンドウの上部に {what} を 3 秒閒表示します。これは次のやうに動作します:
</p><pre class="verbatim">call popup_create({what}, #{
        \ line: 1,
        \ col: 10,
        \ minwidth: 20,
        \ time: 3000,
        \ tabpage: -1,
        \ zindex: 300,
        \ drag: 1,
        \ highlight: 'WarningMsg',
        \ border: [],
        \ close: 'click',
        \ padding: [0,1,0,1],
        \ })
</pre><p>PopupNotification ハイライトグループが定義されてゐる場合は、WarningMsg の代はりに使用されます。
</p>
<p>|<a href="various_002etxt.html#g_t_002btimers">+timers</a>| 機能がないと、ポップアップは自動的に消えないでせう。ユーザーはこれをクリックしなければなりません。
</p>
<p>他の通知と重ならないやうに位置が調整されます。プロパティを變更するには {options} を使用します。
</p>

<a name="popup_005fshow_0028_0029"></a><a name="index-popup_005fshow_0028_0029"></a>
</dd>
<dt>popup_show({id})</dt>
<dd><p>{id} が非表示のポップアップの場合はそれを表示します。{id} については &lsquo;<code>popup_hide()</code>&lsquo; を參照してください。
</p>

<a name="popup_005fsetoptions_0028_0029"></a><a name="index-popup_005fsetoptions_0028_0029"></a>
</dd>
<dt>popup_setoptions({id}, {options})</dt>
<dd><p>ポップアップ {id} のオプションを {options} のエントリで上書きします。これらのオプションを設定することができます:
</p><table>
<tr><td width="90%">border</td><td width="10%"></td></tr>
<tr><td width="90%">borderchars</td><td width="10%"></td></tr>
<tr><td width="90%">borderhighlight</td><td width="10%"></td></tr>
<tr><td width="90%">callback</td><td width="10%"></td></tr>
<tr><td width="90%">close</td><td width="10%"></td></tr>
<tr><td width="90%">drag</td><td width="10%"></td></tr>
<tr><td width="90%">cursorline</td><td width="10%"></td></tr>
<tr><td width="90%">filter</td><td width="10%"></td></tr>
<tr><td width="90%">firstline</td><td width="10%"></td></tr>
<tr><td width="90%">flip</td><td width="10%"></td></tr>
<tr><td width="90%">highlight</td><td width="10%"></td></tr>
<tr><td width="90%">mask</td><td width="10%"></td></tr>
<tr><td width="90%">moved</td><td width="10%"></td></tr>
<tr><td width="90%">padding</td><td width="10%"></td></tr>
<tr><td width="90%">scrollbar</td><td width="10%"></td></tr>
<tr><td width="90%">scrollbarhighlight</td><td width="10%"></td></tr>
<tr><td width="90%">thumbhighlight</td><td width="10%"></td></tr>
<tr><td width="90%">time</td><td width="10%"></td></tr>
<tr><td width="90%">title</td><td width="10%"></td></tr>
<tr><td width="90%">wrap</td><td width="10%"></td></tr>
<tr><td width="90%">zindex</td><td width="10%"></td></tr>
</table>
<p>|<a href="#popup_005fmove_0028_0029">popup_move()</a>| からのオプションも使用することができます。&quot;hidden&quot; のために |<a href="#popup_005fhide_0028_0029">popup_hide()</a>| と |<a href="#popup_005fshow_0028_0029">popup_show()</a>| を使用します。&quot;tabpage&quot; は變更することはできません。
</p>
<a name="popup_005fsettext_0028_0029"></a><a name="index-popup_005fsettext_0028_0029"></a>
</dd>
<dt>popup_settext({id}, {text})</dt>
<dd><p>ポップアップウィンドウ {id} でバッファのテキストを設定します。{text} は |<a href="#popup_005fcreate_0028_0029">popup_create()</a>| に提供されるものと同じです。ただしバッファ番號は認められてゐません。
</p>
<p>テキストの違ひが生じる以外ではウィンドウのサイズや位置を變更しません。
</p></dd>
</dl>


<a name="popup_002dusage"></a><a name="index-popup_002dusage"></a>
<a name="g_t3_002e-Shi-Yong-Fang-Fa-"></a>
<h3 class="section">3. 使用方法</h3>

<a name="popup_005fcreate_002darguments"></a><a name="index-popup_005fcreate_002darguments"></a>
<a name="POPUP_005fCREATE_0028_0029-noYin-Shu-"></a>
<h4 class="unnumberedsubsec">POPUP_CREATE() の引數</h4>

<p>|<a href="#popup_005fcreate_0028_0029">popup_create()</a>| の最初の引數 (と |<a href="#popup_005fsettext_0028_0029">popup_settext()</a>| の第 2 引數) は表示されるテキストと、オプションでテキストプロパティを指定します。それは 4 つの形式のうちの 1 つです:
</p><ul>
<li> バッファ番號
</li><li> 文字列
</li><li> 文字列のリスト
</li><li> 辭書のリスト。各辭書は次のエントリを持ちます:
<table>
<tr><td width="30%">text</td><td width="70%">表示するテキストを含む文字列。</td></tr>
<tr><td width="30%">props</td><td width="70%">テキストプロパティのリスト。任意。各エントリは |prop_add()| の第 3 引數のやうな辭書ですが、辭書の &quot;<var>col</var>&quot; エントリを使つて桁を指定します。以下を參照してください: |<a href="#popup_002dprops">popup-props</a>|。</td></tr>
</table>
</li></ul>

<p>|<a href="#popup_005fcreate_0028_0029">popup_create()</a>| の第 2 引數は任意の辭書です:
</p><table>
<tr><td width="20%">line</td><td width="80%">ポップアップを配置する畫面の行。數値または、カーソルの行を使用して行數を加算または減算するには、&quot;cursor&quot;、&quot;cursor+1&quot;、または &quot;cursor-1&quot; を使用することができます。省略した場合、ポップアップは垂直方向の中央に配置されます。最初の行は 1 です。</td></tr>
<tr><td width="20%">col</td><td width="80%">ポップアップを配置する畫面の桁。數値または、カーソルの桁を使用するには &quot;cursor&quot; を使用し、桁を加算または減算するには &quot;cursor+9&quot; または &quot;cursor-9&quot; を使用することができます。省略した場合、ポップアップは水平方向の中央に配置されます。最初の桁は 1 です。</td></tr>
<tr><td width="20%">pos</td><td width="80%">&quot;topleft&quot;、&quot;topright&quot;、&quot;botleft&quot; または &quot;botright&quot;: ポップアップのどのコーナーに &quot;line&quot; と &quot;col&quot; が使はれるかを定義します。設定されてゐない場合は &quot;topleft&quot; が使用されます。あるいは &quot;center&quot; を使つてポップアップを Vim のウィンドウの中央に配置することもできます。その場合は &quot;line&quot; と &quot;col&quot; は無視されます。</td></tr>
<tr><td width="20%">fixed</td><td width="80%">FALSE (デフォルト) の場合は:
<ul>
<li> &quot;pos&quot; は &quot;botleft&quot; または &quot;topleft&quot; で、
</li><li> &quot;wrap&quot; はオフで、
</li><li> ポップアップは畫面の右端で切り捨てられ、
</li></ul>
<p>ポップアップは畫面の內容に合ふやうに左に移動されます。これを無效にするには、TRUEに設定します。
</p></td></tr>
<tr><td width="20%">flip</td><td width="80%">TRUE (デフォルト) かつ位置がカーソルからの相對位置である場合は、|<a href="insert_002etxt.html#popupmenu_002dcompletion">popupmenu-completion</a>| または、より高い &quot;zindex&quot; を持つ別のポップアップと重ならないやうにカーソルの下または上に動かします。カーソルの上/下にスペースがない場合は、ポップアップまたはポップアップメニューの橫にポップアップを表示します。

<p>{未實裝}
</p></td></tr>
<tr><td width="20%">maxheight</td><td width="80%">コンテンツの最大高さ (ボーダーとパディングを除く)</td></tr>
<tr><td width="20%">minheight</td><td width="80%">コンテンツの最小高さ (ボーダーとパディングを除く)</td></tr>
<tr><td width="20%">maxwidth</td><td width="80%">コンテンツの最大幅 (ボーダーとパディングを除く)</td></tr>
<tr><td width="20%">minwidth</td><td width="80%">コンテンツの最小幅 (ボーダーとパディングを除く)</td></tr>
<tr><td width="20%">firstline</td><td width="80%">表示する最初のバッファ行。1 より大きい場合は、テキストが上にスクロールしたやうに見えます。範圍外の場合、最後のバッファ行はウィンドウの最上部に表示されます。&quot;scrollbar&quot; も參照してください。</td></tr>
<tr><td width="20%">hidden</td><td width="80%">TRUE の場合、ポップアップは存在するけれども表示はされません。表示するには &lsquo;<code>popup_show()</code>&lsquo; を使ひます。</td></tr>
<tr><td width="20%">tabpage</td><td width="80%">-1 の場合: すべてのタブページにポップアップを表示します。

<p>0 (デフォルト) の場合: カレントタブページにポップアップを表示します。
</p>
<a name="E997"></a><a name="index-E997"></a>
<p>それ以外の場合は、ポップアップが表示されるタブページの番號。無效な場合はポップアプは表示されずエラーになます。
</p>
<p>{-1 と 0 のみ實裝}
</p></td></tr>
<tr><td width="20%">title</td><td width="80%">ポップアップの最初の項目の上、ボーダーの上に表示されるテキスト。上枠がない場合は、タイトルを付けるために 1 行のパディングが追加されます。最初と最後に 1 つ以上のスペースをパディングとして追加することを薦めます。</td></tr>
<tr><td width="20%">wrap</td><td width="80%">行を折り返す場合は TRUE (デフォルトは TRUE)。</td></tr>
<tr><td width="20%">drag</td><td width="80%">ボーダーを摑んでマウスでポップアップをドラッグできるやうにする場合は TRUE。ポップアップにボーダーがない場合は效果がありません。&quot;pos&quot; が &quot;center&quot; の場合は、ドラッグが始まるとすぐに &quot;topleft&quot; に變更されます。</td></tr>
<tr><td width="20%">close</td><td width="80%">&quot;<var>button</var>&quot; の時は、どのやうなボーダ、パディング、テキスト上であつても X が右上に表示されます。X をクリックするとポップアップは閉ぢられます。どのやうなコールバックも -2 の値で呼び出されます。

<p>&quot;<var>click</var>&quot; の時は、ポップアップ內ならどのやうなマウスクリックでも閉ぢられます。
</p>
<p>&quot;<var>none</var>&quot; (これが既定) の時は、マウスクリックでポップアップウィンドウは閉ぢられません。
</p></td></tr>
<tr><td width="20%">highlight</td><td width="80%">&rsquo;<samp>wincolor</samp>&rsquo; オプションに格納されてゐる、テキストに使用するハイライトグループ名。</td></tr>
<tr><td width="20%">padding</td><td width="80%">ポップアップの上/右/下/左のパディングを定義する數値のリスト (CSS と同樣)。空のリストは、すべて 1 のパディングを使用します。パディングは、テキストをボーダーの內側で圍みまし。パディングは &rsquo;wincolor&rsquo; ハイライトを使ひます。

<p>例: [1, 2, 1, 3] は上に 1 行、右に 2 桁、下に 1 行、左に 3 桁のパディングにします。
</p></td></tr>
<tr><td width="20%">border</td><td width="80%">ポップアップの上/右/下/左のボーダーの太さを定義する數値のリスト (CSS と同樣)。ゼロとゼロ以外の値のみが認識されます。空のリストは、周圍にボーダーを使用します。</td></tr>
<tr><td width="20%">borderhighlight</td><td width="80%">ボーダーに使用するハイライトグループ名のリスト。1 つのエントリの場合はそれがすべてのボーダーに使用され、それ以外の場合は上/右/下/左のボーダーのハイライトになります。

<p>例: [&rsquo;TopColor&rsquo;, &rsquo;RightColor&rsquo;, &rsquo;BottomColor, &rsquo;LeftColor&rsquo;]
</p></td></tr>
<tr><td width="20%">borderchars</td><td width="80%">上/右/下/左のボーダーに使用する文字を定義します、文字のリスト。左上/右上/右下/左下の隅に使用する文字が任意で續きます。

<p>例: [&rsquo;-&rsquo;, &rsquo;|&rsquo;, &rsquo;-&rsquo;, &rsquo;|&rsquo;, &rsquo;┌&rsquo;, &rsquo;┐&rsquo;, &rsquo;┘&rsquo;, &rsquo;└&rsquo;]
</p>
<p>リストに 1 文字が含まれてゐる場合は、それがすべてに使用されます。リストに 2 文字が含まれてゐる場合、最初の文字はボーダーに使用され、2 番目の文字はコーナーに使用されます。
</p>
<p>&rsquo;<samp>encoding</samp>&rsquo; が &quot;<var>utf-8</var>&quot; かつ &rsquo;<samp>ambiwidth</samp>&rsquo; が &quot;<var>single</var>&quot; のときはデフォルトで 2 重線が使はれます。それ以外の場合は ASCII 文字が使はれます。
</p></td></tr>
<tr><td width="20%">scrollbar</td><td width="80%">非ゼロ: テキストがポップアップの大きさに適應してゐなければ、スクロールバーを表示します。 <br>
ゼロ: スクロールバーを表示しません

<p>既定は非ゼロです。|<a href="#popup_002dscrollbar">popup-scrollbar</a>| も參照してください。
</p></td></tr>
<tr><td width="20%">scrollbarhighlight</td><td width="80%">スクロールバーのためのハイライトグループ名。背景色は重要です。與へられてゐないときは PmenuSbar が使はれます。</td></tr>
<tr><td width="20%">thumbhighlight</td><td width="80%">スクロールバーのつまみのためのハイライトグループ名。背景色は重要です。與へられてゐないときは PmenuThumb が使はれます。</td></tr>
<tr><td width="20%">zindex</td><td width="80%">ポップアップの優先度。デフォルトは 50。最小値は 1、最大値は 32000。</td></tr>
<tr><td width="20%">mask</td><td width="80%">透明なポップアップの一部を定義してゐる座標リストのリスト。|<a href="#popup_002dmask">popup-mask</a>| を參照してください。</td></tr>
<tr><td width="20%">time</td><td width="80%">ポップアップが閉ぢるまでの時閒 (msec)。省略した場合は |<a href="#popup_005fclose_0028_0029">popup_close()</a>| を使用する必要があります。</td></tr>
<tr><td width="20%">moved</td><td width="80%">カーソルが移動した場合にポップアップを閉ぢるやうに指定します:
<ul>
<li> &quot;any&quot;: 少しでもカーソルが移動した場合
</li><li> &quot;word&quot;: カーソルが |&lt;cword&gt;| の外側に移動した場合
</li><li> &quot;WORD&quot;: カーソルが |&lt;cWORD&gt;| の外側に移動した場合
</li><li> &quot;expr&quot;: カーソルが |&lt;cexpr&gt;| の外側に移動した場合
</li><li> [{start}, {end}]: カーソルが桁 {start} の前、または {end} の後に移動した場合
</li></ul>
<p>カーソルが別の行または別のウィンドウに移動した場合もポップアップは閉ぢます。
</p></td></tr>
<tr><td width="20%">cursorline</td><td width="80%">ゼロ以外: カーソル行をハイライトします。またこの行を表示するためにテキストをスクロールします (たぶん &rsquo;<samp>wrap</samp>&rsquo; がオフの時のみに動作します)。<br>
ゼロ: カーソル行をハイライトしません。<br>
既定はゼロで、他のものについては |popup_menu()| を參照してください。</td></tr>
<tr><td width="20%">filter</td><td width="80%">入力した文字をフィルタ處理できるコールバック。|<a href="#popup_002dfilter">popup-filter</a>| を參照してください。</td></tr>
<tr><td width="20%">callback</td><td width="80%">ポップアップが閉ぢたときに呼び出されるコールバック。例へば、|<a href="#popup_005ffilter_005fmenu_0028_0029">popup_filter_menu()</a>| を使用する場合、|<a href="#popup_002dcallback">popup-callback</a>| を參照してください。</td></tr>
</table>

<p>&quot;zindex&quot; に應じて、ポップアップは他のポップアップの下または上に移動します。補完メニュー (|<a href="gui_002etxt.html#popup_002dmenu">popup-menu</a>|) は zindex 100 です。短時閒表示されるメッセージについては、zindex 1000 を使用することを薦めます。
</p>
<p>デフォルトではテキストは折り返され、それによつて {lines} の行が複數の畫面行を占めるやうになります。&quot;wrap&quot; が FALSE の場合、ポップアップの外側または Vim のウィンドウの外側のテキストは、表示されずに切り捨てられます。
</p>

<a name="popup_002dprops"></a><a name="index-popup_002dprops"></a>
<a name="potupuatuputekisutopuropatei"></a>
<h4 class="unnumberedsubsec">ポップアップテキストプロパティ</h4>

<p>これらは |prop_add()| の第 3 引數と同じです。ただし:
</p><ul>
<li> &quot;lnum&quot; は常にリストの現在の行
</li><li> &quot;bufnr&quot; は常にポップアップのバッファ
</li><li> &quot;col&quot; は別の引數ではなく辭書內
</li></ul>
<p>さういふわけで、以下が得られます:
</p><table>
<tr><td width="30%">col</td><td width="70%">開始桁 (バイト單位)。最初の桁には 1 を使用します</td></tr>
<tr><td width="30%">length</td><td width="70%">テキストの長さ (バイト)。ゼロ指定が可能</td></tr>
<tr><td width="30%">end_lnum</td><td width="70%">テキストの終はりの行番號</td></tr>
<tr><td width="30%">end_col</td><td width="70%">テキストの直後の桁。&quot;length&quot; が與へられた場合は使用されません。{col} と &quot;end_col&quot; が等しい場合、これは幅ゼロのテキストプロパティです</td></tr>
<tr><td width="30%">id</td><td width="70%">プロパティのユーザー定義 ID。省略時はゼロが使用されます</td></tr>
<tr><td width="30%">type</td><td width="70%">|<a href="eval_002etxt.html#prop_005ftype_005fadd_0028_0029">prop_type_add()</a>| で追加されたテキストプロパティタイプの名前</td></tr>
</table>


<a name="popup_002dfilter"></a><a name="index-popup_002dfilter"></a>
<a name="potupuatupuhuiruta"></a>
<h4 class="unnumberedsubsec">ポップアップフィルタ</h4>

<p>ポップアップが表示されてゐる閒にタイプされたキーを取得するコールバック。ポップアップが非表示になつてゐると、フィルタは呼び出されません。
</p>
<p>フィルタは、キーが處理されて破毀されることを示すために TRUE を返すか、または現在の狀態で Vim に通常通りキーを處理させるために FALSE を返します。FALSE が返され、別のポップアップウィンドウが表示されてゐる場合は、そのフィルタも呼び出されます。最も高い zindex を持つポップアップウィンドウのフィルタが最初に呼び出されます。
</p>
<p>フィルタ函數は 2 つの引數、ポップアップ ID と文字列としてのキーで呼び出されます。例:
</p><pre class="verbatim">func MyFilter(winid, key)
  if a:key == &quot;\&lt;F2&gt;&quot;
    &quot; do something
    return 1
  endif
  if a:key == 'x'
    call popup_close(a:winid)
    return 1
  endif
  return 0
endfunc
</pre>
<p>現在のキーは、マッピング後に得られるものです。これは變はるかもしれません...
</p>
<p>いくつかの共通のキー動作:
</p><table>
<tr><td width="20%">x</td><td width="80%">ポップアップを閉ぢる (下記の note を參照)</td></tr>
<tr><td width="20%">cursor keys</td><td width="80%">別のエントリを選擇</td></tr>
<tr><td width="20%">Tab</td><td width="80%">現在の提案を受け入れる</td></tr>
</table>

<p>マウスクリックは &lt;LeftMouse&gt; として屆きます。座標は v:mouse_popup_col および v:mouse_popup_row です。ポップアップの左上の畫面セルは、桁 1、行 1 です (ボーダーはカウントしません)。
</p>
<p>Vim は標準のフィルタ |<a href="#popup_005ffilter_005fmenu_0028_0029">popup_filter_menu()</a>| と |<a href="#popup_005ffilter_005fyesno_0028_0029">popup_filter_yesno()</a>| を提供します。
</p>
<blockquote>
<p><strong>Note:</strong> <br>
&quot;x&quot; はポップアップを閉ぢる通常の方法です。Esc を使ひたくなるかもしれませんが、多くのキーは Esc 文字で始まるので、Vim が <code class="tt-key">Esc</code> キーを認識するまでに時閒がかかることがあります。Esc を使用する場合は、&rsquo;<samp>ttimeoutlen</samp>&rsquo; オプションを 100 に設定し、&rsquo;<samp>timeout</samp>&rsquo; または &rsquo;<samp>ttimeout</samp>&rsquo;、あるいはその兩方を設定することを薦めます。
</p></blockquote>


<a name="popup_002dcallback"></a><a name="index-popup_002dcallback"></a>
<a name="potupuatupukorubatuku"></a>
<h4 class="unnumberedsubsec">ポップアップコールバック</h4>

<p>ポップアップが閉ぢたときに呼び出されるコールバック。
</p>
<p>コールバックは 2 つの引數で呼び出されます: ポップアップウィンドウ ID と結果、それはポップアップ行のインデックスか、あるいは &lsquo;<code>popup_close()</code>&lsquo; の第 2 引數として渡されたものです。
</p>
<p>ポップアップが强制終了された場合、例へば、カーソルが移動したか <kbd>CTRL-C</kbd> が押された場合、-1 がコールバックに渡されます。
</p>

<a name="popup_002dscrollbar"></a><a name="index-popup_002dscrollbar"></a>
<a name="potupuatupusukuroruba"></a>
<h4 class="unnumberedsubsec">ポップアップスクロールバー</h4>

<p>テキストがポップアップの大きさに適應してゐないなら、ウィンドウの右側にスクロールバーが表示されます。これは &quot;scrollbar&quot; オプションをゼロに設定することで表示することができます。スクロールバーが表示されてゐるときに、マウスポインタがポップアップの上にある閒は、マウススクロールのイベントはあなたが期待する通りに、テキストを上下にスクロールさせる動作になります。スクロールバーの上半分をクリックすると、テキストを 1 行下にスクロールします。スクロールバーの下半分をクリックすると、テキストを 1 行上にスクロールします。しかしながら、これは制限されてゐますので、ポップアップは小さくはなりません。
</p>

<a name="popup_002dmask"></a><a name="index-popup_002dmask"></a>
<a name="potupuatupumasuku"></a>
<h4 class="unnumberedsubsec">ポップアップマスク</h4>

<p>ポップアップに被せるテキストを最小化するために、この一部分は透明化することができます。これは リストのリストである &quot;mask&quot; によつて定義されてゐます。それぞれのリストは 4 つの項目を持ちます:
</p><table>
<tr><td width="30%">col</td><td width="70%">桁の開始。左から數へる正の値で 1 が一番左。右から數へる負の値で -1 が一番右。</td></tr>
<tr><td width="30%">endcol</td><td width="70%">桁の終はり。&quot;col&quot; と同樣。</td></tr>
<tr><td width="30%">line</td><td width="70%">行の開始。上から數へる正の値で 1 が一番上。下から數へる負の値で -1 が一番下。</td></tr>
<tr><td width="30%">endline</td><td width="70%">行の終はり。&quot;line&quot; と同樣。</td></tr>
</table>

<p>例へば、最終行のうしろ 10 桁を透明化するには:
</p><div class="example">
<pre class="example">[[-10, -1, -1, -1]]
</pre></div>

<p>4 つの角を透明化するには:
</p><div class="example">
<pre class="example">[[1, 1, 1, 1], [-1, -1, 1, 1], [1, 1, -1, -1], [-1, -1, -1, -1]]
</pre></div>

<a name="popup_002dexamples"></a><a name="index-popup_002dexamples"></a>
<a name="g_t3_002e-Li"></a>
<h3 class="section">3. 例</h3>

<p>やること: 興味深い例をもつと
</p>
<a name="popup_005fdialog_002dexample"></a><a name="index-popup_005fdialog_002dexample"></a>
<a name="yuzani-y_002fY-ka-n_002fN-woYa-suyouniCu-su_003a"></a>
<h4 class="unnumberedsubsec">ユーザーに y/Y か n/N を押すやうに促す:</h4>

<pre class="verbatim">func MyDialogHandler(id, result)
   if a:result
      &quot; ... 'y' or 'Y' was pressed
   endif
endfunc

call popup_dialog('Continue? y/n', #{
        \ filter: 'popup_filter_yesno',
        \ callback: 'MyDialogHandler',
        \ })
</pre><a name="popup_005fmenu_002dshortcut_002dexample"></a><a name="index-popup_005fmenu_002dshortcut_002dexample"></a>
<a name="popup_005ffilter_005fmenu_0028_0029-wosiyotokatutodeKuo-Zhang-dekiruyounisuru_003a"></a>
<h4 class="unnumberedsubsec">popup_filter_menu() をショートカットで擴張できるやうにする:</h4>

<pre class="verbatim">call popup_menu(['Save', 'Cancel', 'Discard'], #{
        \ filter: 'MyMenuFilter',
        \ callback: 'MyMenuHandler',
        \ })

func MyMenuFilter(id, key)
  &quot; Handle shortcuts
  if a:key == 'S'
     call popup_close(a:id, 1)
     return 1
  endif
  if a:key == 'C'
     call popup_close(a:id, 2)
     return 1
  endif
  if a:key == 'D'
     call popup_close(a:id, 3)
     return 1
  endif

  &quot; No shortcut, pass to generic filter
  return popup_filter_menu(a:id, a:key)
endfunc
</pre><a name="popup_005fbeval_005fexample"></a><a name="index-popup_005fbeval_005fexample"></a>
<a name="g_t_0027ballooneval_0027-notamenopotupuatupuuindounoShi-Yong-Li_003a"></a>
<h4 class="unnumberedsubsec">&rsquo;<samp>ballooneval</samp>&rsquo; のためのポップアップウィンドウの使用例:</h4>

<pre class="verbatim">set ballooneval balloonevalterm
set balloonexpr=BalloonExpr()
let s:winid = 0
let s:last_text = ''

func BalloonExpr()
  if s:winid &amp;&amp; popup_getpos(s:winid) != {}
    &quot; previous popup window still shows
    if v:beval_text == s:last_text
      &quot; Still the same text, keep the existing popup
      return ''
    endif
    call popup_close(s:winid)
  endif
  let s:winid = popup_beval(v:beval_text, #{mousemoved: 'word'})
  let s:last_text = v:beval_text
  return ''
endfunc
</pre><p>ひとたびテキストが利用できるやうにな、もしもテキストを非同期的に得られるなら、式函數から空の文字列を返し、popup_beval() を呼び出します。タイマーコールバックをシミュレートした例：
</p>
<pre class="verbatim">set ballooneval balloonevalterm
set balloonexpr=BalloonExpr()
let s:winid = 0
let s:balloonText = ''

func BalloonExpr()
  if s:winid &amp;&amp; popup_getpos(s:winid) != {}
    &quot; 以前のポップアップウィンドウはまだ見えてゐます
    if  v:beval_text == s:balloonText
      &quot; テキストを默らせて、ポップアップはそのまま
      return ''
    endif
    call popup_close(s:winid)
    let s:winid = 0
  endif
  &quot; テキストを表示するために非同期的なループをシミュレート
  let s:balloonText = v:beval_text
  call timer_start(100, 'ShowPopup')
  return ''
endfunc

func ShowPopup(id)
  let s:winid = popup_beval(s:balloonText, #{mousemoved: 'word'})
endfunc
</pre>
<hr>
<div class="header">
<p>
Up: <a href="Mu-Ci-.html#g_t_76ee_6b21" accesskey="u" rel="up">目次</a> &nbsp; [<a href="Indexes-CP.html#Indexes-CP" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>

<!DOCTYPE html>
<html lang="ja">
<!-- Created by GNU Texinfo 6.5, http://www.gnu.org/software/texinfo/ -->
<head>

<title>gui_w32.txt (Vim Reference Manual)</title>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<meta name="description" content="gui_w32.txt (Vim Reference Manual)">
<meta name="keywords" content="gui_w32.txt (Vim Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2any">
<link href="Mu-Ci-.html#g_t_76ee_6b21" rel="start" title="目次">
<link href="Indexes-CP.html#Indexes-CP" rel="index" title="Indexes CP">
<link href="Mu-Ci-.html#g_t_76ee_6b21" rel="up" title="目次">
<link href="gui_005fx11_002etxt.html#gui_005fx11_002etxt" rel="next" title="gui_x11.txt">
<link href="gui_002etxt.html#gui_002etxt" rel="prev" title="gui.txt">
<style>
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>
<link rel="stylesheet" type="text/css" href="style.css">


</head>

<body lang="ja">
<a name="gui_005fw32_002etxt"></a>
<div class="header">
<p>
Up: <a href="Mu-Ci-.html#g_t_76ee_6b21" accesskey="u" rel="up">目次</a> &nbsp; [<a href="Indexes-CP.html#Indexes-CP" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<a name="Win32-GUI"></a>
<h2 class="unnumbered">Win32 GUI</h2>
<pre class="verbatim">*gui_w32.txt*   For Vim バージョン 8.1.  Last change: 2019 May 05


                VIMリファレンスマニュアル    by Bram Moolenaar
</pre>

<a name="gui_002dw32"></a><a name="win32_002dgui"></a><a name="index-gui_002dw32"></a>
<a name="index-win32_002dgui"></a>
<p>Win32 での Vim のグラフィカルユーザーインターフェイス
</p>
<table>
<tr><td width="50%">1. GUI を始める</td><td width="50%">|<a href="#gui_002dw32_002dstart">gui-w32-start</a>|</td></tr>
<tr><td width="50%">2. デフォルトエディタ Vim</td><td width="50%">|<a href="#vim_002ddefault_002deditor">vim-default-editor</a>|</td></tr>
<tr><td width="50%">3. クリップボードを使ふ</td><td width="50%">|<a href="#gui_002dclipboard">gui-clipboard</a>|</td></tr>
<tr><td width="50%">4. シェルコマンド</td><td width="50%">|<a href="#gui_002dshell_002dwin32">gui-shell-win32</a>|</td></tr>
<tr><td width="50%">5. 特別な色</td><td width="50%">|<a href="#win32_002dcolors">win32-colors</a>|</td></tr>
<tr><td width="50%">6. ダイアログとブラウズ</td><td width="50%">|<a href="#gui_002dw32_002ddialogs">gui-w32-dialogs</a>|</td></tr>
<tr><td width="50%">7. コマンドライン引數</td><td width="50%">|<a href="#gui_002dw32_002dcmdargs">gui-w32-cmdargs</a>|</td></tr>
<tr><td width="50%">8. その他色々</td><td width="50%">|<a href="#gui_002dw32_002dvarious">gui-w32-various</a>|</td></tr>
</table>

<p>その他の關聯した文章:
</p><table>
<tr><td width="30%">|<a href="gui_002etxt.html#gui_002etxt">gui.txt</a>|</td><td width="70%">GUI の一般的な要素。</td></tr>
<tr><td width="30%">|<a href="os_005fwin32_002etxt.html#os_005fwin32_002etxt">os_win32.txt</a>|</td><td width="70%">Win32 特有の要素。</td></tr>
</table>


<a name="gui_002dw32_002dstart"></a><a name="index-gui_002dw32_002dstart"></a>
<a name="g_t1_002e-GUI-woShi-meru"></a>
<h3 class="section">1. GUI を始める</h3>

<p>Win32 の GUI バージョンは、どんな名前で起動されたかなんておかまひ無しに、いつも GUI でスタートする。
</p>
<p>GUI は常に Windows のサブシステムとして實行される。ほとんどのシェルは Vim を起動した直後にコマンドプロンプトへ自動的に復歸する。さうでなかつたら、&quot;start&quot; コマンドを使ふと良い:
</p><div class="example">
<pre class="example">start gvim [options] file ..
</pre></div>
<a name="E988"></a><a name="index-E988"></a>
<p>コンソールバージョンに |<a href="starting_002etxt.html#g_t_002dg">-g</a>| オプションを付けても gvim.exe が實行されて GUI をスタートできる。
</p><pre class="verbatim">vim -g [options] file ..
</pre><p>この機能を動作させるには、gvim.exe が vim.exe と同一のディレクトリに存在し、かつこの機能を有效にしてコンパイルされてゐなければならない。
</p>
<p>コンソールバージョンから &lsquo;<code>:gui</code>&lsquo; を使ふこともできる。しかし、これは實驗的な機能で、かつこの機能を有效にしてコンパイルされてゐなければならない。セッションファイルを使つて現在のコンソール Vim の狀態が GUI Vim で再生成される。
</p>
<blockquote>
<p><strong>Note:</strong> <br>
全てのフォント (太字、斜體) は同じ大きさでなければならない！！！さうしない場合、文字が缺けたり表示がゴチャゴチャになつたりしてしまふだらう。Vim はフォントの大きさを檢査してゐない。畫面上でのピクセルサイズが同じでなければならない。
</p></blockquote>
<blockquote>
<p><strong>Note:</strong> <br>
同じポイントサイズのフォントでも、同じピクセルサイズのフォントだとは限らないことに注意！加へてフォントの位置情報 (アセントとディセント) も同じでなければならない。
</p></blockquote>

<p>Win32 GUI ではメニューが擴張されてゐる: &quot;編輯/フォント設定&quot;。Windows の標準フォントセレクトダイアログが起動される。
</p>
<p>メニューの高さ設定は、Win32 GUI では動作しない。
</p>
<a name="gui_002dwin32_002dmaximized"></a><a name="index-gui_002dwin32_002dmaximized"></a>
<p>Vim のウィンドウを最大化した狀態で起動したいのならば、<samp>vimrc</samp> か <samp>gvimrc</samp> に次のコマンドを書き加へる:
</p><div class="example">
<pre class="example">au GUIEnter * simalt ~x
</pre></div>

<a name="gui_002dw32_002dwindowid"></a><a name="index-gui_002dw32_002dwindowid"></a>
<a name="Vim-wopuraguintositeShi-u"></a>
<h4 class="unnumberedsubsec">Vim をプラグインとして使ふ</h4>

<p>普通に gvim が起動されると、gvim のウィンドウがトップレベルで作成される。コマンドラインオプション |<a href="starting_002etxt.html#g_t_002d_002dwindowid">--windowid</a>| に 10 進または 16 進の數値を指定すると、Vim はその ID を持つウィンドウの子ウィンドウを作成する。これによつて、Vim を他のアプリケーションのプラグインとして使ふことができる。これは完全にプログラマ向けのインターフェイスであり、Vim を正しく起動するアプリケーションの對應なくしては何の役にも立たない。
</p>
<a name="vim_002ddefault_002deditor"></a><a name="index-vim_002ddefault_002deditor"></a>
<a name="g_t2_002e-dehuorutoedeita-Vim"></a>
<h3 class="section">2. デフォルトエディタ Vim</h3>

<p>Vim をあるファイルタイプのデフォルトエディタにするには:
</p><ol>
<li> Windows のエクスプローラーを起動する
</li><li> ツール/フォルダオプション -&gt; ファイルタイプ (W2K + IE5.5)
</li><li> Vim を使用したい全てのファイルタイプに對して、gvim のパスを設定する。(擴張子の無いファイルタイプに對しては、ファイルタイプを指定するフィールドに 3 つのスペースを置くことで對應できる)
アクションの &quot;open&quot; に:
<div class="example">
<pre class="example">gvim &quot;%1&quot;
</pre></div>
<p>ファイル名にスペースを含むファイルを正しく扱ふためにクォート (&quot;) が必要。かういふ方法もある:
</p><div class="example">
<pre class="example">gvim &quot;%L&quot;
</pre></div>
<p>これにより幾つかの狀況で、短い形式のファイル名 (8.3 形式) を避けることができる。しかし、常に働くわけではない。
</p></li></ol>

<p>ファイルをダブルクリックして Vim で開いた時には、Vim はそのファイルのディレクトリへ移動する。
</p>
<p>Vim を全畫面で起動したい時には、open のアクションとして次のものを使用する:
</p><div class="example">
<pre class="example">gvim -c &quot;simalt ~x&quot; &quot;%1&quot;
</pre></div>

<p>新たに Vim を違ふディレクトリに置いた時 (新しいバージョンを入手した時など) の、も
う 1 つの方法は:
</p><ol>
<li> Vim を使つて開きたいファイルを選ぶ
</li><li> &lt;Shift-F10&gt; を押す
</li><li> メニューから &quot;アプリケーションから開く&quot; を選擇する
</li><li> &quot;その他&quot; をクリック
</li><li> Vim の新しい位置を參照して、開くをクリックする。
</li><li> &quot;いつもこのアプリケーションを使ふ&quot; をチェックする
</li><li> OK をクリック
</li></ol>

<a name="send_002dto_002dmenu"></a><a name="sendto"></a><a name="index-send_002dto_002dmenu"></a>
<a name="index-sendto"></a>
<p>Vim を &quot;送る&quot; メニューに追加することもできる:
</p><ol>
<li> Windows のエクスプローラーを起動する。
</li><li> &quot;送る&quot; のためのディレクトリに移動する:
<div class="example">
<pre class="example">Windows NT: %windir%\profiles\%user%\sendto (e.g. &quot;c:\winnt\profiles\mattha\sendto&quot;)
Windows XP: C:\Documents and Settings\%user%\SendTo
Windows Vista: C:\Users\%user%\AppData\Roaming\Microsoft\Windows\SendTo .
</pre></div>
</li><li> ファイル表示枠の上で右クリックして新規作成 → ショートカット。
</li><li> ショートカットウィザードに從つて VIM/GVIM へのフルパスを指定。
</li></ol>

<p>Vim にファイルを送ると、Vim はファイルのあるディレクトリに移動する。しかし長いディレクトリ名は短い (MS-DOS 形式) で表示されてしまふことに注意。これは Windows の &quot;送る&quot; の仕組みによる制限である。
</p>
<a name="notepad"></a><a name="index-notepad"></a>
<p>notepad.exe (メモ帳) を gvim.exe に置き換へてしまふこともできるが、これには副作用もある。いくつかのプログラムは notepad.exe に依存してゐて、例へばファイルを印刷するために &quot;notepad -p&quot; を使つてゐるからである。メモ帳 (notepad) はそのままにしておいて、Vim を起動するためのほかの方法を使つたはうが良い。
</p>
<a name="win32_002dpopup_002dmenu"></a><a name="index-win32_002dpopup_002dmenu"></a>
<p>もつと拔本的なアプローチは、右マウスボタンメニューに &quot;Edit with Vim&quot; といふ項目を追加するものである。これを使ふとあらゆるファイルを Vim で編輯できるやうになる。
</p>
<p>これは上述のファイルの關聯付けと共存することができる。ファイルの關聯付けは、Vim で開始することを「デフォルトのアクション」にしてしまふ點が違ふ。&quot;Edit with Vim&quot; メニュー項目を使ふと、ダブルクリックで開ける既に存在するファイルの關聯付けはそのままにして、したい時にはいつでも Vim でファイルを編輯することができる。
</p>
<p>例へば、&quot;*.mak&quot; は make プログラムに關聯付けることができる。この場合、そのファイルをダブルクリックすれば makefile が實行されるし、&quot;Edit with Vim&quot; を選べば makefile を編輯することができる。
</p>
<p>どんなファイルでも選擇し、右クリックで &quot;Edit with gvim&quot; と呼ばれるメニューオプションを表示させることができる。このメニューオプションを選擇すると、選擇したファイルが gvim によつて開かれる。複數のファイルを選擇した場合には、2 つのメニューオプションが提示されるだらう:
</p><div class="example">
<pre class="example">&quot;Edit with multiple gvims&quot;  -- 1 つのファイルにつき 1 つの gvim が起動される
&quot;Edit with single gvim&quot;     -- 選んだ全てのファイルが 1 つの gvim で開かれる
</pre></div>
<p>さらに、もしもすでに gvim が起動してゐるなら:
</p><div class="example">
<pre class="example">&quot;Edit with existing gvim    -- すでに起動してゐる gvim でそのファイルの編輯を開始する。
</pre></div>

<p>&quot;edit with existing Vim&quot; メニューはレジストリを設定することで無效化できる。HKLM\Software\Vim\Gvim に DisableEditWithExisting といふ名前のエントリを追加すればよい。値は何でもよい。
<a name="install_002dregistry"></a><a name="index-install_002dregistry"></a>
&quot;install.exe&quot; プログラムを使用すれば、簡單に &quot;Edit with Vim&quot; メニュー項目を追加することができる。これはレジストリに幾つかの項目を書き加へる。
</p>
<p>同じことを手動で行ふこともできる。これは非常に複雜である！できれば install.exe を使ふことをオススメする。
</p>
<ol>
<li> &quot;regedit&quot; でレジストリエディタを起動する。
</li><li> 次のキーを追加する:
<pre class="verbatim">キー                                                                                    キーの名前                              値
HKEY_CLASSES_ROOT\CLSID\{51EEE242-AD87-11d3-9C1E-0090278BBD99}                          {default}                               Vim Shell Extension
HKEY_CLASSES_ROOT\CLSID\{51EEE242-AD87-11d3-9C1E-0090278BBD99}\InProcServer32           {default}                               {path}\gvimext.dll
                                                                                        ThreadingModel                          Apartment
HKEY_CLASSES_ROOT\*\shellex\ContextMenuHandlers\gvim                                    {default}                               {51EEE242-AD87-11d3-9C1E-0090278BBD99}
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Shell Extensions\Approved  {51EEE242-AD87-11d3-9C1E-0090278BBD99}  Vim Shell Extension
HKEY_LOCAL_MACHINE\Software\Vim\Gvim                                                    path                                    {path}\gvim.exe
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Uninstall\vim 5.6          DisplayName                             Vim 5.6: Edit with Vim popup menu entry
                                                                                        UninstallString                         {path}\uninstal.exe
</pre><p>{path} は實行可能ファイルのあるディレクトリパスに置き換へる。
</p>
<p>{default} はキー自身の値なので、タイプしない。
</p></li></ol>

<p>ポップアップメニューから &quot;Edit with Vim&quot; を削除するには、上記のレジストリ項目を削除すればよい。uninstal.exe プログラムは同じことをしてくれる。Windows 標準の &quot;アプリケーションの追加と削除&quot; のリストの、エントリを使ふこともできる。
</p>
<p>このエントリがファイルタイプの關聯付けを抑制してしまふことに氣がついたら、手動で關聯付けをやり直す (上記を參考に、Windows のエクスプローラーを使つて)。これは Windows NT の幾つかのバージョンでだけ起こるらしい (Windows のバグ？) 。手續き:
</p><ol>
<li> ファイルタイプの名前を見つける。これはレジストリエディタを起動し、\\HKEY_CLASSES_ROOT で擴張子を探すことで行へる。
</li><li> Windows エクスプローラーでは、表示 → オプション → ファイルタイプ。リストの中からファイルタイプを探し出し &quot;編輯&quot; をクリック。アクションのリストで、デフォルトとして使用したいものを選擇し (通常は &quot;開く&quot; アクション)、&quot;標準&quot; ボタンをクリックする。
</li></ol>


<a name="win32_002dopen_002dwith_002dmenu"></a><a name="index-win32_002dopen_002dwith_002dmenu"></a>
<a name="g_t_0022apurikesiyonkaraKai-ku_0022-_0028_0022Open-With_002e_002e_002e_0022_0029-kontekisutomeniyu"></a>
<h4 class="unnumberedsubsec">&quot;アプリケーションから開く&quot; (&quot;Open With...&quot;) コンテキストメニュー</h4>

<p>Vim のインストーラを使ふならエクスプローラーのメニューの &quot;アプリケーションから開く&quot; に Vim を加へるか選擇することができる。これは Vim でいろんなファイルを編輯するなら重要である。(不明瞭な理由で) 全てのファイルには使へない。したがつて &quot;Edit with Vim&quot; メニューの方が使ひやすい。
</p>
<p>これを追加する理由の 1 つがインターネットエクスプローラーから直接ファイルを編輯できるやうにするためである。これを有效にするには &quot;Tools&quot; メニューから &quot;Internet Options...&quot; を選擇し、出てきたダイアログウィンドウの &quot;Programs&quot; タブの &quot;HTML editor&quot; に Vim を選擇する。そこに Vim がなければインストールは完了してゐない。
</p>
<p>このスクリプトを使つて手作業で設定できる。
</p>
<pre class="verbatim">REGEDIT4

[HKEY_CLASSES_ROOT\Applications\gvim.exe]

[HKEY_CLASSES_ROOT\Applications\gvim.exe\shell]

[HKEY_CLASSES_ROOT\Applications\gvim.exe\shell\edit]

[HKEY_CLASSES_ROOT\Applications\gvim.exe\shell\edit\command]
@=&quot;c:\\vim\\vim62\\gvim.exe \&quot;%1\&quot;&quot;

[HKEY_CLASSES_ROOT\.htm\OpenWithList\gvim.exe]

[HKEY_CLASSES_ROOT\*\OpenWithList\gvim.exe]
</pre>
<p>&quot;c:\\vim\\vim62&quot; を gvim.exe が實際にある場所に變更すること。
</p>
<p>これをアンインストールするには Vim のアンインストーラを使ふか &quot;regedit&quot; を使つて手作業でレジストリエントリを削除する。
</p>
<a name="gui_002dclipboard"></a><a name="index-gui_002dclipboard"></a>
<a name="g_t3_002e-kuritupubodowoShi-u"></a>
<h3 class="section">3. クリップボードを使ふ</h3>

<p>Windows にはテキストを一時的に格納 (コピー) し、取り出す (ペースト) できるクリップボードがある。Vim では幾つかの方法でクリップボードに對應してゐる。他のシステムについては |<a href="gui_002etxt.html#gui_002dselections">gui-selections</a>| を參照。
</p>
<p>&quot;* レジスタにはクリップボードの內容が反映される。|<a href="gui_002etxt.html#quotestar">quotestar</a>|
</p>
<p>&rsquo;<samp>clipboard</samp>&rsquo; オプションに文字列 &quot;<var>unnamed</var>&quot; が含まれてゐる時には、名前なしレジスタが同じになる。かうすることで、ヤンク (Vim におけるコピー &quot;y&quot;) やペースト (Vim における貼り付け &quot;p&quot;) にクリップボードを、&quot;* を付けることなく使用できる。
</p>
<p>デフォルトでは &rsquo;<samp>guioptions</samp>&rsquo; に &rsquo;<var>a</var>&rsquo; フラグは含まれてゐない。これはその操作を行つた時にだけ、テキストがクリップボードへ送られることを意味してゐる。單に視覺的に選擇 (Visual モード) しただけではクリップボードには送られない。&rsquo;<var>a</var>&rsquo; フラグを加へれば、(Visual モードで選擇するだけで) 操作をせずにもクリップボードへ送られる。
</p>
<a name="mswin_002evim"></a><a name="index-mswin_002evim"></a>
<p>標準的な MS-Windows の <kbd>CTRL-X</kbd>, <kbd>CTRL-C</kbd> および <kbd>CTRL-V</kbd> を使ふには、$VIMRUNTIME/mswin.vim スクリプトを使用する。<samp>_vimrc</samp> ファイルに次の 1 行を追加する:
</p><div class="example">
<pre class="example">source $VIMRUNTIME/mswin.vim
</pre></div>

<p><kbd>CTRL-C</kbd> がクリップボードへのコピーになつてしまふので、操作を停止すること (無限ループに陷つたスクリプトを停止するなど) が、できなくなつてしまふ。代はりに <kbd>CTRL-Break</kbd> が使へる。
</p>
<p><kbd>CTRL-Z</kbd> がアンドゥになる。そのため、このキーで Vim をサスペンドすることはできない。代はりに |<a href="starting_002etxt.html#g_t_003asuspend">:suspend</a>| を使ふこと (これがサポートされてゐればだが)。
</p>
<a name="CTRL_002dV_002dalternative"></a><a name="CTRL_002dQ"></a><a name="index-CTRL_002dV_002dalternative"></a>
<a name="index-CTRL_002dQ"></a>
<p><kbd>CTRL-V</kbd> がペーストに使はれてしまふので、矩形ビジュアル選擇を開始することができない。これには <kbd>CTRL-Q</kbd> を代用できる。插入モードやコマンドラインモードにおいても、もともとの <kbd>CTRL-V</kbd> の代はりに <kbd>CTRL-Q</kbd> を使用することができる。しかしターミナルで <kbd>CTRL-Q</kbd> が制禦のために使はれる時はうまく機能しない。
</p>
<blockquote>
<p><strong>Note:</strong> <br>
クリップボードのサポートにはまだかなりのバグがある。|todo| 參照。
</p></blockquote>

<a name="gui_002dshell_002dwin32"></a><a name="index-gui_002dshell_002dwin32"></a>
<a name="g_t4_002e-sierukomando"></a>
<h3 class="section">4. シェルコマンド</h3>

<p>Vim は外部コマンドを實行するのに、どんなコマンドでも實行できるやうにするために Vim とは別個のウィンドウを使用する。外部コマンドはちやうど DOS プロンプトから實行されるやうに、獨自の實行環境を獲得する。
</p>
<a name="win32_002dvimrun"></a><a name="index-win32_002dvimrun"></a>
<p>外部コマンドの實行は &quot;vimrun&quot; コマンドを用ゐて閒接的に行はれる。これが働くためには &quot;vimrun.exe&quot; コマンドが實行パスになければならない。さうでなければ Vim の實行ファイルと同じディレクトリになければならない。&quot;vimrun&quot; を見つけることができなければ、コマンドは直接實行され、そのため外部コマンドの實行が終了するとすぐに DOS ウィンドウが閉ぢられる。
</p><blockquote>
<p><strong>警告:</strong> <br>
もしも &quot;X&quot; ボタンでこのウィンドウを閉ぢてしまひ、强制終了することを確認するウィンドウでアプリケーションを本當に終了してしまふと、Vim も一緖に强制終了してしまふ！(&quot;<code>:!start</code>&quot; で非同期的に起動されたアプリケーションには、これは當てはまらない)
</p></blockquote>

<p>コントロールパネルの &quot;コンソール&quot; によつて設定された內容がデフォルトで使用される。
</p>
<a name="win32_002d_0021start"></a><a name="index-win32_002d_0021start"></a>
<p>通常、Vim はコマンドの實行が終了するのを待つ(これは多くのシェルコマンドの出力を Vim が取り込んで使用できるやうにするため)。Vim がプログラムを實行した後、その終了を待たないやうに望むのならば、次の構文を使用することができる:
</p><div class="example">
<pre class="example">:!start [/min] {command}
</pre></div>
<p>&quot;/min&quot; 引數を指定すると、ウィンドウは最小化される。
</p>
<a name="win32_002dcolors"></a><a name="index-win32_002dcolors"></a>
<a name="g_t5_002e-Te-Bie-naSe-"></a>
<h3 class="section">5. 特別な色</h3>

<p>Win32 では、通常の DOS での色が使用される。|<a href="os_005fdos_002etxt.html#dos_002dcolors">dos-colors</a>| を參照。
</p>
<p>付け加へて、システムが構成してゐる色を使用することができる。それらは Sys_XXX として知られ、XXX の部分は下のリストに示される、割り當てられてゐるシステムカラー名である (完全な解說は Win32 の文章を參照)。大文字小文字は區別されない。
</p>
<pre class="verbatim">Sys_3DDKShadow          Sys_3DFace                      Sys_BTNFace
Sys_3DHilight           Sys_3DHighlight                 Sys_BTNHilight
Sys_BTNHighlight        Sys_3DLight                     Sys_3DShadow
Sys_BTNShadow           Sys_ActiveBorder                Sys_ActiveCaption
Sys_AppWorkspace        Sys_Background                  Sys_Desktop
Sys_BTNText             Sys_CaptionText                 Sys_GrayText
Sys_Highlight           Sys_HighlightText               Sys_InactiveBorder
Sys_InactiveCaption     Sys_InactiveCaptionText         Sys_InfoBK
Sys_InfoText            Sys_Menu                        Sys_MenuText
Sys_ScrollBar           Sys_Window                      Sys_WindowFrame
Sys_WindowText
</pre>
<p>恐らく一番便利な値はこれらだらう
</p><pre class="verbatim">Sys_Window          通常のウィンドウの背景の色
Sys_WindowText      通常のウィンドウの文字の色
Sys_Highlight       選擇されたテキストの背景の色
Sys_HighlightText   選擇されたテキストの文字の色
</pre>
<p>他にもこの樣な色も存在する:
</p>
<p>Gray, Grey, LightYellow, SeaGreen, Orange, Purple, SlateBlue, Violet
</p>
<a name="rgb_002etxt"></a><a name="index-rgb_002etxt"></a>
<p>付け加へて、&quot;rgb.txt&quot; で定義される色も使ふことができる。このファイルは X11 のものとして知られてゐる。何行かを拔萃する:
</p>
<div class="example">
<pre class="example">255 218 185              peach puff
205 133  63              peru
255 181 197              pink
</pre></div>

<p>これはファイルのレイアウトを示してゐる: 最初に赤、綠、そして靑の輝度を 10 進數で記述し、續いて色の名前を定義してゐる。4 つのフィールドはスペースで區切られてゐる。
</p>
<p>rgb.txt は X11 のディストリビューションから手に入れることができる。&quot;/usr/X11R6/lib/X11/&quot; あたりのディレクトリにおいてあることが多い。Vim では $VIMRUNTIME ディレクトリに置く。だから &quot;$VIMRUNTIME/rgb.txt&quot; にファイルが見つけることができる。
</p>
<a name="gui_002dw32_002ddialogs"></a><a name="dialog"></a><a name="index-gui_002dw32_002ddialogs"></a>
<a name="index-dialog"></a>
<a name="g_t6_002e-daiarogutoburauzu"></a>
<h3 class="section">6. ダイアログとブラウズ</h3>

<p>コンソールバージョンから受け繼がれる傳統的なインターフェイスはもちろん、さらに Win32 GUI では幾つかの操作に見慣れた Windows のコンポーネントを使用することができる。
</p>

<a name="g_t6_002e1-daiarogu"></a>
<h4 class="unnumberedsubsec">6.1 ダイアログ</h4>

<p>その他のバージョンではコンソールベースで行はれてゐた &quot;confirm&quot; ファミリ (すなはち &rsquo;<samp>confirm</samp>&rsquo; オプションと |<a href="editing_002etxt.html#g_t_003aconfirm">:confirm</a>| コマンドと |<a href="eval_002etxt.html#confirm_0028_0029">confirm()</a>| 函數) で、GUI ベースのダイアログが表示される。&rsquo;<samp>guioptions</samp>&rsquo; の &rsquo;<var>c</var>&rsquo; フラグでこれを變更できる。
</p>

<a name="g_t6_002e2-huairuburauza"></a>
<h4 class="unnumberedsubsec">6.2 ファイルブラウザー</h4>

<p>ファイルを編輯するコマンドの前に &quot;:browse&quot; を付けると、存在するファイルを選擇するためのウィンドウ選擇ダイアログが使用される。|<a href="editing_002etxt.html#g_t_003abrowse">:browse</a>| を參照。
</p>

<a name="g_t6_002e3-Qie-Qu-meniyu"></a>
<h4 class="unnumberedsubsec">6.3 切取メニュー</h4>

<p>Win32 GUI 版では Motif の「切取メニュー」をエミュレートする。個々のメニューの最上位には、小さな「切り取り線」のグラフィックスが存在する。これを選擇すると同じメニューのエントリがある、フローティングウィンドウが作成される。フローティングメニューを使用すれば、いちいちメニューバーに移動することなく、オリジナルのメニューの (サブメニューも含めた) 項目にアクセスすることができる。
</p>
<p>これはサブメニューの奧の方のコマンドを頻繁に使用するときに非常に便利。
</p>
<p>切取メニューは好きなところに配置し、常に Vim のメインウィンドウよりも手前に表示される。普通に閉ぢることで取り除くこともできる; もちろん Vim を終了すれば自動的にそれらも閉ぢられる。
</p>
<dl compact="compact">
<dd><a name="g_t_003atearoff"></a><a name="g_t_003ate"></a><a name="index-_003atearoff"></a>
<a name="index-_003ate"></a>
</dd>
<dt>:te[aroff] {name}</dt>
<dd><p>{name} といふメニューを切り取る。指定されたメニューは少なくとも 1 つ以上のサブエントリを持たねばないが、メニューバーに表示されてゐる必要は無い。(|<a href="gui_002etxt.html#win32_002dhidden_002dmenus">win32-hidden-menus</a>| を參照)。
</p></dd>
</dl>

<p>例:
</p><div class="example">
<pre class="example">:tearoff ファイル(F)
</pre></div>
<p>&quot;ファイル&quot; メニューが(あれば)切取メニューとして表示される。
</p><div class="example">
<pre class="example">:amenu ]Toolbar.Make    :make&lt;CR&gt;
:tearoff ]Toolbar
</pre></div>
<p>メインのメニューバーには存在しないフローティングメニューを作成する。
</p>
<blockquote>
<p><strong>Note:</strong> <br>
&rsquo;]&rsquo; で始まるメニューは表示されないことに注意。
</p></blockquote>

<a name="gui_002dw32_002dcmdargs"></a><a name="index-gui_002dw32_002dcmdargs"></a>
<a name="g_t7_002e-komandorainYin-Shu-"></a>
<h3 class="section">7. コマンドライン引數</h3>

<p>コマンドライン引數はコンソール版と同じ擧動となる。|<a href="os_005fwin32_002etxt.html#win32_002dcmdargs">win32-cmdargs</a>| を參照。
</p>
<a name="gui_002dw32_002dvarious"></a><a name="index-gui_002dw32_002dvarious"></a>
<a name="g_t8_002e-sonoTa-Se-_0022"></a>
<h3 class="section">8. その他色々</h3>

<a name="gui_002dw32_002dprinting"></a><a name="index-gui_002dw32_002dprinting"></a>
<p>&quot;ファイル/印刷&quot; メニューはシンタックスハイライトを使つて印刷する。|<a href="print_002etxt.html#g_t_003ahardcopy">:hardcopy</a>| を參照すること。もしもテキストを裝飾なしで印刷したいのなら、デフォルトのプリンタがインストールされてゐれば次のやうにできるだらう。
</p><div class="example">
<pre class="example">:w &gt;&gt;prn
</pre></div>

<p>Vim では多くの MS Windows 標準の機能をサポートしてゐる。それらの幾つかは別の場所で說明されてゐる: |<a href="options_002etxt.html#g_t_0027mouse_0027">'mouse'</a>|, |<a href="gui_002etxt.html#win32_002dhidden_002dmenus">win32-hidden-menus</a>| を參照。
</p>
<a name="drag_002dn_002ddrop_002dwin32"></a><a name="index-drag_002dn_002ddrop_002dwin32"></a>
<p>Vim のウィンドウに1つもしくは複數のファイルをドラッグ&amp;ドロップすることができ、それらは普通に開かれる。|<a href="gui_002etxt.html#drag_002dn_002ddrop">drag-n-drop</a>| を參照。
</p>
<dl compact="compact">
<dd><a name="g_t_003asimalt"></a><a name="g_t_003asim"></a><a name="index-_003asimalt"></a>
<a name="index-_003asim"></a>
</dd>
<dt>:sim[alt] {key}</dt>
<dd><p><code class="tt-key">Alt</code> と {key} の同時押しをシミュレートする。
</p>
<p>{Win32 バージョンだけの機能}
</p><blockquote>
<p><strong>Note:</strong> <br>
&quot;:si&quot; は &quot;i&quot; フラグ付きの &quot;:s&quot; になる。
</p></blockquote>
</dd>
</dl>

<p>通常、Vim では使用可能なマッピングを增やすために、Alt-&lt;Key&gt; の全ての組み合はせを使ふことができる。これはメニューにアクセスするための <code class="tt-key">Alt</code> キーの標準的な使ひ方と衝突する。
</p>
<p>標準的な振る舞ひをさせるための近道は、&rsquo;<samp>winaltkeys</samp>&rsquo; オプションに &quot;<var>yes</var>&quot; を設定することである。しかしかうすると <code class="tt-key">Alt</code> を使用したマッピングは一切使へなくなる。
</p>
<p>もう 1 つの方法は &rsquo;<samp>winaltkeys</samp>&rsquo; に &quot;<var>menu</var>&quot; を指定することである。マッピングされてゐない <code class="tt-key">ALT</code> キーだけが、メニューのショートカットとして Windows に解釋される。だが、現在の狀態に依存することは許さない。
これを囘避するために、(&rsquo;<samp>winaltkeys</samp>&rsquo; が &quot;<var>yes</var>&quot; でない時に) <code>:simalt</code> コマンドで、Windows のスタイルで <code class="tt-key">Alt</code> キーを押すふりを、Vim にさせることができる。これを使つて Windows 標準のアクションを興すための、<code class="tt-key">Alt</code> キーの組み合はせ (ほかのものでも) をマッピングすることができる。いくつか例を示さう:
</p><div class="example">
<pre class="example">:map &lt;M-f&gt; :simalt f&lt;CR&gt;
</pre></div>
<p>これで <kbd>Alt-F</kbd> を押すとキーストロークの Alt→F がシミュレートされ、&rsquo;ファイル(F)&rsquo; メニュー (Menu.vim で定義される) が表示される。
</p><div class="example">
<pre class="example">:map &lt;M-Space&gt; :simalt ~&lt;CR&gt;
</pre></div>
<p>このマッピングにより <kbd>Alt-Space</kbd> で Vim ウィンドウのシステムメニューが表示される。
</p><blockquote>
<p><strong>Note:</strong> <br>
&rsquo;~&rsquo; は simalt において文字 &lt;Space&gt; を表現するのに使はれることに注意。
</p></blockquote>
<div class="example">
<pre class="example">:map &lt;C-n&gt; :simalt ~n&lt;CR&gt;
</pre></div>
<p>Control-N に、Alt-Space に N を續けるマッピングを施す。これはシステムメニュー經由で Vim のウィンドウを最小化する。
</p>
<blockquote>
<p><strong>Note:</strong> <br>
これらのキーは使用してゐる言語によつて異なることがある。
</p></blockquote>

<a name="intellimouse_002dwheel_002dproblems"></a><a name="index-intellimouse_002dwheel_002dproblems"></a>
<p>インテリマウスのホイールを使用すると、Vim は入力を受け付けなくなることがある。次の場所へ行き:
</p><pre class="verbatim">コントロールパネル - マウス - ホイール - スクロール - 例外
</pre>
<p>アプリケーションのリストに gvim を追加する。この問題は Intellimouse のドライババージョン 2.2 を使用し、&quot;ユニバーサルスクロール&quot; を有效にしてゐる時にだけ起こる。
</p>

<a name="w32_002dxpm_002dsupport"></a><a name="index-w32_002dxpm_002dsupport"></a>
<a name="XPM-sapoto"></a>
<h4 class="unnumberedsubsec">XPM サポート</h4>

<p>Gvim は、MS-Windows で XPM ファイルのサポート付きでビルドすることができる。|<a href="various_002etxt.html#g_t_002bxpm_005fw32">+xpm_w32</a>| 詳細は <samp>Make_mvc.mak</samp> ファイルを見て、XPM で檢索すること。
</p>
<p>XPM サポートが動作するか試すには、以下を行ふこと:
</p><div class="example">
<pre class="example">:help
:exe 'sign define vimxpm icon=' . $VIMRUNTIME . '\\vim16x16.xpm'
:exe 'sign place 1 line=1 name=vimxpm file=' . expand('%:p')
</pre></div>

<hr>
<div class="header">
<p>
Up: <a href="Mu-Ci-.html#g_t_76ee_6b21" accesskey="u" rel="up">目次</a> &nbsp; [<a href="Indexes-CP.html#Indexes-CP" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>

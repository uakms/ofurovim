<!DOCTYPE html>
<html lang="ja">
<!-- Created by GNU Texinfo 6.7, http://www.gnu.org/software/texinfo/ -->
<head>

<title>change.txt (Vim Reference Manual)</title>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<meta name="description" content="change.txt (Vim Reference Manual)">
<meta name="keywords" content="change.txt (Vim Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2any">
<link href="Mu-Ci-.html" rel="start" title="目次">
<link href="Indexes-CP.html" rel="index" title="Indexes CP">
<link href="Mu-Ci-.html" rel="up" title="目次">
<link href="undo_002etxt.html" rel="next" title="undo.txt">
<link href="insert_002etxt.html" rel="prev" title="insert.txt">
<style>
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>
<link rel="stylesheet" type="text/css" href="style.css">


</head>

<body lang="ja">
<span id="change_002etxt"></span><div class="header">
<p>
Up: <a href="Mu-Ci-.html" accesskey="u" rel="up">目次</a> &nbsp; [<a href="Indexes-CP.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<span id="tekisutonoXue-Chu-toBian-Geng-"></span><h2 class="unnumbered">テキストの削除と變更</h2>
<pre class="verbatim">*change.txt*    For Vim バージョン 8.1.  Last change: 2019 Sep 28


		  VIMリファレンスマニュアル    by Bram Moolenaar
</pre>

<p>このファイルでは、テキストを削除したり變更するコマンドを說明します。この文章の中では、「テキストを變更する」とは、1 つのコマンドでテキストを削除し、別のテキストに置き換へることを意味します。これらのコマンドは全てアンドゥすることができます。非 Ex コマンドはコマンド &quot;.&quot; で繰り返すことができます。
</p>
<table>
<tr><td width="50%">1. テキストの削除</td><td width="50%">|<a href="#deleting">deleting</a>|</td></tr>
<tr><td width="50%">2. 削除と插入</td><td width="50%">|<a href="#delete_002dinsert">delete-insert</a>|
<span id="changing"></span><span id="index-changing"></span></td></tr>
<tr><td width="50%">3. 單純な變更</td><td width="50%">|<a href="#simple_002dchange">simple-change</a>|</td></tr>
<tr><td width="50%">4. 複雜な變更</td><td width="50%">|<a href="#complex_002dchange">complex-change</a>|</td></tr>
<tr><td width="50%">&nbsp;&nbsp;&nbsp;&nbsp;4.1 フィルタコマンド</td><td width="50%">|<a href="#filter">filter</a>|</td></tr>
<tr><td width="50%">&nbsp;&nbsp;&nbsp;&nbsp;4.2 置換</td><td width="50%">|<a href="#g_t_003asubstitute">:substitute</a>|</td></tr>
<tr><td width="50%">&nbsp;&nbsp;&nbsp;&nbsp;4.3 檢索と置換</td><td width="50%">|<a href="#search_002dreplace">search-replace</a>|</td></tr>
<tr><td width="50%">&nbsp;&nbsp;&nbsp;&nbsp;4.4 タブの變換</td><td width="50%">|<a href="#change_002dtabs">change-tabs</a>|</td></tr>
<tr><td width="50%">5. テキストのコピーと移動</td><td width="50%">|<a href="#copy_002dmove">copy-move</a>|</td></tr>
<tr><td width="50%">6. テキストの整形</td><td width="50%">|<a href="#formatting">formatting</a>|</td></tr>
<tr><td width="50%">7. テキストのソート</td><td width="50%">|<a href="#sorting">sorting</a>|</td></tr>
</table>

<p>テキストの插入に關しては |<a href="insert_002etxt.html">insert.txt</a>| を參照してください。
</p>
<span id="deleting"></span><span id="E470"></span><span id="index-deleting"></span>
<span id="index-E470"></span>
<span id="index-tekisutonoXue-Chu-"></span>
<span id="g_t1_002e-tekisutonoXue-Chu-"></span><h3 class="section">1. テキストの削除</h3>

<span id="g_t_003cDel_003e"></span><span id="x"></span><span id="dl"></span><span id="index-_003cDel_003e"></span>
<span id="index-x"></span>
<span id="index-dl"></span>
<dl compact="compact">
<dt>[&quot;x]<code class="tt-key">&lt;Del&gt;</code> または</dt>
<dt>[&quot;x]x</dt>
<dd><p>カーソル下から後の [count] 文字を [レジスタ x に入れて] 削除します (行單位 |<a href="motion_002etxt.html#linewise">linewise</a>| ではありません)。&quot;dl&quot; と同じです。
</p>
<p><code class="tt-key">&lt;Del&gt;</code> キーには [count] が使へません。代はりに、[count] の最後の文字を削除します。{譯注: 123&lt;Del&gt; と押すと 3 が消え 12 になる}
</p>
<p><code class="tt-key">&lt;Del&gt;</code> キーが思つたやうに動作しないときは、|<a href="options_002etxt.html#g_t_003afixdel">:fixdel</a>| を參照してください。&lt;EOL&gt; の削除 (行の連結) については、|<a href="options_002etxt.html#g_t_0027whichwrap_0027">'whichwrap'</a>| を參照してください。
</p>
<span id="X"></span><span id="dh"></span><span id="index-X"></span>
<span id="index-dh"></span>
</dd>
<dt>[&quot;x]X</dt>
<dd><p>カーソルから前の [count] 文字を [レジスタ x に入れて] 削除します (行單位 |<a href="motion_002etxt.html#linewise">linewise</a>| ではありません)。&quot;dh&quot; と同じです。|<a href="options_002etxt.html#g_t_0027whichwrap_0027">'whichwrap'</a>| も參照してください。
</p>
<span id="d"></span><span id="index-d"></span>
</dd>
<dt>[&quot;x]d{motion}</dt>
<dd><p>{motion} でカーソルが動く範圍のテキストを [レジスタ x に入れて] 削除します。例外については以下を參照してください。
</p>
<span id="dd"></span><span id="index-dd"></span>
</dd>
<dt>[&quot;x]dd</dt>
<dd><p>[count] 行を [レジスタ x に入れて] 行單位 |<a href="motion_002etxt.html#linewise">linewise</a>| で削除します。
</p>
<span id="D"></span><span id="index-D"></span>
</dd>
<dt>[&quot;x]D</dt>
<dd><p>カーソル下から行の最後までの文字と、[count]-1 行を、[レジスタ x に入れて] 削除します。&quot;d$&quot; と同義 (行單位 |<a href="motion_002etxt.html#linewise">linewise</a>| ではありません)。
</p>
<p>&rsquo;<samp>cpoptions</samp>&rsquo; にフラグ &rsquo;<var>#</var>&rsquo; が入つてゐるとカウントは無視されます。
</p>
<span id="v_005fx"></span><span id="v_005fd"></span><span id="v_005f_003cDel_003e"></span><span id="index-v_005fx"></span>
<span id="index-v_005fd"></span>
<span id="index-v_005f_003cDel_003e"></span>
</dd>
<dt>{Visual}[&quot;x]x または</dt>
<dt>{Visual}[&quot;x]d または</dt>
<dt>{Visual}[&quot;x]<code class="tt-key">&lt;Del&gt;</code></dt>
<dd><p>ビジュアル選擇されたテキストを [レジスタ x に入れて] 削除します ({Visual} については |<a href="visual_002etxt.html#Visual_002dmode">Visual-mode</a>| を參照してください)。
</p>
<span id="v_005fCTRL_002dH"></span><span id="v_005f_003cBS_003e"></span><span id="index-v_005fCTRL_002dH"></span>
<span id="index-v_005f_003cBS_003e"></span>
</dd>
<dt>{Visual}[&quot;x]<kbd>CTRL-H</kbd> または</dt>
<dt>{Visual}[&quot;x]<code class="tt-key">&lt;BS&gt;</code></dt>
<dd><p>選擇モード內で: ビジュアル選擇されたテキストを [レジスタ x に入れて] 削除します。
</p>
<span id="v_005fX"></span><span id="v_005fD"></span><span id="v_005fb_005fD"></span><span id="index-v_005fX"></span>
<span id="index-v_005fD"></span>
<span id="index-v_005fb_005fD"></span>
</dd>
<dt>{Visual}[&quot;x]X または</dt>
<dt>{Visual}[&quot;x]D</dt>
<dd><p>ビジュアル選擇された行を [レジスタ x に入れて] 削除します ({Visual} については |<a href="visual_002etxt.html#Visual_002dmode">Visual-mode</a>| を參照してください)。矩形ビジュアルモードでは、&quot;D&quot; はビジュアル選擇されたテキストと行末までの全てのテキストを削除します。
</p>
<span id="g_t_003ad"></span><span id="g_t_003ade"></span><span id="g_t_003adel"></span><span id="g_t_003adelete"></span><span id="g_t_003adl"></span><span id="g_t_003adp"></span><span id="index-_003ad"></span>
<span id="index-_003ade"></span>
<span id="index-_003adel"></span>
<span id="index-_003adelete"></span>
<span id="index-_003adl"></span>
<span id="index-_003adp"></span>
</dd>
<dt>:[range]d[elete] [x]</dt>
<dd><p>[range] 行 (既定値: 現在行) を [レジスタ x に入れて] 削除します。
</p><blockquote>
<p><strong>Note:</strong> <br>
これらの變な短縮入力:
</p><table>
<tr><td width="50%">:dl</td><td width="50%">delete と list</td></tr>
<tr><td width="50%">:dell</td><td width="50%">同上</td></tr>
<tr><td width="50%">:delel</td><td width="50%">同上</td></tr>
<tr><td width="50%">:deletl</td><td width="50%">同上</td></tr>
<tr><td width="50%">:deletel</td><td width="50%">同上</td></tr>
<tr><td width="50%">:dp</td><td width="50%">delete と print</td></tr>
<tr><td width="50%">:dep</td><td width="50%">同上</td></tr>
<tr><td width="50%">:delp</td><td width="50%">同上</td></tr>
<tr><td width="50%">:delep</td><td width="50%">同上</td></tr>
<tr><td width="50%">:deletp</td><td width="50%">同上</td></tr>
<tr><td width="50%">:deletep</td><td width="50%">同上</td></tr>
</table>
</blockquote>

</dd>
<dt>:[range]d[elete] [x] {count}</dt>
<dd><p>[range] 行目 (既定: 現在行 |<a href="cmdline_002etxt.html#cmdline_002dranges">cmdline-ranges</a>|) から {count} 行を [レジスタ x に入れて] 削除します。
</p></dd>
</dl>

<p>これらのコマンドはテキストを削除します。これらは (&lsquo;<code>:d</code>&lsquo; を除いて) コマンド &lsquo;<code>.</code>&lsquo; で繰り返したりアンドゥすることができます。テキストのブロックを削除するには、ビジュアルモードを使ひます。レジスタの說明については、|<a href="#registers">registers</a>| を參照してください。
</p>
<p>コマンド &quot;<code>d{motion}</code>&quot; に關する例外: 移動が行單位でなく、移動の開始點と終了點が同じ行になく、移動の開始點の前に空白しかなく、終了點の後に空行以外がない場合には、削除は行單位となります。このときユーザーは空白のみの行が殘ると期待するかもしれませんが、共に削除されます。削除を文字單位に强制したい場合は |<a href="motion_002etxt.html#o_005fv">o_v</a>| を使つてください。
</p>
<p>オプション &rsquo;<samp>cpoptions</samp>&rsquo; がフラグ &rsquo;<var>E</var>&rsquo; を含んでゐるときは、テキストの空の範圍を削除しようとすると (例へば、1 列目での &quot;d0&quot;)、エラーにります。
</p>
<span id="J"></span><span id="index-J"></span>
<dl compact="compact">
<dt>J</dt>
<dd><p>[count] 行を連結します (最低は 2 行)。インデントを削除し、空白を最大 2 個まで插入します (以下を參照してください)。バッファの最終行では失敗します。大きすぎる [count] は、有效な行數まで減少されます。
</p>
<span id="v_005fJ"></span><span id="index-v_005fJ"></span>
</dd>
<dt>{Visual}J</dt>
<dd><p>ビジュアル選擇された行を連結します (最低は 2 行)。インデントを削除し、空白を最大 2 個まで插入します (以下を參照してください)。
</p>
<span id="gJ"></span><span id="index-gJ"></span>
</dd>
<dt>gJ</dt>
<dd><p>[count] 行を連結する (最低は 2 行)。空白の插入や削除を行ひません。
</p>
<span id="v_005fgJ"></span><span id="index-v_005fgJ"></span>
</dd>
<dt>{Visual}gJ</dt>
<dd><p>ビジュアル選擇された行を連結します (最低は 2 行)。空白の插入や削除を行ひません。
</p>
<span id="g_t_003aj"></span><span id="g_t_003ajoin"></span><span id="index-_003aj"></span>
<span id="index-_003ajoin"></span>
</dd>
<dt>:[range]j[oin][!] [flags]</dt>
<dd><p>[range] 行を連結します。&quot;J&quot; と同じですが、[!] と共に使ふと空白の插入や削除を行ひません。[range] の開始點と終了點が同じときは、このコマンドは何もしません。既定の動作では、現在行を次行と連結します。
</p>
<p>[flags] については |<a href="cmdline_002etxt.html#ex_002dflags">ex-flags</a>| を參照してください。
</p>
</dd>
<dt>:[range]j[oin][!] {count} [flags]</dt>
<dd><p>[range] 行目 (既定では現在行 |<a href="cmdline_002etxt.html#cmdline_002dranges">cmdline-ranges</a>|) からの {count} 行を連結します。&quot;J&quot; と同じですが、[!] と共に使ふと空白の插入や削除を行ひません。
</p>
<p>[flags] については |<a href="cmdline_002etxt.html#ex_002dflags">ex-flags</a>| を參照してください。
</p></dd>
</dl>

<p>これらのコマンドは、行の閒の &lt;EOL&gt; を削除します。この結果、複數行が 1 行に連結されます。これらのコマンド (&lsquo;<code>:j</code>&lsquo; 以外) は、繰り返しやアンドゥすることができます。
</p>
<p>これらのコマンド (&quot;<code>gJ</code>&quot; 以外) は &lt;EOL&gt; の場所に空白を 1 個插入します。ただし行末に空白が付いてゐたり、次の行が &rsquo;)&rsquo; で始まるときは插入しません。これらのコマンド (&quot;<code>gJ</code>&quot; 以外) は次行の先頭あたりにある空白を全て削除します。オプション &rsquo;<samp>joinspaces</samp>&rsquo; がオンのときは、これらのコマンドは &rsquo;.&rsquo;, &rsquo;!&rsquo;, &rsquo;?&rsquo; の後に 2 個の空白を插入します (しかし &rsquo;<samp>cpoptions</samp>&rsquo; がフラグ &rsquo;<var>j</var>&rsquo; を含んでゐるときは、2 個の空白は &rsquo;.&rsquo; の後にしか插入しません)。
</p>
<p>&rsquo;<samp>formatoptions</samp>&rsquo; のフラグ &rsquo;<var>M</var>&rsquo; と &rsquo;<var>B</var>&rsquo; は、マルチバイト文字の前後に空白を插入するときの動作を變更します |<a href="#fo_002dtable">fo-table</a>|。
</p>
<p>&rsquo;[ マークは連結前の最初の行の末尾に設定されます。&rsquo;] マークは連結後の行の末尾に設定されます。
</p>

<span id="delete_002dinsert"></span><span id="replacing"></span><span id="index-delete_002dinsert"></span>
<span id="index-replacing"></span>
<span id="index-Xue-Chu-toCha-Ru-"></span>
<span id="g_t2_002e-Xue-Chu-toCha-Ru-"></span><h3 class="section">2. 削除と插入</h3>

<span id="R"></span><span id="index-R"></span>
<dl compact="compact">
<dt>R</dt>
<dd><p>置換モードに入ります。打ち込んだ文字がカーソル下の既存の文字をどんどん置き換へていきます。入力されたテキストを [count]-1 回繰り返します。詳細は |<a href="insert_002etxt.html#Replace_002dmode">Replace-mode</a>| を參照してください。
</p>
<span id="gR"></span><span id="index-gR"></span>
</dd>
<dt>gR</dt>
<dd><p>假想置換モードに入ります。打ち込んだ文字が畫面上の既存の文字をどんどん置き換へていきます。そのため &lt;Tab&gt; は數文字を 1 回で置き換へることができます。入力されたテキストを [count]-1 回繰り返します。詳細は |<a href="insert_002etxt.html#Virtual_002dReplace_002dmode">Virtual-Replace-mode</a>| を參照してください。
</p>
<span id="c"></span><span id="index-c"></span>
</dd>
<dt>[&quot;x]c{motion}</dt>
<dd><p>{motion} のテキストを [レジスタ x に入れて] 削除し、插入を始めます。&rsquo;<samp>cpoptions</samp>&rsquo; がフラグ &rsquo;<var>E</var>&rsquo; を含むときは、削除すべきテキストがないと (例へば &quot;cTx&quot; でカーソルが &rsquo;x&rsquo; の直後にあるとき)、エラーが發生して插入モードは始まりません (これは Vi 互換です)。
</p>
<p>&rsquo;<samp>cpoptions</samp>&rsquo; がフラグ &rsquo;<var>E</var>&rsquo; を含まないときは、コマンド &quot;<code>c</code>&quot; は削除すべきテキストがなくても、必ず插入モードを始めます。
</p>
<span id="cc"></span><span id="index-cc"></span>
</dd>
<dt>[&quot;x]cc</dt>
<dd><p>[count] 行を [レジスタ x に入れて] 削除し、行單位 |<a href="motion_002etxt.html#linewise">linewise</a>| で插入を始めます。&rsquo;<samp>autoindent</samp>&rsquo; がオンのとき、最初の行のインデントを保持します。
</p>
<span id="C"></span><span id="index-C"></span>
</dd>
<dt>[&quot;x]C</dt>
<dd><p>カーソル位置から行の終はりまでと、[count]-1 行を [レジスタ x に入れて] 削除し、插入を始めます。&quot;c$&quot; と同義です (行單位 |<a href="motion_002etxt.html#linewise">linewise</a>| ではありません)。
</p>
<span id="s"></span><span id="index-s"></span>
</dd>
<dt>[&quot;x]s</dt>
<dd><p>[count] 文字を [レジスタ x に入れて] 削除し、插入を始めます (s は Substitute &ndash;置換 を意味します)。&quot;cl&quot; と同義です (行單位 |<a href="motion_002etxt.html#linewise">linewise</a>| ではありません)。
</p>
<span id="S"></span><span id="index-S"></span>
</dd>
<dt>[&quot;x]S</dt>
<dd><p>[count] 行を [レジスタ x に入れて] 削除し、插入を始めます。&quot;cc&quot; と同義です (行單位 |<a href="motion_002etxt.html#linewise">linewise</a>|)。
</p>
<span id="v_005fc"></span><span id="v_005fs"></span><span id="index-v_005fc"></span>
<span id="index-v_005fs"></span>
</dd>
<dt>{Visual}[&quot;x]c または</dt>
<dt>{Visual}[&quot;x]s</dt>
<dd><p>ビジュアル選擇されたテキストを [レジスタ x に入れて] 削除し、插入を始めます ({Visual} については |<a href="visual_002etxt.html#Visual_002dmode">Visual-mode</a>| を參照してください)。
</p>
<span id="v_005fr"></span><span id="index-v_005fr"></span>
</dd>
<dt>{Visual}[&quot;x]r{char}</dt>
<dd><p>ビジュアル選擇されたテキストを全て {char} に置き換へます。
</p>
<span id="v_005fC"></span><span id="index-v_005fC"></span>
</dd>
<dt>{Visual}[&quot;x]C</dt>
<dd><p>ビジュアル選擇された行を [レジスタ x に入れて] 削除し、插入を始めます。矩形ビジュアルモードでは少し動作が違ひます |<a href="visual_002etxt.html#v_005fb_005fC">v_b_C</a>|。
<span id="v_005fS"></span><span id="index-v_005fS"></span>
</p></dd>
<dt>{Visual}[&quot;x]S</dt>
<dd><p>ビジュアル選擇された行を [レジスタ x に入れて] 削除し、插入を始めます ({Visual} については |<a href="visual_002etxt.html#Visual_002dmode">Visual-mode</a>| を參照してください)。
<span id="v_005fR"></span><span id="index-v_005fR"></span>
</p></dd>
<dt>{Visual}[&quot;x]R</dt>
<dd><p>現在のところ {Visual}[&quot;x]S と同じです。次のバージョンでは動作が變はるかもしれません。
</p></dd>
</dl>

<blockquote>
<p><strong>Notes:</strong>
</p><ul>
<li> 插入モード、置換モードは &lt;Esc&gt; で終了できる
</li><li> これらのモードでの他の特殊文字については、「テキストの插入と置換」の章 |<a href="insert_002etxt.html#mode_002dins_002drepl">mode-ins-repl</a>| を參照
</li><li> [count] の效果は、Vim が插入モードや置換モードを拔けた後で發生する
</li><li> &rsquo;<samp>cpoptions</samp>&rsquo; がフラグ &rsquo;<var>$</var>&rsquo; を含んでゐて、變更が 1 行以內である場合、Vim は削除されるテキストを表示しつづけ、最後に削除された文字の位置に &rsquo;$&rsquo; を置く
</li></ul>
</blockquote>

<p>レジスタに關する說明は |<a href="#registers">registers</a>| を參照してください。
</p>
<p>置換モードは插入モードと似てゐますが、文字を打ち込むたびに 1 文字ずつ削除される點が違ひます。行の最後に達すると、Vim はそれ以降は (插入モードと同樣に) 文字を追加します。置換モードでは、バックスペースキーは (もしあれば) 以前のテキストを復元します (「テキストの插入と置換」の章 |<a href="insert_002etxt.html#mode_002dins_002drepl">mode-ins-repl</a>| を參照してください)。
</p>
<span id="cw"></span><span id="cW"></span><span id="index-cw"></span>
<span id="index-cW"></span>
<p>特別な場合: &quot;cw&quot; と &quot;cW&quot; は、カーソルが單語の上にあるとき、單語のあとにつづく空白を含めず、單語の末尾までを變更します (&quot;ce&quot; と &quot;cE&quot; と同じ働きをします)。これは Vim が &quot;cw&quot; を單語の變更 (change-word) として解釋し、また「單語」にはあとに續く空白は含まれないからです。
</p>
<p>{Vi: あとに空白が續く空白上での &quot;cw&quot; は、最初の空白のみを變更します。これは多分バグです。&quot;dw&quot; は全ての空白を削除するからです。とにかく、Vi 風に動作させるときには &rsquo;<samp>cpoptions</samp>&rsquo; にフラグ &rsquo;<var>w</var>&rsquo; を含めてください}
</p>
<p>&quot;cw&quot; の變更範圍に單語の後の空白も含めたいときは、次のマップを使つてください。
</p><pre class="verbatim">:map cw dwi
</pre><p>または &quot;caw&quot; を使ひます (|<a href="motion_002etxt.html#aw">aw</a>| を參照してください)。
</p>
<span id="g_t_003ac"></span><span id="g_t_003ach"></span><span id="g_t_003achange"></span><span id="index-_003ac"></span>
<span id="index-_003ach"></span>
<span id="index-_003achange"></span>
<dl compact="compact">
<dt>:{range}c[hange][!]</dt>
<dd><p>テキストを行單位で別のテキストと置き換へます。&quot;.&quot; のみを含む行を打ち込むことで置換を終了します。{range} なしの場合、現在行のみを變更します。
</p>
<p>[!] をつけると、このコマンドを實行するときだけ &rsquo;<samp>autoindent</samp>&rsquo; をトグルします。
</p></dd>
</dl>

<span id="simple_002dchange"></span><span id="index-simple_002dchange"></span>
<span id="index-Dan-Chun-naBian-Geng-"></span>
<span id="g_t3_002e-Dan-Chun-naBian-Geng-"></span><h3 class="section">3. 單純な變更</h3>

<span id="r"></span><span id="index-r"></span>
<dl compact="compact">
<dt>r{char}</dt>
<dd><p>カーソル下の文字を {char} に置き換へます。{char} が &lt;CR&gt; か &lt;NL&gt; のとき、文字は改行に置き換はります。文字を本當の &lt;CR&gt; に置き換へるには、<kbd>CTRL-V</kbd> &lt;CR&gt; を使ひます。<kbd>CTRL-V</kbd> &lt;NL&gt; は文字を &lt;Nul&gt; に置き換へます。
</p>
<p>{char} が <kbd>CTRL-E</kbd> または <kbd>CTRL-Y</kbd> のとき、ちやうど |<a href="insert_002etxt.html#i_005fCTRL_002dE">i_CTRL-E</a>| と |<a href="insert_002etxt.html#i_005fCTRL_002dY">i_CTRL-Y</a>| と同じやうに、下の行または上の行の文字が使はれます。回數も指定することができるため、&lsquo;10r&lt;C-E&gt;&lsquo; は下の行から 10 文字をコピーすることになります。
</p>
<p>[count] を指定すると、[count] 文字が [count] 個の {char} に置き換はります。しかし {char} が &lt;CR&gt; か &lt;NL&gt; の場合、插入される &lt;CR&gt; はただ 1 個です。&quot;5r&lt;CR&gt;&quot; は 5 文字を 1 個の改行に置き換へます。
</p>
<p>{char} が &lt;CR&gt; か &lt;NL&gt; のとき、Vim は自動インデントを行ひます。これは置き換へるべき文字を削除した後 &quot;i&lt;CR&gt;&lt;Esc&gt;&quot; を實行したやうな動作になります。
{char} はダイグラフ |<a href="#digraph_002darg">digraph-arg</a>| として入力することができます。|<a href="map_002etxt.html#g_t_003almap">:lmap</a>| マッピングは {char} に適用されます。插入モードでは、コマンド <kbd>CTRL-^</kbd> を使つてマッピングを切り替へられます |<a href="insert_002etxt.html#i_005fCTRL_002d_005e">i_CTRL-^</a>|。オプション &rsquo;<samp>encoding</samp>&rsquo; が Unicode の一種のときに合成文字を使ふことについては |<a href="mbyte_002etxt.html#utf_002d8_002dchar_002darg">utf-8-char-arg</a>| を參照してください。
</p>
<span id="gr"></span><span id="index-gr"></span>
</dd>
<dt>gr{char}</dt>
<dd><p>カーソル下の假想文字を {char} に置き換へます。このコマンドはファイル上の文字單位ではなく、畫面上の文字幅單位で置き換へます。詳細は |<a href="#gR">gR</a>| と |<a href="insert_002etxt.html#Virtual_002dReplace_002dmode">Virtual-Replace-mode</a>| を參照してください。|<a href="#r">r</a>| と同樣、回數を指定することができます。{char} の入力方法は |<a href="#r">r</a>| と同じです。
</p></dd>
</dl>

<span id="digraph_002darg"></span><span id="index-digraph_002darg"></span>
<p>|<a href="#r">r</a>| や |<a href="motion_002etxt.html#t">t</a>| 等のノーマルモードコマンドの引數は、1 個の文字です。オプション &rsquo;<samp>cpoptions</samp>&rsquo; がフラグ &rsquo;<var>D</var>&rsquo; を含まないとき、この文字はダイグラフ |<a href="digraph_002etxt.html#digraphs">digraphs</a>| と同樣に入力することができます。まづ <kbd>CTRL-K</kbd> を打ち込み、次にダイグラフの 2 文字を入力します。
</p>
<p>{Vim が |<a href="various_002etxt.html#g_t_002bdigraphs">+digraphs</a>| 機能付きでコンパイルされたときのみ有效}
</p>
<span id="case"></span><span id="index-case"></span>
<p>以下のコマンドは、アルファベットの大文字／小文字を切り替へます。現在有效なロケール |<a href="mbyte_002etxt.html#locale">locale</a>| が使はれます。|<a href="mlang_002etxt.html#g_t_003alanguage">:language</a>| を參照してください。環境變數 <code>LC_CTYPE</code> の値に影響されます。
</p>
<span id="g_t_007e"></span><span id="index-_007e"></span>
<dl compact="compact">
<dt>~</dt>
<dd><p>オプション &rsquo;<samp>tildeop</samp>&rsquo; がオフのとき: カーソル下の文字の大文字／小文字を切り替へ、カーソルを右に移動させます。[count] が指定されたときは、[count] 文字に作用します。
</p>
</dd>
<dt>~{motion}</dt>
<dd><p>オプション &rsquo;<samp>tildeop</samp>&rsquo; がオンのとき: {motion} のテキストの大文字／小文字を切り替へます。
</p>
<span id="g_007e"></span><span id="index-g_007e"></span>
</dd>
<dt>g~{motion}</dt>
<dd><p>{motion} のテキストの大文字／小文字を切り替へます。
</p>
<span id="g_007eg_007e"></span><span id="g_007e_007e"></span><span id="index-g_007eg_007e"></span>
<span id="index-g_007e_007e"></span>
</dd>
<dt>g~g~</dt>
<dt>g~~</dt>
<dd><p>現在行の大文字／小文字を切り替へます。
</p>
<span id="v_005f_007e"></span><span id="index-v_005f_007e"></span>
</dd>
<dt>{Visual}~</dt>
<dd><p>ビジュアル選擇されたテキストの大文字／小文字を切り替へます ({Visual} については |<a href="visual_002etxt.html#Visual_002dmode">Visual-mode</a>| を參照してください)。
</p>
<span id="v_005fU"></span><span id="index-v_005fU"></span>
</dd>
<dt>{Visual}U</dt>
<dd><p>ビジュアル選擇されたテキストを大文字にします ({Visual} については |<a href="visual_002etxt.html#Visual_002dmode">Visual-mode</a>| を參照してください)。
</p>
<span id="gU"></span><span id="uppercase"></span><span id="index-gU"></span>
<span id="index-uppercase"></span>
</dd>
<dt>gU{motion}</dt>
<dd><p>{motion} のテキストを大文字にします。
</p>
<p>例:
</p><pre class="verbatim">:map! &lt;C-F&gt; &lt;Esc&gt;gUcw`]a
</pre><p>これは插入モードで機能します: カーソルの前にある單語を大文字にするために <kbd>CTRL-F</kbd> を押します。小文字で單語を入力して、後から大文字にした方が樂です。
</p>

<span id="gUgU"></span><span id="gUU"></span><span id="index-gUgU"></span>
<span id="index-gUU"></span>
</dd>
<dt>gUgU</dt>
<dt>gUU</dt>
<dd><p>現在行を大文字にします。
</p>
<span id="v_005fu"></span><span id="index-v_005fu"></span>
</dd>
<dt>{Visual}u</dt>
<dd><p>ビジュアル選擇されたテキストを小文字にします ({Visual} については |<a href="visual_002etxt.html#Visual_002dmode">Visual-mode</a>| を參照してください)。
</p>
<span id="gu"></span><span id="lowercase"></span><span id="index-gu"></span>
<span id="index-lowercase"></span>
</dd>
<dt>gu{motion}</dt>
<dd><p>{motion} のテキストを小文字にします。
</p>
<span id="gugu"></span><span id="guu"></span><span id="index-gugu"></span>
<span id="index-guu"></span>
</dd>
<dt>gugu</dt>
<dt>guu</dt>
<dd><p>現在行を小文字にします。
</p>
<span id="g_003f"></span><span id="rot13"></span><span id="index-g_003f"></span>
<span id="index-rot13"></span>
</dd>
<dt>g?{motion}</dt>
<dd><p>{motion} のテキストを Rot13 エンコードします。
</p>
<span id="v_005fg_003f"></span><span id="index-v_005fg_003f"></span>
</dd>
<dt>{Visual}g?</dt>
<dd><p>ビジュアル選擇されたテキストを Rot13 エンコードします ({Visual} については |<a href="visual_002etxt.html#Visual_002dmode">Visual-mode</a>| を參照してください)。
</p>
<span id="g_003fg_003f"></span><span id="g_003f_003f"></span><span id="index-g_003fg_003f"></span>
<span id="index-g_003f_003f"></span>
</dd>
<dt>g?g?</dt>
<dt>g??</dt>
<dd><p>現在行を Rot13 エンコードします。
</p></dd>
</dl>

<p>各單語の最初の文字を大文字にします:
</p><pre class="verbatim">:s/\v&lt;(.)(\w*)/\u\1\L\2/g
</pre>

<span id="index-Jia-Suan-toJian-Suan--1"></span>
<span id="Jia-Suan-toJian-Suan--2"></span><h4 class="unnumberedsubsec">加算と減算</h4>
<span id="CTRL_002dA"></span><span id="index-CTRL_002dA"></span>
<dl compact="compact">
<dt><kbd>CTRL-A</kbd></dt>
<dd><p>カーソルの下または後の數字またはアルファベットに [count] を加へます。
</p>
<span id="v_005fCTRL_002dA"></span><span id="index-v_005fCTRL_002dA"></span>
</dd>
<dt>{Visual}<kbd>CTRL-A</kbd></dt>
<dd><p>ビジュアル選擇されたテキスト中の數字またはアルファベットに [count] を加へます。
</p>
<span id="v_005fg_005fCTRL_002dA"></span><span id="index-v_005fg_005fCTRL_002dA"></span>
</dd>
<dt>{Visual}g <kbd>CTRL-A</kbd></dt>
<dd><p>ビジュアル選擇されたテキスト中の數字またはアルファベットに [count] を加へます。複數行がビジュアル選擇されてゐる場合、各行は付加された [count] ごとに增やされます (そのため效果的に [count] ごとに增加する排列を作ることができます)。
例へば、このやうな數字のリストがあるとします:
</p><pre class="verbatim">1.
1.
1.
1.
</pre><p>2 番目の &quot;1.&quot; に移動し 3 行をビジュアル選擇してから g <kbd>CTRL-A</kbd> を押すと、このやうになります:
</p><pre class="verbatim">1.
2.
3.
4.
</pre>
<span id="CTRL_002dX"></span><span id="index-CTRL_002dX"></span>
</dd>
<dt><kbd>CTRL-X</kbd></dt>
<dd><p>カーソルの下または後の數字またはアルファベットから [count] を減じます。
</p>
<span id="v_005fCTRL_002dX"></span><span id="index-v_005fCTRL_002dX"></span>
</dd>
<dt>{Visual}<kbd>CTRL-X</kbd></dt>
<dd><p>ビジュアル選擇されたテキスト中の數字またはアルファベットから [count] を減じます。
</p>
<p>MS-Windows では、ビジュアルモードでのテキストの切り取りにマップされます |<a href="os_005fdos_002etxt.html#dos_002dstandard_002dmappings">dos-standard-mappings</a>|。このマッピングを無效にしたいなら、次のやうにします:
</p><pre class="verbatim">silent! vunmap &lt;C-X&gt;
</pre><span id="v_005fg_005fCTRL_002dX"></span><span id="index-v_005fg_005fCTRL_002dX"></span>
</dd>
<dt>{Visual}g <kbd>CTRL-X</kbd></dt>
<dd><p>ビジュアル選擇されたテキスト中の數字またはアルファベットから [count] を減じます。複數行がビジュアル選擇されてゐる場合、各値は付加された [count] ごとに減らされます (そのため效果的に [count] ごとに減少する排列を作ることができます)。
</p></dd>
</dl>

<p><kbd>CTRL-A</kbd> と <kbd>CTRL-X</kbd> が適用できるのは:
</p><ul>
<li> 符號付き及び符號なし 10 進數
</li><li> 符號なし 2 進數、8 進數および 16 進數
</li><li> アルファベット文字
</li></ul>

<p>&rsquo;<samp>nrformats</samp>&rsquo; オプションに依存してゐます:
</p><ul>
<li> &rsquo;<samp>nrformats</samp>&rsquo; に &quot;<var>bin</var>&quot; が含まれる時、Vim は &rsquo;0b&rsquo; または &rsquo;0B&rsquo; で始まる數値を 2 進數として扱ひます。
</li><li> &rsquo;<samp>nrformats</samp>&rsquo; が &quot;<var>octal</var>&quot; を含むときは、Vim は &rsquo;0&rsquo; で始まり、&rsquo;8&rsquo; や &rsquo;9&rsquo; を含まない數字を 8 進數として取り扱ひます。他の數は 10 進數とみなされ、マイナス符號が付いてもよい。カーソルが數の上にあれば、コマンドはその數に適用されます。さうでなければ、カーソルの右の數に適用されます。
</li><li> &rsquo;<samp>nrformats</samp>&rsquo; が &quot;<var>hex</var>&quot; を含むときは、Vim は &rsquo;0x&rsquo; か &rsquo;0X&rsquo; で始まる數を 16 進數として取り扱ひます。その數の最も右の文字が大文字であるか小文字であるかによつて、變更結果の 16 進數が大文字か小文字かが決定します。對象となつた數にアルファベットが含まれない場合、Vim は前囘の決定を使ひます。
</li><li> &rsquo;<samp>nrformats</samp>&rsquo; が &quot;<var>alpha</var>&quot; を含むときは、Vim はカーソル下または後のアルファベットを變更します。これはアルファベットのインデックスつきのリストを作るときに便利です。
</li></ul>

<p>10 進數では先頭の負の符號は增加/減少に對して考慮されます。しかし 2 進數、8 進數および 16 進數では考慮されません。符號を無視するには <kbd>CTRL-A</kbd> または <kbd>CTRL-X</kbd> を使ふ前に數字をビジュアル選擇します。
</p>
<p>ゼロから始まる數 (全ての 8 進數、16 進數を含む) に對して、Vim はできる限りその數の文字數を保たうとします。&quot;0077&quot; 上で <kbd>CTRL-A</kbd> を使ふと &quot;0100&quot; となり、&quot;0x100&quot; 上で <kbd>CTRL-X</kbd> を使ふと &quot;0x0ff&quot; となります。
</p>
<p>1 つだけ例外があります: ゼロで始まるが 8 進數でないとき (&rsquo;8&rsquo; や &rsquo;9&rsquo; を含んでゐるとき)、&rsquo;<samp>nrformats</samp>&rsquo; が &quot;<var>octal</var>&quot; を含んでゐるならば、結果が 8 進數とみなされないやうに、前方のゼロは削除されます。
</p>
<blockquote>
<p><strong>Note:</strong> <br>
&rsquo;<samp>nrformats</samp>&rsquo; が &quot;<var>octal</var>&quot; を含んでゐるとき、0 で始まる 10 進數は、8 進數と區別しづらいため、意圖しない結果になる可能性があることに注意してください。
</p></blockquote>

<blockquote>
<p><strong>Note:</strong> <br>
&rsquo;<samp>nrformats</samp>&rsquo; が &quot;<var>bin</var>&quot; を含んでゐるとき、&rsquo;0x&rsquo; または &rsquo;0X&rsquo; で始まる 2 進數は 16 進數として解釋されることに注意してください。これは &rsquo;0b&rsquo; が 16 進數の桁として有效だからです。
</p>
<p>{譯注: 0x0b0011 のやうな値のこと。}
</p></blockquote>

<p>コマンド <kbd>CTRL-A</kbd> はマクロ內でたいへん便利である。例: 番號付きリストを作るには、次の方法を使ひます。
</p>
<table>
<tr><td width="20%">1.</td><td width="80%">リストの最初の項目を作る。番號から始まるやうにすること</td></tr>
<tr><td width="20%">2. qa</td><td width="80%">- レジスタ &rsquo;a&rsquo; への記錄を始める</td></tr>
<tr><td width="20%">3. Y</td><td width="80%">- 項目をコピーする</td></tr>
<tr><td width="20%">4. p</td><td width="80%">- 項目のコピーを最初の項目の後に貼り付ける</td></tr>
<tr><td width="20%">5. CTRL-A</td><td width="80%">- 番號を增やす</td></tr>
<tr><td width="20%">6. q</td><td width="80%">- 記錄をストップする</td></tr>
<tr><td width="20%">7. &lt;count&gt;@a</td><td width="80%">- コピー、貼り付け、番號增加を &lt;count&gt; 回繰り返す</td></tr>
</table>


<span id="shift_002dleft_002dright"></span><span id="index-shift_002dleft_002dright"></span>
<span id="index-Xing-woZuo-You-nizurasu"></span>
<span id="Xing-woZuo-You-nizurasu"></span><h4 class="unnumberedsubsec">行を左右にずらす</h4>

<span id="g_t_003c"></span><span id="index-_003c"></span>
<dl compact="compact">
<dt>&lt;{motion}</dt>
<dd><p>{motion} の行を &rsquo;<samp>shiftwidth</samp>&rsquo; 1 個分左に移動します。
</p>
<p>もしも &rsquo;<samp>vartabstop</samp>&rsquo; 機能が有效で &rsquo;<samp>shiftwidth</samp>&rsquo; オプションが 0 に設定されてゐるなら、行中の最初の空白でない場所でインデントの總計が計算されます。
<span id="g_t_003c_003c"></span><span id="index-_003c_003c"></span>
</p></dd>
<dt>&lt;&lt;</dt>
<dd><p>[count] 行を &rsquo;<samp>shiftwidth</samp>&rsquo; 1 個分左に移動します。
</p>
<span id="v_005f_003c"></span><span id="index-v_005f_003c"></span>
</dd>
<dt>{Visual}[count]&lt;</dt>
<dd><p>ビジュアル選擇された行を、&rsquo;<samp>shiftwidth</samp>&rsquo; の [count] 個分左に移動します ({Visual} については |<a href="visual_002etxt.html#Visual_002dmode">Visual-mode</a>| を參照してください)。
</p>
<span id="g_t_003e"></span><span id="index-_003e"></span>
</dd>
<dt>&gt;{motion}</dt>
<dd><p>{motion} の行を &rsquo;<samp>shiftwidth</samp>&rsquo; 1 個分右に移動します。
</p>
<p>もしも &rsquo;<samp>vartabstop</samp>&rsquo; 機能が有效で &rsquo;<samp>shiftwidth</samp>&rsquo; オプションが 0 に設定されてゐるなら、行中の最初の空白でない場所でインデントの總計が計算されます。
<span id="g_t_003e_003e"></span><span id="index-_003e_003e"></span>
</p></dd>
<dt>&gt;&gt;</dt>
<dd><p>[count] 行を &rsquo;<samp>shiftwidth</samp>&rsquo; 1 個分右に移動します。
</p>
<span id="v_005f_003e"></span><span id="index-v_005f_003e"></span>
</dd>
<dt>{Visual}[count]&gt;</dt>
<dd><p>ビジュアル選擇された行を、&rsquo;<samp>shiftwidth</samp>&rsquo; の [count] 個分右に移動します ({Visual} については |<a href="visual_002etxt.html#Visual_002dmode">Visual-mode</a>| を參照してください)。
</p>
<span id="g_t_003a_003c"></span><span id="index-_003a_003c"></span>
</dd>
<dt>:[range]&lt;</dt>
<dd><p>[range] の行を、&rsquo;<samp>shiftwidth</samp>&rsquo; 1 個分左に移動します。&rsquo;<samp>shiftwidth</samp>&rsquo; の複數個分移動するには、&rsquo;&lt;&rsquo; を繰り返します。
</p>
</dd>
<dt>:[range]&lt; {count}</dt>
<dd><p>[range] (既定は現在行 |<a href="cmdline_002etxt.html#cmdline_002dranges">cmdline-ranges</a>|) から始まる {count} 行を &rsquo;<samp>shiftwidth</samp>&rsquo; 1 個分左に移動します。&rsquo;<samp>shiftwidth</samp>&rsquo; の複數個分移動するには、&rsquo;&lt;&rsquo; を繰り返します。
</p>
</dd>
<dt>:[range]le[ft] [indent]</dt>
<dd><p>[range] の行を左揃へします。行のインデントは [indent] (既定値は 0) に設定されます。
</p>
<span id="g_t_003a_003e"></span><span id="index-_003a_003e"></span>
</dd>
<dt>:[range]&gt; [flags]</dt>
<dd><p>[range] の行を、&rsquo;<samp>shiftwidth</samp>&rsquo; 1 個分右に移動します。&rsquo;<samp>shiftwidth</samp>&rsquo; の複數個分移動するには、&rsquo;&gt;&rsquo; を繰り返します。[flags] については |<a href="cmdline_002etxt.html#ex_002dflags">ex-flags</a>| を參照してください。
</p>
</dd>
<dt>:[range]&gt; {count} [flags]</dt>
<dd><p>[range] (既定は現在の行 |<a href="cmdline_002etxt.html#cmdline_002dranges">cmdline-ranges</a>|) から始まる {count} 行を、&rsquo;<samp>shiftwidth</samp>&rsquo; 1 個分右に移動します。&rsquo;<samp>shiftwidth</samp>&rsquo; の複數個分移動するには、&rsquo;&gt;&rsquo; を繰り返します。[flags] については |<a href="cmdline_002etxt.html#ex_002dflags">ex-flags</a>| を參照してください。
</p></dd>
</dl>

<p>コマンド &quot;&gt;&quot; と &quot;&lt;&quot; は、プログラムに含まれるインデントを變更するのに便利です。オプション &rsquo;<samp>shiftwidth</samp>&rsquo; には、これらのコマンドが插入、削除する空白の幅を設定します。&rsquo;<samp>shiftwidth</samp>&rsquo; は既定では 8 ですが、例へば 3 に設定して、インデントをもつと少なくすることもできます。左方向へのシフトは、インデントがなくなつたときに終了します。右方向へのシフトは、空行には適用されません。
</p>
<p>&rsquo;<samp>shiftround</samp>&rsquo; がオンのとき、インデントは &rsquo;<samp>shiftwidth</samp>&rsquo; の倍數に丸められます。
</p>
<p>&rsquo;<samp>shiftwidth</samp>&rsquo; がオンのとき、あるいは &rsquo;<samp>cindent</samp>&rsquo; がオンで &rsquo;<samp>cinkeys</samp>&rsquo; が値 0 の &rsquo;<var>#</var>&rsquo; を含むとき、右方向へのシフトは &rsquo;#&rsquo; で始まる行に適用されません (これらの行は、行の最初に位置すべき C プリプロセッサー指令であると考へられます)。これは &rsquo;<samp>cino</samp>&rsquo; オプションで變更することができます。|<a href="indent_002etxt.html#cino_002d_0023">cino-#</a>| を參照してください。
</p>
<p>&rsquo;<samp>expandtab</samp>&rsquo; がオフ (既定値) のとき、Vim はインデントにできる限り多くの &lt;Tab&gt; を使ひます。&quot;&gt;&gt;&lt;&lt;&quot; によつて、空白のみで構成されたインデントを、&lt;Tab&gt; (と必要ならばいくつかの空白) で構成されたインデントに置換することができます。&rsquo;<samp>expandtab</samp>&rsquo; がオンのときは、Vim は空白のみを使ひます。&quot;&gt;&gt;&lt;&lt;&quot; によつて、インデント內の &lt;Tab&gt; を空白に置換することができます (あるいは &lsquo;<code>:retab!</code>&lsquo; を使ひます)。
</p>
<p>行を &rsquo;<samp>shiftwidth</samp>&rsquo; の複數個分移動するには、ビジュアルモードかコマンド &lsquo;<code>:</code>&lsquo; を使ひます。
</p>
<p>例:
</p><pre class="verbatim">Vjj4&gt;       3 行をインデント 4 個分右に移動
:&lt;&lt;&lt;        現在の行をインデント 3 個分左に移動
:&gt;&gt; 5       5 行をインデント 2 個分右へ移動
:5&gt;&gt;        5 行目をインデント 2 個分右に移動
</pre>
<span id="complex_002dchange"></span><span id="index-complex_002dchange"></span>
<span id="index-Fu-Za-naBian-Geng-"></span>
<span id="g_t4_002e-Fu-Za-naBian-Geng-"></span><h3 class="section">4. 複雜な變更</h3>

<span id="filter"></span><span id="index-filter"></span>
<span id="index-huirutakomando"></span>
<span id="g_t4_002e1-huirutakomando"></span><h4 class="unnumberedsubsec">4.1 フィルタコマンド</h4>

<p>フィルタとは、テキストを標準入力から受け取り、何らかの變更を加へ、標準出力に送るプログラムのことです。以下のコマンドにより、テキストの一部をフィルタにかけることができます。フィルタの例としては、行をアルファベット順にソートする &quot;sort&quot;、C のプログラムを整形する &quot;indent&quot; (ただし、フィルタ機能を持つたバージョンが必要。全てのバージョンでできるわけではありません) などがあります。
</p>
<p>オプション &rsquo;<samp>shell</samp>&rsquo; は、Vim がフィルタコマンドを實行するときに使ふシェルを指定します (&rsquo;<samp>shelltype</samp>&rsquo; も參照してください)。フィルタコマンドはコマンド &quot;<code>.</code>&quot; で繰り返すことができます。Vim は &lsquo;<code>:!</code>&lsquo; の後の (&rsquo;&quot;&rsquo; で始まる) コメントを認識しません。
</p>
<span id="g_t_0021"></span><span id="index-_0021"></span>
<dl compact="compact">
<dt>!{motion}{filter}</dt>
<dd><p>{motion} のテキストを外部プログラム {filter} でフィルタ處理します。
</p>
<span id="g_t_0021_0021"></span><span id="index-_0021_0021"></span>
</dd>
<dt>!!{filter}</dt>
<dd><p>[count] 行を外部プログラム {filter} でフィルタ處理します。
</p>
<span id="v_005f_0021"></span><span id="index-v_005f_0021"></span>
</dd>
<dt>{Visual}!{filter}</dt>
<dd><p>ビジュアル選擇された行を外部プログラム {filter} でフィルタ處理します ({Visual} については |<a href="visual_002etxt.html#Visual_002dmode">Visual-mode</a>| を參照してください)。
</p>
<span id="g_t_003arange_0021"></span><span id="index-_003arange_0021"></span>
</dd>
<dt>:{range}![!]{filter} [!][arg]</dt>
<dd><p>{range} 行を外部プログラム {filter} でフィルタ處理します。{filter} の後ろには &rsquo;!&rsquo; を付けてもよい。これは最後に實行されたコマンドに置き換へられます。さらに [arg] を付けると、それがコマンドに付け加へられます。
</p>
<p>Vim はフィルタコマンドの出力を一時ファイルに保存し、そのファイルをバッファに讀み込みます |<a href="#tempfile">tempfile</a>|。フィルタの出力を一時ファイルにリダイレクトするときはオプション &rsquo;<samp>shellredir</samp>&rsquo; が使はれます。Unix では &rsquo;<samp>shellredir</samp>&rsquo; がオフのとき、可能ならばパイプが使はれます。
</p>
<p>&rsquo;<samp>cpoptions</samp>&rsquo; に &rsquo;<var>R</var>&rsquo; フラグが含まれるとき、フィルタ處理された行のマークは削除されます。|<a href="motion_002etxt.html#g_t_003akeepmarks">:keepmarks</a>| コマンドを使ふと削除されません。例:
</p><pre class="verbatim">:keepmarks '&lt;,'&gt;!sort
</pre><p>フィルタ處理のあと行數が少なくなつてゐた場合、すでにない行を指してゐるマークは削除されます。
</p>
<span id="g_t_003d"></span><span id="index-_003d"></span>
</dd>
<dt>={motion}</dt>
<dd><p>{motion} の行を、オプション &rsquo;<samp>equalprg</samp>&rsquo; で指定された外部プログラムでフィルタ處理します。&rsquo;<samp>equalprg</samp>&rsquo; が空のとき (これが既定) は、組み込みの整形機能の |<a href="indent_002etxt.html#C_002dindenting">C-indenting</a>| と |<a href="options_002etxt.html#g_t_0027lisp_0027">'lisp'</a>| を使ひます。しかし &rsquo;<samp>indentexpr</samp>&rsquo; が空でないときは、それが使はれます |<a href="indent_002etxt.html#indent_002dexpression">indent-expression</a>|。Vim が內部フォーマット機能なしでコンパイルされてゐるときは、最後の手段として &quot;indent&quot; プログラムが使はれます。
</p>
<span id="g_t_003d_003d"></span><span id="index-_003d_003d"></span>
</dd>
<dt>==</dt>
<dd><p>[count] 行を ={motion} と同樣にフィルタ處理します。
</p>
<span id="v_005f_003d"></span><span id="index-v_005f_003d"></span>
</dd>
<dt>{Visual}=</dt>
<dd><p>ビジュアル選擇されたテキストを ={motion} と同樣にフィルタ處理します。
</p></dd>
</dl>


<span id="tempfile"></span><span id="setuid"></span><span id="index-tempfile"></span>
<span id="index-setuid"></span>
<p>フィルタリング、diff の生成、tempname() などを行ふときには、一時ファイルが作成されます。Unix ではこのファイルはプライベートな (自分だけがアクセスできる) ディレクトリに置かれます。セキュリティ上の問題 (symlink attack や他の人があなたのファイルを讀むなど) を避けるためです。
</p>
<p>Vim が終了するとき、そのディレクトリと中にあるファイルは自動的に削除されます。Vim に setuid ビットが立つてゐるとこれが問題を引き起こすことがあります。一時ファイルは setuid されたユーザーが所有するのに對し、フィルタコマンドは元のユーザーとして動作するためです。
MS-DOS と OS/2 では、次のディレクトリのうち最初に利用可能なものが使はれます: $TMP, $TEMP, c:\TMP, c:\TEMP。
</p>
<p>Unix におけるディレクトリのリストは: $TMPDIR, /tmp, current-dir, $HOME。
</p>
<p>MS-Windows ではシステム函數 GetTempFileName() が使はれます。
</p>
<p>他のシステムではライブラリ函數 tmpnam() が使はれます。
</p>


<span id="g_t_003asubstitute"></span><span id="index-_003asubstitute"></span>
<span id="index-Zhi-Huan--1"></span>
<span id="g_t4_002e2-Zhi-Huan-"></span><h4 class="unnumberedsubsec">4.2 置換</h4>
<span id="g_t_003as"></span><span id="g_t_003asu"></span><span id="index-_003as"></span>
<span id="index-_003asu"></span>
<dl compact="compact">
<dt>:[range]s[ubstitute]/{pattern}/{string}/[flags] [count]</dt>
<dd><p>[range] の各行で {pattern} のマッチを {string} に置き換へます。{pattern} については |<a href="pattern_002etxt.html#pattern">pattern</a>| を參照してください。{string} は普通の文字列でもよいし、特別な指定方法を使つてもよい。|<a href="#sub_002dreplace_002dspecial">sub-replace-special</a>| を參照してください。
[range] と [count] が指定されないときは現在行內でのみ置換を行ひます。[count] が指定されるときは[range] の最終行から數へて[count] 行で置換を行ひます。[range] が指定されないときは現在行から開始します。
<span id="E939"></span><span id="index-E939"></span>
[count] は正の數でなければなりません。|<a href="cmdline_002etxt.html#cmdline_002dranges">cmdline-ranges</a>| も參照してください。
</p>
<p>フラグについては |<a href="#g_t_003as_005fflags">:s_flags</a>| を參照してください。
</p>
<span id="g_t_003a_0026"></span><span id="index-_003a_0026"></span>
</dd>
<dt>:[range]s[ubstitute] [flags] [count] または</dt>
<dt>:[range]&amp;[&amp;][flags] [count]</dt>
<dd><p>最後の置換を同じパターンかつ同じ置換文字列で、フラグをつけずに繰り返します。フラグを追加することもできます (|<a href="#g_t_003as_005fflags">:s_flags</a>| を參照してください)。
</p><blockquote>
<p><strong>Note:</strong> <br>
&lsquo;<code>:substitute</code>&lsquo; の後ではフラグ &rsquo;&amp;&rsquo; は使へないことに注意してください。パターンの區切り文字だと認識されてしまひます。&lsquo;<code>:substitute</code>&lsquo; とフラグ &rsquo;c&rsquo;, &rsquo;g&rsquo;, &rsquo;i&rsquo;, &rsquo;I&rsquo;, &rsquo;r&rsquo; の閒の空白は必要不可缺ではありません。しかしスクリプト內では、混亂しないやうに空白を入れておくのはよい考へです。
</p></blockquote>

<span id="g_t_003a_007e"></span><span id="index-_003a_007e"></span>
</dd>
<dt>:[range]~[&amp;][flags] [count]</dt>
<dd><p>最後の置換を同じ置換文字列で、最後の檢索パターン {譯注: &quot;/&quot; で使つたもの} に對して繰り返します。&lsquo;<code>:&amp;r</code>&lsquo; と似てゐます。フラグについては |<a href="#g_t_003as_005fflags">:s_flags</a>| を參照してください。
</p>
<span id="g_t_0026"></span><span id="index-_0026"></span>
</dd>
<dt>&amp;</dt>
<dd><p>&lsquo;<code>:s</code>&lsquo; と同じ (最後の置換を繰り返します)。
</p><blockquote>
<p><strong>Note:</strong> <br>
同じフラグが使はれるわけではないことに注意してください。實際の動作は違ふかもしれません。フラグも同じにするには &lsquo;<code>:&amp;&amp;</code>&lsquo; を使つてください。
</p></blockquote>

<span id="g_0026"></span><span id="index-g_0026"></span>
</dd>
<dt>g&amp;</dt>
<dd><p>&lsquo;<code>:%s//~/&amp;</code>&lsquo; と同じ (全ての行に對し、最後の檢索パターンで、同じフラグで最後の置換を繰り返します)。例へば、&lsquo;<code>:s/pattern/repl/flags</code>&lsquo; と置換を實行し、次に &lsquo;<code>/search</code>&lsquo; と檢索を實行すると、&lsquo;<code>g&amp;</code>&lsquo; は &lsquo;<code>:%s/search/repl/flags</code>&lsquo; を實行します。
</p>
<p>覺え方: 「グローバル (global &ndash;全體的な) 置換」
</p>
<span id="g_t_003asnomagic"></span><span id="g_t_003asno"></span><span id="index-_003asnomagic"></span>
<span id="index-_003asno"></span>
</dd>
<dt>:[range]sno[magic] ...</dt>
<dd><p>&lsquo;<code>:substitute</code>&lsquo; と同じですが、常に &rsquo;<samp>nomagic</samp>&rsquo; を使ひます。
</p>
<span id="g_t_003asmagic"></span><span id="g_t_003asm"></span><span id="index-_003asmagic"></span>
<span id="index-_003asm"></span>
</dd>
<dt>:[range]sm[agic] ...</dt>
<dd><p>&lsquo;<code>:substitute</code>&lsquo; と同じですが、常に &rsquo;<samp>magic</samp>&rsquo; を使ひます。
</p></dd>
</dl>

<span id="g_t_003as_005fflags"></span><span id="index-_003as_005fflags"></span>
<span id="index-Zhi-Huan-komandodeShi-eruhuragu"></span>
<span id="Zhi-Huan-komandodeShi-eruhuragu_003a"></span><h4 class="unnumberedsubsubsec">置換コマンドで使へるフラグ:</h4>

<span id="g_t_003a_0026_0026"></span><span id="index-_003a_0026_0026"></span>
<dl compact="compact">
<dt>[&amp;]</dt>
<dd><p>先頭に指定しなければなりません。前囘の置換コマンドと同じフラグを使ひます。例:
</p><pre class="verbatim">:&amp;&amp;
:s/this/that/&amp;
</pre><blockquote>
<p><strong>Note:</strong> <br>
コマンド &lsquo;:s&lsquo; と &lsquo;:&amp;&lsquo; では、前囘と同じフラグは使はれません。
</p></blockquote>

<span id="g_t_003as_005fc"></span><span id="index-_003as_005fc"></span>
</dd>
<dt>[c]</dt>
<dd><p>置換前に每囘確認します。マッチしてゐる文字列を (强調表示グループ |<a href="syntax_002etxt.html#hl_002dIncSearch">hl-IncSearch</a>| で) 强調表示します。確認を求められたら、ユーザーは以下のやうに應答します。
</p><table>
<tr><td width="20%">&rsquo;y&rsquo;</td><td width="80%">そのマッチを置換する (&quot;yes&quot;)</td></tr>
<tr><td width="20%">&rsquo;l&rsquo;</td><td width="80%">そのマッチを置換し、置換を終了する (&quot;last&quot;)</td></tr>
<tr><td width="20%">&rsquo;n&rsquo;</td><td width="80%">そのマッチを置換せず、次に移る (&quot;no&quot;)</td></tr>
<tr><td width="20%">&lt;Esc&gt;</td><td width="80%">置換を終了する</td></tr>
<tr><td width="20%">&rsquo;a&rsquo;</td><td width="80%">そのマッチと、以降の全てのマッチを置換する</td></tr>
<tr><td width="20%">&rsquo;q&rsquo;</td><td width="80%">置換を終了する</td></tr>
<tr><td width="20%">CTRL-E</td><td width="80%">畫面を上にスクロールする</td></tr>
<tr><td width="20%">CTRL-Y</td><td width="80%">畫面を下にスクロールする</td></tr>
</table>
<p>オプション &rsquo;<samp>edcompatible</samp>&rsquo; がオンのとき、Vim はフラグ [c] を記憶し、それが指定される度にオン／オフを切り替へますが、新しい檢索パターンが使はれるとリセットします。
</p>
<span id="g_t_003as_005fe"></span><span id="index-_003as_005fe"></span>
</dd>
<dt>[e]</dt>
<dd><p>檢索パターンが何もマッチしなかつたとき、エラーメッセージを表示しません。特にマッピング內ではエラーが發生しなかつたかのやうに續行されます。これは「パターンは見つかりませんでした」のエラーによるマッピングの中斷を防ぐのに使へます。しかし以下のエラーの發生は抑制されません。
</p><div class="display">
<pre class="display">「正規表現は文字で區切ることができません」
「\\ の後は / か ? か &amp; でなければなりません」
「正規表現置換がまだ實行されてゐません」
「餘分な文字が後ろにあります」
「(割込まれました)」
</pre></div>

<span id="g_t_003as_005fg"></span><span id="index-_003as_005fg"></span>
</dd>
<dt>[g]</dt>
<dd><p>行中の全てのマッチを置換します。このフラグなしだと、各行の 1 個目のマッチのみが置換されます。オプション &rsquo;<samp>edcompatible</samp>&rsquo; がオンのとき、Vim はこのフラグを記憶し、指定される度にオン／オフを切り替へますが、新しい檢索パターンが使はれるとリセットします。&rsquo;<samp>gdefault</samp>&rsquo; がオンのときは、このフラグはオンが既定値になり、フラグ [g] を指定したときにはオフになります。
</p>
<span id="g_t_003as_005fi"></span><span id="index-_003as_005fi"></span>
</dd>
<dt>[i]</dt>
<dd><p>パターンの大文字／小文字の區別をしません。オプション &rsquo;<samp>ignorecase</samp>&rsquo; と &rsquo;<samp>smartcase</samp>&rsquo; は使はれません。
</p>
<span id="g_t_003as_005fI"></span><span id="index-_003as_005fI"></span>
</dd>
<dt>[I]</dt>
<dd><p>パターンの大文字／小文字を區別します。オプション &rsquo;<samp>ignorecase</samp>&rsquo; と &rsquo;<samp>smartcase</samp>&rsquo; は使はれません。
</p>
<span id="g_t_003as_005fn"></span><span id="index-_003as_005fn"></span>
</dd>
<dt>[n]</dt>
<dd><p>マッチの個數を表示し、實際には置換を行ひません。フラグ [c] は無視されます。&rsquo;<samp>report</samp>&rsquo; が 0 のときと同じやうにマッチが表示されます。何個あるか調べるときに便利です |<a href="tips_002etxt.html#count_002ditems">count-items</a>|。
</p>
<p>\= |<a href="#sub_002dreplace_002dexpression">sub-replace-expression</a>| が使はれたときは、式はそれぞれのマッチに對してサンドボックス (|<a href="eval_002etxt.html#sandbox">sandbox</a>|) で實行されます。
</p>
<span id="g_t_003as_005fp"></span><span id="index-_003as_005fp"></span>
</dd>
<dt>[p]</dt>
<dd><p>最後に置換を行つた行を表示します。
</p>
<span id="g_t_003as_005f_0023"></span><span id="index-_003as_005f_0023"></span>
</dd>
<dt>[#]</dt>
<dd><p>[p] と同じ。行番號をつけます。
</p>
<span id="g_t_003as_005fl"></span><span id="index-_003as_005fl"></span>
</dd>
<dt>[l]</dt>
<dd><p>[p] と同じですが、|<a href="various_002etxt.html#g_t_003alist">:list</a>| のやうに表示します。
</p>
<span id="g_t_003as_005fr"></span><span id="index-_003as_005fr"></span>
</dd>
<dt>[r]</dt>
<dd><p>引數のない &lsquo;<code>:&amp;</code>&lsquo; か &lsquo;<code>:s</code>&lsquo; との連携でのみ有效。&lsquo;<code>:&amp;r</code>&lsquo; は &lsquo;<code>:~</code>&lsquo; と同樣に動作します。檢索パターンが空のとき、最後の置換コマンドや &lsquo;<code>:global</code>&lsquo; でのパターンではなく、最後の檢索パターンを使用します。最後に檢索パターンを使用したコマンドが置換や &lsquo;<code>:global</code>&lsquo; だつたときは、何もしません。最後のコマンドが &quot;/&quot; のやうな檢索コマンドだつたときは、そのコマンドの檢索パターンを使ひます。
引數付きの &lsquo;<code>:s</code>&lsquo; では、すでにさう動作するやうになつてゐました。
</p><pre class="verbatim">:s/blue/red/
/green
:s//red/  または  :~  または  :&amp;r
</pre><p>最後のコマンドは &quot;green&quot; を &quot;red&quot; に置き換へます。
</p><pre class="verbatim">:s/blue/red/
/green
:&amp;
</pre><p>最後のコマンドは &quot;blue&quot; を &quot;red&quot; に置き換へます。
</p></dd>
</dl>

<blockquote>
<p><strong>Note:</strong> <br>
パターンに &rsquo;<samp>magic</samp>&rsquo; が適用されるかどうかを變更するフラグはないことに注意してください。代はりに違ふコマンド {譯注: |<a href="#g_t_003asnomagic">:snomagic</a>|} または |<a href="pattern_002etxt.html#g_t_002f_005cv">/\v</a>| などを使ひます。これは、パターン解釋を飛ばすことでのみフラグを認識できますが、その一方でパターン解釋を飛ばすには &rsquo;<samp>magic</samp>&rsquo; の適用狀態が知られてゐる必要があるためです。Catch 22! {譯注: どうにもならないといふ意味}
</p></blockquote>

<p>置換コマンドで {pattern} が空のときは、最後に使はれた置換コマンドまたはコマンド &lsquo;<code>:global</code>&lsquo; のパターンが使はれます。それが無い場合は、直前の檢索パターンがあればそれが使はれます。フラグ [r] を指定すると、最後の置換、&lsquo;<code>:global</code>&lsquo;、または檢索コマンドのパターンが使はれます。
</p>
<p>{string} を省略した場合は、空文字列を指定したのと同じ結果になります。すなはち、マッチしたパターンが削除されます。{pattern} の後のセパレータも省略することができます。例:
</p><pre class="verbatim">:%s/TESTING
</pre><p>これは、全行から &quot;TESTING&quot; を削除する例です。ただし、1 つの行に 2 個以上あつても 1 個しか削除されません。
</p>
<p>Vi との互換性のため、これら 2 つの例外が許されます。
</p><ul>
<li> &quot;\/{string}/&quot; と &quot;\?{string}?&quot; は &quot;//{string}/r&quot; と同樣の效果。
</li><li> &quot;\&amp;{string}&amp;&quot; は &quot;//{string}/&quot; と同樣の效果。
</li></ul>
<span id="E146"></span><span id="index-E146"></span>
<p>&rsquo;/&rsquo; でパターンと置換文字列を圍む代はりに、英數字や &rsquo;\&rsquo;, &rsquo;&quot;&rsquo;, &rsquo;|&rsquo; 以外であれば、他の 1 バイト文字を使ふことができます。これは檢索パターンや置換文字列に &rsquo;/&rsquo; を含む場合に有益です。例:
</p><pre class="verbatim">:s+/+//+
</pre>
<p>パターンの定義については |<a href="pattern_002etxt.html#pattern">pattern</a>| を參照してください。矩形ビジュアルモードで、置換をその領域內だけで行ひたい場合は、パターンに |<a href="pattern_002etxt.html#g_t_002f_005c_0025V">/\%V</a>| を含めます。これを使はない場合は、置換は常に行全體に對して行はれます。
</p>
<span id="sub_002dreplace_002dspecial"></span><span id="g_t_003as_005c_003d"></span><span id="index-sub_002dreplace_002dspecial"></span>
<span id="index-_003as_005c_003d"></span>
<p>{string} が &quot;\=&quot; で始まるときは、それは式として評價されます。|<a href="#sub_002dreplace_002dexpression">sub-replace-expression</a>| を參照してください。複雜な置換や特殊な文字を使ふことができます。
</p>
<p>さうでなければ、{string} の中のこれらの文字は特別な意味を持ちます:
<span id="g_t_003as_0025"></span><span id="index-_003as_0025"></span>
&rsquo;<samp>cpoptions</samp>&rsquo; に &rsquo;<var>/</var>&rsquo; が含まれてゐる場合、{string} が &quot;%&quot; に等しいなら、前の置換コマンドの {string} が使はれます。|<a href="options_002etxt.html#cpo_002d_002f">cpo-/</a>| を參照してください。
</p>
<table>
<thead><tr><th width="15%">magic</th><th width="15%"></th><th width="15%">nomagic</th><th width="55%">作用
<span id="s_002f_005c_0026"></span><span id="index-s_002f_005c_0026"></span></th></tr></thead>
<tr><td width="15%">&amp;</td><td width="15%"></td><td width="15%">\&amp;</td><td width="55%">マッチしたパターン全體に置き換はる</td></tr>
<tr><td width="15%">\&amp;</td><td width="15%"></td><td width="15%">&amp;</td><td width="55%">&rsquo;&amp;&rsquo; に置き換はる
<span id="g_t_005c0"></span><span id="s_002f_005c0"></span><span id="index-_005c0"></span>
<span id="index-s_002f_005c0"></span></td></tr>
<tr><td width="15%"></td><td width="15%">\0</td><td width="15%"></td><td width="55%">マッチしたパターン全體に置き換はる
<span id="s_002f_005c1"></span><span id="index-s_002f_005c1"></span></td></tr>
<tr><td width="15%"></td><td width="15%">\1</td><td width="15%"></td><td width="55%">1 番目の () 內のマッチしたパターンに置き換はる
<span id="s_002f_005c2"></span><span id="index-s_002f_005c2"></span></td></tr>
<tr><td width="15%"></td><td width="15%">\2</td><td width="15%"></td><td width="55%">2 番目の () 內のマッチしたパターンに置き換はる
<span id="s_002f_005c3"></span><span id="index-s_002f_005c3"></span></td></tr>
<tr><td width="15%"></td><td width="15%">..</td><td width="15%"></td><td width="55%">..
<span id="s_002f_005c9"></span><span id="index-s_002f_005c9"></span></td></tr>
<tr><td width="15%"></td><td width="15%">\9</td><td width="15%"></td><td width="55%">9 番目の () 內のマッチしたパターンに置き換はる
<span id="s_007e"></span><span id="index-s_007e"></span></td></tr>
<tr><td width="15%">~</td><td width="15%"></td><td width="15%">\~</td><td width="55%">前囘の置換の {string} に置き換はる
<span id="s_002f_005c_007e"></span><span id="index-s_002f_005c_007e"></span></td></tr>
<tr><td width="15%">\~</td><td width="15%"></td><td width="15%">~</td><td width="55%">&rsquo;~&rsquo; に置き換はる
<span id="s_002f_005cu"></span><span id="index-s_002f_005cu"></span></td></tr>
<tr><td width="15%"></td><td width="15%">\u</td><td width="15%"></td><td width="55%">次の文字が大文字になる
<span id="s_002f_005cU"></span><span id="index-s_002f_005cU"></span></td></tr>
<tr><td width="15%"></td><td width="15%">\U</td><td width="15%"></td><td width="55%">後に續く文字が (\E まで) 大文字になる
<span id="s_002f_005cl"></span><span id="index-s_002f_005cl"></span></td></tr>
<tr><td width="15%"></td><td width="15%">\l</td><td width="15%"></td><td width="55%">次の文字が小文字になる
<span id="s_002f_005cL"></span><span id="index-s_002f_005cL"></span></td></tr>
<tr><td width="15%"></td><td width="15%">\L</td><td width="15%"></td><td width="55%">後に續く文字が (\E まで) 小文字になる
<span id="s_002f_005ce"></span><span id="index-s_002f_005ce"></span></td></tr>
<tr><td width="15%"></td><td width="15%">\e</td><td width="15%"></td><td width="55%">\u, \U, \l, \L の終はり
<blockquote>
<p><strong>Note:</strong> <br>
&lt;Esc&gt; の意味ではありません！
</p></blockquote>
<span id="s_002f_005cE"></span><span id="index-s_002f_005cE"></span></td></tr>
<tr><td width="15%"></td><td width="15%">\E</td><td width="15%"></td><td width="55%">\u, \U, \l, \L の終はり
<span id="s_003cCR_003e"></span><span id="index-s_003cCR_003e"></span></td></tr>
<tr><td width="15%"></td><td width="15%">&lt;CR&gt;</td><td width="15%"></td><td width="55%">ここで行を 2 つに分ける (&lt;CR&gt; は <kbd>CTRL-V</kbd> <code class="tt-key">&lt;Enter&gt;</code> と入力する)
<span id="s_002f_005cr"></span><span id="index-s_002f_005cr"></span></td></tr>
<tr><td width="15%"></td><td width="15%">\r</td><td width="15%"></td><td width="55%">同上
<span id="s_002f_005c_003cCR_003e"></span><span id="index-s_002f_005c_003cCR_003e"></span></td></tr>
<tr><td width="15%"></td><td width="15%">\&lt;CR&gt;</td><td width="15%"></td><td width="55%">キャリッジリターン (CTRL-M) の插入 (&lt;CR&gt; は <kbd>CTRL-V</kbd> <code class="tt-key">&lt;Enter&gt;</code> と入力する)
<span id="s_002f_005cn"></span><span id="index-s_002f_005cn"></span></td></tr>
<tr><td width="15%"></td><td width="15%">\n</td><td width="15%"></td><td width="55%">&lt;NL&gt; (ファイル內では &lt;NUL&gt;) の插入 (改行を「起こさない」)
<span id="s_002f_005cb"></span><span id="index-s_002f_005cb"></span></td></tr>
<tr><td width="15%"></td><td width="15%">\b</td><td width="15%"></td><td width="55%">&lt;BS&gt; の插入
<span id="s_002f_005ct"></span><span id="index-s_002f_005ct"></span></td></tr>
<tr><td width="15%"></td><td width="15%">\t</td><td width="15%"></td><td width="55%">&lt;Tab&gt; の插入
<span id="s_002f_005c_005c"></span><span id="index-s_002f_005c_005c"></span></td></tr>
<tr><td width="15%"></td><td width="15%">\\</td><td width="15%"></td><td width="55%">&rsquo;\&rsquo; の插入</td></tr>
<tr><td width="15%"></td><td width="15%">\x</td><td width="15%"></td><td width="55%">(&rsquo;x&rsquo; は上で說明されてゐない文字) 將來の擴張用に豫約濟み</td></tr>
</table>

<p>特別な意味は |<a href="eval_002etxt.html#substitute_0028_0029">substitute()</a>| の 第 3 引數 {sub} でも使へますが、いくつか例外があります:
</p><ul>
<li> % は &rsquo;<samp>cpoptions</samp>&rsquo; に關係なくパーセント文字を插入します。
</li><li> &rsquo;<samp>magic</samp>&rsquo; に關係なく magic は常にオンです。
</li><li> ~ はチルダをそのまま插入します。
</li><li> &lt;CR&gt; と \r はキャリッジリターン (CTRL-M) を插入します。
</li><li> \&lt;CR&gt; は特別な意味を持ちません。單に \x の一種として扱はれあす。
</li></ul>

<p>例:
</p><pre class="verbatim">:s/a\|b/xxx\0xxx/g             &quot;a b&quot;      を &quot;xxxaxxx xxxbxxx&quot;  に置換
:s/\([abc]\)\([efg]\)/\2\1/g   &quot;af fa bg&quot; を &quot;fa fa gb&quot;         に置換
:s/abcde/abc^Mde/              &quot;abcde&quot;    を &quot;abc&quot;, &quot;de&quot; (2 行) に置換
:s/$/^V^M/                     &quot;abcde&quot;    を &quot;abcde^M&quot;          に置換
:s/\w\+/\u\0/g                 &quot;bla bla&quot;  を &quot;Bla Bla&quot;          に置換
:s/\w\+/\L\u\0/g               &quot;BLA bla&quot;  を &quot;Bla Bla&quot;          に置換
</pre>
<blockquote>
<p><strong>Note:</strong> <br>
&quot;\L\u&quot; を使ふと單語の最初の文字をキャピタライズできます。これは Vi や古い Vim とは互換性がなことに注意してください。それらの古い環境では &quot;\u&quot; は &quot;\L&quot; をキャンセルします。&quot;\U\l&quot; も同じです。
</p></blockquote>

<blockquote>
<p><strong>Note:</strong> <br>
以前のバージョンでは <kbd>CTRL-V</kbd> が特別に扱はれてゐました。これは Vi 互換ではないので變更されました。代はりに &rsquo;\&rsquo; を使つてください。
</p></blockquote>

<table>
<thead><tr><th width="33%">コマンド</th><th width="33%">テキスト</th><th width="33%">置換結果</th></tr></thead>
<tr><td width="33%">:s/aa/a^Ma/</td><td width="33%">aa</td><td width="33%">a&lt;line-break&gt;a</td></tr>
<tr><td width="33%">:s/aa/a\^Ma/</td><td width="33%">aa</td><td width="33%">a^Ma</td></tr>
<tr><td width="33%">:s/aa/a\\^Ma/</td><td width="33%">aa</td><td width="33%">a\&lt;line-break&gt;a</td></tr>
</table>

<p>(ここで ^M を使ふには <kbd>CTRL-V</kbd> <code class="tt-key">&lt;CR&gt;</code> と打ち込んでください)
</p>
<p>&quot;\1&quot;, &quot;\2&quot; などの番號付けは、パターン內でどの &quot;\(&quot; が最初に來るかによつて決まります (左から右の順)。括弧でくくられたグループが複數回マッチするときは、最後のものが &quot;\1&quot;, &quot;\2&quot; 等に使はれます。例:
</p><pre class="verbatim">:s/\(\(a[a-d] \)*\)/\2/      &quot;aa ab x&quot; を &quot;ab x&quot; に置換
</pre><p>&quot;\2&quot; は、&quot;\(a[a-d] \)&quot; を參照します。このパターンはまず &quot;aa &quot; にマッチし、次に &quot;ab &quot; にマッチします。
</p>
<p>\([ab]\)\|\([cd]\) のやうに括弧を &rsquo;|&rsquo; と連携して使つてゐるとき、1 番目か 2 番目のどちらかの括弧內のパターンにはマッチしません、すなはち、\1 か \2 のどちらかは空になります。例:
</p><pre class="verbatim">:s/\([ab]\)\|\([cd]\)/\1x/g   &quot;a b c d&quot; を &quot;ax bx x x&quot; に置換
</pre>
<span id="g_t_003asc"></span><span id="g_t_003asce"></span><span id="g_t_003ascg"></span><span id="g_t_003asci"></span><span id="g_t_003ascI"></span><span id="g_t_003ascl"></span><span id="g_t_003ascp"></span><span id="g_t_003asg"></span><span id="g_t_003asgc"></span><span id="g_t_003asge"></span><span id="g_t_003asgi"></span><span id="g_t_003asgI"></span><span id="g_t_003asgl"></span><span id="g_t_003asgn"></span><span id="g_t_003asgp"></span><span id="g_t_003asgr"></span><span id="g_t_003asI"></span><span id="g_t_003asi"></span><span id="g_t_003asic"></span><span id="g_t_003asIc"></span><span id="g_t_003asie"></span><span id="g_t_003asIe"></span><span id="g_t_003asIg"></span><span id="g_t_003asIl"></span><span id="g_t_003asin"></span><span id="g_t_003asIn"></span><span id="g_t_003asIp"></span><span id="g_t_003asip"></span><span id="g_t_003asIr"></span><span id="g_t_003asir"></span><span id="g_t_003asr"></span><span id="g_t_003asrc"></span><span id="g_t_003asrg"></span><span id="g_t_003asri"></span><span id="g_t_003asrI"></span><span id="g_t_003asrl"></span><span id="g_t_003asrn"></span><span id="g_t_003asrp"></span><span id="index-_003asc"></span>
<span id="index-_003asce"></span>
<span id="index-_003ascg"></span>
<span id="index-_003asci"></span>
<span id="index-_003ascI"></span>
<span id="index-_003ascl"></span>
<span id="index-_003ascp"></span>
<span id="index-_003asg"></span>
<span id="index-_003asgc"></span>
<span id="index-_003asge"></span>
<span id="index-_003asgi"></span>
<span id="index-_003asgI"></span>
<span id="index-_003asgl"></span>
<span id="index-_003asgn"></span>
<span id="index-_003asgp"></span>
<span id="index-_003asgr"></span>
<span id="index-_003asI"></span>
<span id="index-_003asi"></span>
<span id="index-_003asic"></span>
<span id="index-_003asIc"></span>
<span id="index-_003asie"></span>
<span id="index-_003asIe"></span>
<span id="index-_003asIg"></span>
<span id="index-_003asIl"></span>
<span id="index-_003asin"></span>
<span id="index-_003asIn"></span>
<span id="index-_003asIp"></span>
<span id="index-_003asip"></span>
<span id="index-_003asIr"></span>
<span id="index-_003asir"></span>
<span id="index-_003asr"></span>
<span id="index-_003asrc"></span>
<span id="index-_003asrg"></span>
<span id="index-_003asri"></span>
<span id="index-_003asrI"></span>
<span id="index-_003asrl"></span>
<span id="index-_003asrn"></span>
<span id="index-_003asrp"></span>
<span id="index-2-WenZi-mosikuha-3-WenZi-no-_003asubstitute-komando"></span>
<span id="g_t2-WenZi-mosikuha-3-WenZi-no-_003asubstitute-komando"></span><h4 class="unnumberedsubsubsec">2 文字もしくは 3 文字の :substitute コマンド</h4>

<p>:substitute コマンド一覽
</p><pre class="verbatim">|      c    e    g    i    I    n    p    l    r
| c  :sc  :sce :scg :sci :scI :scn :scp :scl  ---
| e
| g  :sgc :sge :sg  :sgi :sgI :sgn :sgp :sgl :sgr
| i  :sic :sie  --- :si  :siI :sin :sip  --- :sir
| I  :sIc :sIe :sIg :sIi :sI  :sIn :sIp :sIl :sIr
| n
| p
| l
| r  :src  --- :srg :sri :srI :srn :srp :srl :sr
</pre>
<p>例外:
</p><pre class="verbatim">:scr  is  `:scriptnames`
:se   is  `:set`
:sig  is  `:sign`
:sil  is  `:silent`
:sn   is  `:snext`
:sp   is  `:split`
:sl   is  `:sleep`
:sre  is  `:srewind`
</pre>

<span id="sub_002dreplace_002dexpression"></span><span id="index-sub_002dreplace_002dexpression"></span>
<span id="index-Shi-deZhi-Huan-suru"></span>
<span id="Shi-deZhi-Huan-suru"></span><h4 class="unnumberedsubsubsec">式で置換する</h4>
<span id="sub_002dreplace_002d_005c_003d"></span><span id="s_002f_005c_003d"></span><span id="index-sub_002dreplace_002d_005c_003d"></span>
<span id="index-s_002f_005c_003d"></span>
<p>置換文字列が &quot;\=&quot; で始まるとき、それ以降の文字列は式として解釋されます。これは再歸的に機能しません。
</p>
<p>&quot;&lt;CR&gt;&quot; 以外の文字の特別な意味 |<a href="#sub_002dreplace_002dspecial">sub-replace-special</a>| は無效になります。&lt;NL&gt; 文字は改行として使はれるのでダブルクォート文字列 &quot;\n&quot; で改行を入れることができます。實際の &lt;NL&gt; 文字 (ファイルにおける NUL 文字) を插入するにはバックスラッシュを前置します。
</p>
<p>&quot;\=&quot; 表記は |<a href="eval_002etxt.html#substitute_0028_0029">substitute()</a>| 函數の第 3 引數 {sub} でも使ふことができます。その場合、|<a href="#sub_002dreplace_002dspecial">sub-replace-special</a>| で說明されてゐる文字は特別な意味を持たなくなります。特に、&lt;CR&gt; と &lt;NL&gt; は改行として解釋されるのではなく、そのままキャリッジリターンとニューラインとして解釋されます。
</p>
<p>結果が |<a href="eval_002etxt.html#List">List</a>| のときはその要素が改行を區切りとして連結されます。よつて要素がそれぞれ行となります。ただし要素が改行を含んでゐる場合は除きます。
</p>
<p>|<a href="eval_002etxt.html#submatch_0028_0029">submatch()</a>| 函數を使用して一致するテキストを取得することができます。マッチしたテキストの全體は &quot;submatch(0)&quot; で參照することができます。1 番目の () 內でマッチしたテキストは &quot;submatch(1)&quot; で參照することができます。以降の () 內でマッチしたテキストも同樣に參照することができます。
</p>
<blockquote>
<p><strong>注意:</strong> <br>
正規表現の區切り文字が expression 內に現れてはいけません！區切りには &quot;@&quot; や &quot;:&quot; を使ふよう檢討してください。Expression の結果に區切り文字が現れても問題はありません。
</p></blockquote>

<p>例:
</p><pre class="verbatim">:s@\n@\=&quot;\r&quot; . expand(&quot;$HOME&quot;) . &quot;\r&quot;@
</pre><p>かうすると置換を行つた行の下に、環境變數 $HOME の値を含む新しい行が插入されます。
</p><pre class="verbatim">s/E/\=&quot;\&lt;Char-0x20ac&gt;&quot;/g
</pre><p>これは文字 &rsquo;E&rsquo; をユーロ記號で置換します。詳しくは |<a href="map_002etxt.html#g_t_003cChar_002d_003e">&lt;Char-&gt;</a>| を參照してください。
</p>

<span id="search_002dreplace"></span><span id="index-search_002dreplace"></span>
<span id="index-Jian-Suo-toZhi-Huan-"></span>
<span id="g_t4_002e3-Jian-Suo-toZhi-Huan-"></span><h4 class="unnumberedsubsec">4.3 檢索と置換</h4>

<span id="g_t_003apro"></span><span id="g_t_003apromptfind"></span><span id="index-_003apro"></span>
<span id="index-_003apromptfind"></span>
<dl compact="compact">
<dt>:promptf[ind] [string]</dt>
<dd><p>檢索ダイアログを表示する。 [string] が與へられると、それが初期檢索文字列になる。
</p>
<p>{Vim の Win32 版、Motif 版、GTK の GUI 版、MacVim 版のみ}
</p>
<span id="g_t_003apromptr"></span><span id="g_t_003apromptrepl"></span><span id="index-_003apromptr"></span>
<span id="index-_003apromptrepl"></span>
</dd>
<dt>:promptr[epl] [string]</dt>
<dd><p>檢索／置換ダイアログを表示する。 [string] が與へられると、それが初期檢索文字列になる。
</p>
<p>{Vim の Win32 版、Motif 版、GTK の GUI 版、MacVim 版のみ}
</p></dd>
</dl>


<span id="change_002dtabs"></span><span id="index-change_002dtabs"></span>
<span id="index-tabunoBian-Huan-"></span>
<span id="g_t4_002e4-tabunoBian-Huan-"></span><h4 class="unnumberedsubsec">4.4 タブの變換</h4>
<span id="g_t_003aret"></span><span id="g_t_003aretab"></span><span id="g_t_003aretab_0021"></span><span id="index-_003aret"></span>
<span id="index-_003aretab"></span>
<span id="index-_003aretab_0021"></span>
<dl compact="compact">
<dt>:[range]ret[ab][!] [new_tabstop]</dt>
<dd><p>新たに指定されたタブストップ (タブ幅) に基づき、&lt;Tab&gt; を含む空白の連續を全て、新しい空白と &lt;Tab&gt; の列に置き換へる。新たなタブストップの指定がないか 0 が指定されたときは、Vim はオプション &rsquo;<samp>tabstop</samp>&rsquo; の現在の値を使用する。
</p>
<p>&rsquo;<samp>tabstop</samp>&rsquo; の現在の値は、既存のタブの幅を計るために常に使用される。&rsquo;!&rsquo; を付けると、Vim は通常の空白のみの列も、適切なタブに置き換へる。&rsquo;<samp>expandtab</samp>&rsquo; がオンのとき、Vim は全てのタブを適切な數の空白に置き換へる。
</p>
<p>このコマンドは &rsquo;<samp>tabstop</samp>&rsquo; を新たに指定された値に設定する {譯注: この事實は重要である}。ファイル全體に適用されたときは (それが既定の動作)、ファイルの見かけに變化が起こることはないはずだ。
</p><blockquote>
<p><strong>注意:</strong> <br>
このコマンドは C プログラム中の文字列內部にある &lt;Tab&gt; 文字も修正する。これを避けるためには、プログラム內では &quot;\t&quot; を使ふとよい (さうでなくても、これはよい習慣である)。
</p></blockquote>
</dd>
</dl>

<p>&lsquo;<code>:retab!</code>&lsquo; も空白の連續を &lt;Tab&gt; 文字に變へてしまひ、printf() の出力をめちやくちやにするかもしれない。
</p>
<p>|<a href="various_002etxt.html#g_t_002bvartabs">+vartabs</a>| 機能が有效な場合、單一の tabstop の代はりにコンマで分けられたタブ幅のリストが使用されるだらう。リストのそれぞれの値は 1 つの tabstop の幅を意味するが、最後の値だけは後續するすべての tabstop に適用される。
</p>
<span id="retab_002dexample"></span><span id="index-retab_002dexample"></span>
<p>タブストップが 8 で保存され、タブストップが 4 で編輯されたファイルを編輯するために autocommand と &quot;<code>:retab</code>&quot; を使ふ例。警告: 文字列內の空白は變はつてしまふことがある！オプション &rsquo;<samp>softtabstop</samp>&rsquo; も參照。
</p>
<pre class="verbatim">:auto BufReadPost   *.xx    retab! 4
:auto BufWritePre   *.xx    retab! 8
:auto BufWritePost  *.xx    retab! 4
:auto BufNewFile    *.xx    set ts=4
</pre>
<span id="copy_002dmove"></span><span id="index-copy_002dmove"></span>
<span id="index-tekisutonokopitoYi-Dong-"></span>
<span id="g_t5_002e-tekisutonokopitoYi-Dong-"></span><h3 class="section">5. テキストのコピーと移動</h3>

<span id="quote"></span><span id="index-quote"></span>
<dl compact="compact">
<dt>&quot;{a-zA-Z0-9.%#:-&quot;}</dt>
<dd><p>續く操作 (削除、コピー、貼り付け) にレジスタ {a-zA-Z0-9.%#:-&quot;} を使ふ (削除、コピーでは大文字を使ふことでレジスタに追記できる) ({.%#:} は貼り付けにのみ使用可能)。
</p>
<span id="g_t_003areg"></span><span id="g_t_003aregisters"></span><span id="index-_003areg"></span>
<span id="index-_003aregisters"></span>
</dd>
<dt>:reg[isters]</dt>
<dd><p>全ての名前付きレジスタおよび番號付きレジスタのタイプと內容を表示します。レジスタが |<a href="various_002etxt.html#g_t_003aredir">:redir</a>| の書き込み先になつてゐる場合はそのレジスタは表示されません。
</p><table>
<tr><td>タイプは次のいづれか:</td></tr>
<tr><td>&quot;c&quot;</td><td>|<a href="motion_002etxt.html#characterwise">characterwise</a>| のテキスト</td></tr>
<tr><td>&quot;l&quot;</td><td>|<a href="motion_002etxt.html#linewise">linewise</a>| のテキスト</td></tr>
<tr><td>&quot;b&quot;</td><td>|<a href="visual_002etxt.html#blockwise_002dvisual">blockwise-visual</a>| のテキスト</td></tr>
</table>


</dd>
<dt>:reg[isters] {arg}</dt>
<dd><p>{arg} に指定された名前付きレジスタおよび番號付きレジスタを表示する。例:
</p><pre class="verbatim">:reg 1a
</pre><p>レジスタ &rsquo;1&rsquo; と &rsquo;a&rsquo; が表示される。{arg} の中では空白を用ゐてよい。
</p>
<span id="g_t_003adi"></span><span id="g_t_003adisplay"></span><span id="index-_003adi"></span>
<span id="index-_003adisplay"></span>
</dd>
<dt>:di[splay] [arg]</dt>
<dd><p>:registers と同じ。
</p>
<span id="y"></span><span id="yank"></span><span id="index-y"></span>
<span id="index-yank"></span>
</dd>
<dt>[&quot;x]y{motion}</dt>
<dd><p>{motion} のテキストを [レジスタ x に] コピーする。コピーされるテキストがないとき (例へば 1 桁目で &quot;y0&quot; を行ふ)、オプション &rsquo;<samp>cpoptions</samp>&rsquo; がフラグ &rsquo;<var>E</var>&rsquo; を含んでゐるならエラーになる。
</p>
<span id="yy"></span><span id="index-yy"></span>
</dd>
<dt>[&quot;x]yy</dt>
<dd><p>[count] 行を [レジスタ x に] コピーする (行單位 |<a href="motion_002etxt.html#linewise">linewise</a>|)。
</p>
<span id="Y"></span><span id="index-Y"></span>
</dd>
<dt>[&quot;x]Y</dt>
<dd><p>[count] 行を [レジスタ x に] コピーする (&quot;yy&quot; と同義、行單位 |<a href="motion_002etxt.html#linewise">linewise</a>|)。&quot;Y&quot; でカーソル位置から行の終はりまでコピーしたいときは (この方が論理的と言へるが、Vi 互換ではない) &quot;:map Y y$&quot; を使ふ。
</p>
<span id="v_005fy"></span><span id="index-v_005fy"></span>
</dd>
<dt>{Visual}[&quot;x]y</dt>
<dd><p>ビジュアル選擇されたテキストを [レジスタ x に] コピーする ({Visual} については |<a href="visual_002etxt.html#Visual_002dmode">Visual-mode</a>| を參照)。
</p>
<span id="v_005fY"></span><span id="index-v_005fY"></span>
</dd>
<dt>{Visual}[&quot;x]Y</dt>
<dd><p>ビジュアル選擇された行を [レジスタ x に] コピーする ({Visual} については |<a href="visual_002etxt.html#Visual_002dmode">Visual-mode</a>| を參照)。
</p>
<span id="g_t_003ay"></span><span id="g_t_003ayank"></span><span id="E850"></span><span id="index-_003ay"></span>
<span id="index-_003ayank"></span>
<span id="index-E850"></span>
</dd>
<dt>:[range]y[ank] [x]</dt>
<dd><p>[range] の行を [レジスタ x に] コピーする。&quot;* レジスタと &quot;+ レジスタへのコピーは |<a href="various_002etxt.html#g_t_002bclipboard">+clipboard</a>| 機能が有效な場合のみ可能。
</p>
</dd>
<dt>:[range]y[ank] [x] {count}</dt>
<dd><p>[range] の最後の行 (省略時は現在行 |<a href="cmdline_002etxt.html#cmdline_002dranges">cmdline-ranges</a>|) から數へて {count} 行を [レジスタ x に] コピーする。
</p>
<span id="p"></span><span id="put"></span><span id="E353"></span><span id="index-p"></span>
<span id="index-put"></span>
<span id="index-E353"></span>
</dd>
<dt>[&quot;x]p</dt>
<dd><p>カーソルの後に、テキストを [count] 回 [レジスタ x から] 貼り付ける。
</p>
<span id="P"></span><span id="index-P"></span>
</dd>
<dt>[&quot;x]P</dt>
<dd><p>カーソルの前に、テキストを [count] 回 [レジスタ x から] 貼り付ける。
</p>
<span id="g_t_003cMiddleMouse_003e"></span><span id="index-_003cMiddleMouse_003e"></span>
</dd>
<dt>[&quot;x]&lt;MiddleMouse&gt;</dt>
<dd><p>カーソルの前に、テキストを [count] 回 [レジスタ x から] 貼り付ける。レジスタ指定がない場合は &quot;* が使はれる。カーソルは插入したテキストの末尾に置かれる。マウスは &rsquo;mouse&rsquo; が &rsquo;n&rsquo; か &rsquo;a&rsquo; を含むときのみ使へる。
もしあなたがスクロールホイールを持つてゐて意圖せずにテキストを貼り付けてしまふのなら、次のマッピングでマウスの眞ん中のボタンを無效化できる。
</p><pre class="verbatim">:map &lt;MiddleMouse&gt; &lt;Nop&gt;
:imap &lt;MiddleMouse&gt; &lt;Nop&gt;
</pre><p>複數クリックも無效にしたいなら |<a href="term_002etxt.html#double_002dclick">double-click</a>| も參照のこと。
</p>
<span id="gp"></span><span id="index-gp"></span>
</dd>
<dt>[&quot;x]gp</dt>
<dd><p>&quot;p&quot; と似てゐるが、カーソルは插入したテキストの直後に置かれる。
</p>
<span id="gP"></span><span id="index-gP"></span>
</dd>
<dt>[&quot;x]gP</dt>
<dd><p>&quot;P&quot; と似てゐるが、カーソルは插入したテキストの直後に置かれる。
</p>
<span id="g_t_003apu"></span><span id="g_t_003aput"></span><span id="index-_003apu"></span>
<span id="index-_003aput"></span>
</dd>
<dt>:[line]pu[t] [x]</dt>
<dd><p>[line] 行目 (省略時は現在行) の後にテキストを [レジスタ x から] コピーする。このコマンドは常に行單位 |<a href="motion_002etxt.html#linewise">linewise</a>| の動作をするので、コピーされたブロックを新しい行として插入するときに使へる。
</p>
<p>レジスタが指定されてゐないときのレジスタは &rsquo;<samp>cb</samp>&rsquo; オプションに依存する。&rsquo;<samp>cb</samp>&rsquo; が &quot;<var>unnamedplus</var>&quot; を含むときは + レジスタ |<a href="gui_005fx11_002etxt.html#quoteplus">quoteplus</a>| からペーストする。さうではなく、&rsquo;<samp>cb</samp>&rsquo; が &quot;<var>unnamed</var>&quot; を含むときは * レジスタ |<a href="gui_002etxt.html#quotestar">quotestar</a>| からペーストする。さうでなければ、無名レジスタ |<a href="#quote_005fquote">quote_quote</a>| からペーストする。
</p>
<p>レジスタには &rsquo;=&rsquo; に續けて式を指定することもできる。コマンドの末尾までが式として評價される。文字 &rsquo;|&rsquo; と &rsquo;&quot;&rsquo; がコマンドの末尾として解釋されないやうにするには、それらをエスケープする {譯注: 前に &rsquo;\&rsquo; を置く} 必要がある。例:
</p><pre class="verbatim">:put ='path' . \&quot;,/test\&quot;
</pre><p>&rsquo;=&rsquo; の後に式がないときは前囘の式が使はれる。それはコマンド &quot;:dis =&quot; で見ることができる。
</p>
</dd>
<dt>:[line]pu[t]! [x]</dt>
<dd><p>[line] 行目 (省略時は現在行) の前にテキストを [レジスタ x から] コピーする。
</p>
<span id="g_t_005dp"></span><span id="g_t_005d_003cMiddleMouse_003e"></span><span id="index-_005dp"></span>
<span id="index-_005d_003cMiddleMouse_003e"></span>
</dd>
<dt>[&quot;x]]p または</dt>
<dt>[&quot;x]]&lt;MiddleMouse&gt;</dt>
<dd><p>&quot;p&quot; と似てゐるが、現在行に合はせてインデントが調整される。マウスは、&rsquo;<samp>mouse</samp>&rsquo; が &rsquo;<var>n</var>&rsquo; か &rsquo;<var>a</var>&rsquo; を含むときだけ使へる。
</p>
<span id="g_t_005bP"></span><span id="g_t_005dP"></span><span id="g_t_005bp"></span><span id="g_t_005b_003cMiddleMouse_003e"></span><span id="index-_005bP"></span>
<span id="index-_005dP"></span>
<span id="index-_005bp"></span>
<span id="index-_005b_003cMiddleMouse_003e"></span>
</dd>
<dt>[&quot;x][P または</dt>
<dt>[&quot;x]]P または</dt>
<dt>[&quot;x][p または</dt>
<dt>[&quot;x][&lt;MiddleMouse&gt;</dt>
<dd><p>&quot;P&quot; と似てゐるが、現在行に合はせてインデントが調整される。マウスは、&rsquo;<samp>mouse</samp>&rsquo; が &rsquo;<var>n</var>&rsquo; か &rsquo;<var>a</var>&rsquo; を含むときだけ使へる。
</p></dd>
</dl>

<p>これらのコマンドを使つて、ある場所から別の場所へテキストをコピーできる。まづコピー、削除または變更コマンドを使つて、テキストをレジスタに蓄へる。そしてレジスタの內容を、貼り付けコマンドで文章中に插入する。これらのコマンドで、あるファイルから別のファイルへテキストを移動させることもできる。Vim はバッファを切り替へても、全てのレジスタの內容を保つてゐるからである (コマンド <kbd>CTRL-^</kbd> は、2 個のバッファを素早く切り替へられる)。
</p>
<span id="linewise_002dregister"></span><span id="characterwise_002dregister"></span><span id="index-linewise_002dregister"></span>
<span id="index-characterwise_002dregister"></span>
<p>貼り付けコマンド (&quot;:put&quot; 以外) は、&quot;.&quot; で繰り返したり、アンドゥできる。テキストをレジスタに蓄へるのに使はれたコマンドが行單位 |<a href="motion_002etxt.html#linewise">linewise</a>| のものだつたら、テキストはカーソルのある行の次の行 (&quot;p&quot; のとき) や前の行 (&quot;P&quot; のとき) に貼り付けられる。さうでなければ、テキストはカーソルの後 (&quot;p&quot; のとき) や前 (&quot;P&quot; のとき) に插入される。コマンド &quot;<code>:put</code>&quot; を使つたときは、テキストは常に次の行へ插入される。
</p>
<p>&quot;xp&quot; といふコマンド列で、カーソル上の文字と次の文字との入れ替へができる。現在行と次の行との入れ替へには、コマンド列 &quot;ddp&quot; を使ふ。(カーソルが單語の前の空白の上にあるとき) 次の單語とその次の單語との入れ替へには、コマンド列 &quot;deep&quot; を使ふ。貼り付けコマンドを使つた後には、コマンド &quot;&rsquo;]&quot; か &quot;&lsquo;]&quot; で插入された行の終はりに移動でき、コマンド &quot;&rsquo;[&quot; か &quot;&lsquo;[&quot; で插入された行の最初に移動できる。
</p>
<span id="put_002dVisual_002dmode"></span><span id="v_005fp"></span><span id="v_005fP"></span><span id="index-put_002dVisual_002dmode"></span>
<span id="index-v_005fp"></span>
<span id="index-v_005fP"></span>
<p>ビジュアルモードで |<a href="#p">p</a>| や |<a href="#P">P</a>| 等の貼り付けコマンドを使つたとき、Vim は選擇されたテキストをレジスタの中身で置き換へようとする。これがうまく動作するかどうかは、選擇領域の種類とレジスタ內のテキストの種類による。矩形選擇では、ブロックのサイズと、選擇領域の角が既存の文字上にあるかどうかにもよる。(實裝上の詳細: 實際の動作は、まづレジスタの中身を選擇領域の後に貼り付け、その後で選擇領域を削除するやうになつてゐる)
</p>
<p>それまで選擇されてゐたテキストが無名レジスタに保存される。同じテキストを複數のビジュアル選擇領域にプットしたい場合は、ほかのレジスタを使ふ必要がある。例へば、コピーしたいテキストをヤンクして、選擇したテキストを &quot;0p で置き換へる。これを好きなだけ繰り返す。このとき、無名レジスタはプットするたびに變はる。
</p>
<p>矩形ビジュアルモードで一行のみをヤンクしたとき、それをビジュアル選擇した範圍に貼り付けると、選擇範圍にその一行が貼り付けされる (つまり貼り付けた行のブロックによつて矩形選擇範圍が置換される)。
</p>
<span id="blockwise_002dregister"></span><span id="index-blockwise_002dregister"></span>
<p>矩形ビジュアルモードで、レジスタにテキストを蓄へるコマンドを使ふと、テキストのブロックはカーソルの前 (&quot;P&quot; のとき) または後 (&quot;p&quot; のとき) から、現在行と引き續く行にわたつて、插入される。テキストのブロック全體は同じ列から始まるやうに插入される。そのため插入されたテキストはコピーや削除されたときと同じ形を保つてゐる。
</p>
<p>Vim は、このやうにするために &lt;Tab&gt; を空白で置き換へることがある。しかし、テキストのブロックの幅が &lt;Tab&gt; の幅の整數倍でなく、さらに插入されたブロックの後のテキストが &lt;Tab&gt; を含むとき、列揃へがをかしくなることがある。
</p>
<blockquote>
<p><strong>Note:</strong> <br>
文字單位のコピーコマンドの後、コピーされたテキストの中でバッファの先頭に一番近い文字の上にカーソルが置かれることに注意。つまり &quot;yl&quot; ではカーソルは動かないが、&quot;yh&quot; ではカーソルは 1 文字左に動く。
</p>
<p>理論的說明:	Viでは、後方移動を伴つたコマンド &quot;y&quot; ではコピーされたテキストの先頭にカーソルを移動させないことがあつた。これは再表示が省かれたためである。Vim では Posix に定められた通り、常に先頭の文字にカーソルを移動させる。
</p>
<p>行單位のコピーコマンドではカーソルは選擇の最初の行に置かれるが、カラムは變更されない。なのでその位置はコピーされた最初の文字の上ではないかもしれない。
</p></blockquote>

<span id="registers"></span><span id="g_t_007bregister_007d"></span><span id="E354"></span><span id="index-registers"></span>
<span id="index-_007bregister_007d"></span>
<span id="index-E354"></span>
<span id="index-rezisutaniha-10-Zhong-Lei-aru"></span>
<span id="rezisutaniha-10-Zhong-Lei-aru_003a"></span><h4 class="unnumberedsubsec">レジスタには 10 種類ある:</h4>
<ol>
<li> 無名レジスタ &quot;&quot;
</li><li> 10 個の番號付きレジスタ &quot;0 から &quot;9
</li><li> 小削除用レジスタ &quot;-
</li><li> 26 個の名前付きレジスタ &quot;a から &quot;z または &quot;A から &quot;Z
</li><li> 3 個の讀み取り專用レジスタ &quot;: と &quot;. と &quot;%
</li><li> 代替バッファ用レジスタ &quot;#
</li><li> expression 用レジスタ &quot;=
</li><li> 選擇領域用レジスタ &quot;* と &quot;+ と &quot;~
</li><li> 消去專用レジスタ &quot;_
</li><li> 最終檢索パターン用レジスタ &quot;/
</li></ol>

<span id="quote_005fquote"></span><span id="quotequote"></span><span id="index-quote_005fquote"></span>
<span id="index-quotequote"></span>
<span id="index-Wu-Ming-rezisuta-_0022_0022"></span>
<span id="g_t1_002e-Wu-Ming-rezisuta-_0022_0022"></span><h4 class="unnumberedsubsubsec">1. 無名レジスタ &quot;&quot;</h4>
<p>このレジスタには、コマンド &quot;d&quot;, &quot;c&quot;, &quot;s&quot;, &quot;x&quot; 等で削除されたテキストや、&quot;y&quot; 等のコピーコマンドでコピーされたテキストが蓄へられる。特定のレジスタが指定されてゐてもゐなくても關係ない (例へば &quot;xdd でもこれが使はれる)。つまり無名レジスタは最後に使はれたレジスタを指してゐると考へられる。よつて、大文字レジスタを使つて名前つきレジスタにテキストを追加したときも、無名レジスタの中身は、その名前つきレジスタと同じになる。
</p>
<p>例外はレジスタ &rsquo;_&rsquo; である。&quot;_dd は、削除されたテキストをどのレジスタにも蓄へない。
無名レジスタの中身は、レジスタを指定しない貼り付けコマンド (p や P) で使ふことができる。加へて、このレジスタは &rsquo;&quot;&rsquo; といふ名前で使ふことができる。これは、使ふときには二重引用符 &rsquo;&quot;&rsquo; を 2 個打ち込むといふことである。レジスタ &quot;&quot; に對する書き込みはレジスタ &quot;0 にも書き込むことになる。
</p>
<p>{Vi ではレジスタの內容はファイルを變更するときに失はれ、&rsquo;&quot;&rsquo; もない}
</p>
<span id="quote_005fnumber"></span><span id="quote0"></span><span id="quote1"></span><span id="quote2"></span><span id="quote3"></span><span id="quote4"></span><span id="quote9"></span><span id="index-quote_005fnumber"></span>
<span id="index-quote0"></span>
<span id="index-quote1"></span>
<span id="index-quote2"></span>
<span id="index-quote3"></span>
<span id="index-quote4"></span>
<span id="index-quote9"></span>
<span id="index-Fan-Hao-Fu-kirezisuta-_00220-kara-_00229"></span>
<span id="g_t2_002e-Fan-Hao-Fu-kirezisuta-_00220-kara-_00229"></span><h4 class="unnumberedsubsubsec">2. 番號付きレジスタ &quot;0 から &quot;9</h4>
<p>これらのレジスタには、コピーや削除コマンドによつてテキストが蓄へられる。番號付きレジスタの 0 には、一番最近にコピーしたテキストが蓄へられるが、コピーの際に [&quot;x] として別のレジスタ名を指定したときは、これには蓄へられない。
番號付きレジスタ 1 には、一番最近に削除したり變更したテキストが蓄へられるが、コマンドに別のレジスタ名を指定したり、削除や變更したテキストが 1 行以下だつたりしたときは、これには蓄へられない (そのときは小削除用レジスタが使はれる)。例外は、以下の移動コマンドと削除コマンドを組み合はせたときである。|<a href="motion_002etxt.html#g_t_0025">%</a>|, |<a href="motion_002etxt.html#g_t_005c_0028">(</a>|, |<a href="motion_002etxt.html#g_t_005c_0029">)</a>|, |<a href="motion_002etxt.html#g_t_0060">`</a>|, |<a href="pattern_002etxt.html#g_t_002f">/</a>|, |<a href="pattern_002etxt.html#g_t_003f">?</a>|, |<a href="pattern_002etxt.html#n">n</a>|, |<a href="pattern_002etxt.html#N">N</a>|, |<a href="motion_002etxt.html#g_t_007b">{</a>|, |<a href="motion_002etxt.html#g_t_007d">}</a>|。このときは必ずレジスタ &quot;1 が使はれる (これは Vi 互換の動作である)。削除や變更したテキストが 1 行以下だつたときは、レジスタ &quot;- も使はれる。
</p><blockquote>
<p><strong>Note:</strong> <br>
これらの文字はマップ可能である。例: |<a href="motion_002etxt.html#g_t_0025">%</a>| は matchit プラグインによつてマップされてゐる。
</p></blockquote>
<p>削除や變更が行はれるたびに、レジスタ 1 の內容はレジスタ 2 に、レジスタ 2 の內容はレジスタ 3 に、といふ風にずれていく。レジスタ 9 の內容は失はれる。
</p>
<p>{Vi では番號付きレジスタの內容はファイルを變更する際に失はれる。レジスタ 0 はない}
</p>
<span id="quote_005f_002d"></span><span id="quote_002d"></span><span id="index-quote_005f_002d"></span>
<span id="index-quote_002d"></span>
<span id="index-Xiao-Xue-Chu-Yong-rezisuta-_0022_002d"></span>
<span id="g_t3_002e-Xiao-Xue-Chu-Yong-rezisuta-_0022_002d"></span><h4 class="unnumberedsubsubsec">3. 小削除用レジスタ &quot;-</h4>
<p>このレジスタには、範圍が 1 行以下の削除コマンドで削除されたテキストが蓄へられる。ただし、コマンドに [&quot;x] で別のレジスタ名を指定したときはこれには蓄へられない。
</p>
<span id="quote_005falpha"></span><span id="quotea"></span><span id="index-quote_005falpha"></span>
<span id="index-quotea"></span>
<span id="index-Ming-Qian-Fu-kirezisuta-_0022a-kara-_0022z-mataha-_0022A-kara-_0022Z"></span>
<span id="g_t4_002e-Ming-Qian-Fu-kirezisuta-_0022a-kara-_0022z-mataha-_0022A-kara-_0022Z"></span><h4 class="unnumberedsubsubsec">4. 名前付きレジスタ &quot;a から &quot;z または &quot;A から &quot;Z</h4>
<p>これらのレジスタが使はれるのは、ユーザーに指定されたときのみである。コピーや削除の際にこれらのレジスタを小文字で指定すると、コピーや削除されたテキストが蓄へられ、元から入つてゐたテキストは消える。大文字で指定すると、元から入つてゐた內容の後ろに新しいテキストを付け加へる。&rsquo;<samp>cpoptions</samp>&rsquo; にフラグ &rsquo;<var>&gt;</var>&rsquo; が入つてゐると、新しいテキストの前に改行が插入される。
</p>
<span id="index-Du-mitoriZhuan-Yong-rezisuta-_0022_003a-to-_0022_002e-to-_0022_0025"></span>
<span id="g_t5_002e-Du-mitoriZhuan-Yong-rezisuta-_0022_003a-to-_0022_002e-to-_0022_0025"></span><h4 class="unnumberedsubsubsec">5. 讀みとり專用レジスタ &quot;: と &quot;. と &quot;%</h4>
<p>讀みとり專用レジスタには &rsquo;%&rsquo; と &rsquo;#&rsquo; と &rsquo;:&rsquo; と &rsquo;.&rsquo; がある。コマンド &quot;p&quot;, &quot;P&quot;, &quot;:put&quot; および <kbd>CTRL-R</kbd> でのみ使ふことができる。
<span id="quote_005f_002e"></span><span id="quote_002e"></span><span id="E29"></span><span id="index-quote_005f_002e"></span>
<span id="index-quote_002e"></span>
<span id="index-E29"></span>
</p><dl compact="compact">
<dt>&quot;.</dt>
<dd><p>最後に插入されたテキストが蓄へられる (插入モードのコマンド <kbd>CTRL-A</kbd> や <kbd>CTRL-@</kbd> で插入されるものと同じテキストである)。
</p><blockquote>
<p><strong>Note:</strong> <br>
これはコマンドライン上での <kbd>CTRL-R</kbd> では使へないことに注意。動作が少し異なり、テキストを貼り付けるといふより插入するやうな動作をする (插入されるテキストに &rsquo;<samp>textwidth</samp>&rsquo; 等のオプションが影響する)。
</p></blockquote>
<span id="quote_005f_0025"></span><span id="quote_0025"></span><span id="index-quote_005f_0025"></span>
<span id="index-quote_0025"></span>
</dd>
<dt>&quot;%</dt>
<dd><p>カレントファイルの名前が蓄へられる。
<span id="quote_005f_003a"></span><span id="quote_003a"></span><span id="E30"></span><span id="index-quote_005f_003a"></span>
<span id="index-quote_003a"></span>
<span id="index-E30"></span>
</p></dd>
<dt>&quot;:</dt>
<dd><p>一番最近に實行されたコマンドラインの內容が蓄へられる。例: 前囘のコマンドラインによるコマンドを實行するには、&quot;@:&quot; が使へる。コマンドラインがこのレジスタに蓄へられるのは、コマンドライン內にコマンドが最低でも1文字打ち込まれたときである。そのため、コマンドが完全にキーマッピングから實行されたときには、この內容に變化はない。
</p>
<p>{Vim が |<a href="various_002etxt.html#g_t_002bcmdline_005fhist">+cmdline_hist</a>| 機能付きでコンパイルされたときのみ有效}
</p></dd>
</dl>
<span id="quote_005f_0023"></span><span id="quote_0023"></span><span id="index-quote_005f_0023"></span>
<span id="index-quote_0023"></span>
<span id="index-Dai-Ti-huairurezisuta-_0022_0023"></span>
<span id="g_t6_002e-Dai-Ti-huairurezisuta-_0022_0023"></span><h4 class="unnumberedsubsubsec">6. 代替ファイルレジスタ &quot;#</h4>
<p>カレントウィンドウの代替ファイルの名前を含む。これは |<a href="editing_002etxt.html#CTRL_002d_005e">CTRL-^</a>| コマンドがどのやうに働くかを變更する。
</p>
<p>このレジスタは書き込み可能で、主にプラグインがこのレジスタを變更した後で元に戾すためである。バッファ番號を許容する:
</p><pre class="verbatim">let altbuf = bufnr(@#)
...
let @# = altbuf
</pre><p>バッファ番號が越えるあるいはそのバッファが存在しない場合はエラー |<a href="windows_002etxt.html#E86">E86</a>| を返す。
また存在するバッファ名でのマッチングを許容する:
</p><pre class="verbatim">let @# = 'buffer_name'
</pre><p>與へられた名前にマッチしたバッファが 1 つより多い場合はエラー |<a href="windows_002etxt.html#E93">E93</a>| を、與へられた名前にマッチするバッファがない場合は |<a href="windows_002etxt.html#E94">E94</a>| を返す。
</p>
<span id="quote_005f_003d"></span><span id="quote_003d"></span><span id="g_t_0040_003d"></span><span id="index-quote_005f_003d"></span>
<span id="index-quote_003d"></span>
<span id="index-_0040_003d"></span>
<span id="index-Expression-rezisuta-_0022_003d"></span>
<span id="g_t7_002e-Expression-rezisuta-_0022_003d"></span><h4 class="unnumberedsubsubsec">7. Expression レジスタ &quot;=</h4>
<p>これは、本當はテキストを蓄へるレジスタではないが、レジスタを使ふコマンドで式を評價するために使へる。この expression レジスタは讀み取り/書き込み可能である。
</p>
<p>&quot; または <kbd>CTRL-R</kbd> の後に &rsquo;=&rsquo; を打ち込むと、カーソルはコマンド行に移動し、あらゆる式を入力することができる (|<a href="eval_002etxt.html#expression">expression</a>| を參照)。コマンドラインから入力できる普通の編輯用コマンドは、式用の特別履歷も含め、全て使用可能である。&lt;CR&gt; を打ち込んでコマンドライン入力を終了させると、式の結果が計算される。<code class="tt-key">&lt;Esc&gt;</code> を打ち込んで終了させると、式は破毀される。式が入力されないときは、(コマンド&quot;/&quot; と同樣) 前囘の式が使はれる。
</p>
<p>式を評價した結果は文字列でなければならない。評價した結果が數値なら、文字列に變換される。&quot;p&quot; と &quot;:put&quot; コマンドの場合、結果が浮動小數點數なら文字列に變換される。リストの場合、各要素が文字列に變換され、それぞれが 1 行として插入される。辭書または FuncRef はエラーメッセージが出る (string() を使つて變換する)。
</p>
<p>レジスタ &quot;= が &quot;p&quot; で使はれると、文字列は &lt;NL&gt; 文字 {譯注: New Line &ndash;改行} の所で分割される。文字列が &lt;NL&gt; で終はつてゐたら、これは行單位のレジスタと見なされる。
</p>
<span id="index-Xuan-Ze-Fan-Wei-rezisuta-_0022_002a-to-_0022_002b-to-_0022_007e"></span>
<span id="g_t8_002e-Xuan-Ze-Fan-Wei-rezisuta-_0022_002a-to-_0022_002b-to-_0022_007e"></span><h4 class="unnumberedsubsubsec">8. 選擇範圍レジスタ &quot;* と &quot;+ と &quot;~</h4>
<p>これらのレジスタは、GUI で、選擇されたテキストを蓄へたり取り出すために使はれる。|<a href="gui_002etxt.html#quotestar">quotestar</a>| と |<a href="gui_005fx11_002etxt.html#quoteplus">quoteplus</a>| を參照。クリップボードが利用できないときは、無名レジスタが代はりに使はれる。Unix では |<a href="various_002etxt.html#g_t_002bxterm_005fclipboard">+xterm_clipboard</a>| が有效になつてゐるときだけクリップボードを利用できる。
</p>
<blockquote>
<p><strong>Note:</strong> <br>
&quot;* と &quot;+ に區別があるのは X11 システムのみであることに注意。違ひについては |<a href="gui_005fx11_002etxt.html#x11_002dselection">x11-selection</a>| を參照。MS-Windows では &quot;* と &quot;+ は實際には同義で、クリップボード |<a href="gui_005fw32_002etxt.html#gui_002dclipboard">gui-clipboard</a>| を使用する。
</p></blockquote>

<span id="quote_005f_007e"></span><span id="quote_007e"></span><span id="g_t_003cDrop_003e"></span><span id="index-quote_005f_007e"></span>
<span id="index-quote_007e"></span>
<span id="index-_003cDrop_003e"></span>
<p>この讀み込み專用の &quot;~ レジスタは最後にドラッグアンドドロップされたテキストを提供する。何かが Vim にドロップされたとき、&quot;~ レジスタがそれで埋められ、&lt;Drop&gt; 假想キーが通知される。このキーをリマップして使ふことができる。デフォルトでは (全てのモードにおいて) &quot;~ レジスタの內容をカーソルの位置に插入する。
</p>
<p>{|<a href="various_002etxt.html#g_t_002bdnd">+dnd</a>| 付きでコンパイルされたときのみ有效。現在は GTK GUI でのみ使へる。}
</p>
<blockquote>
<p><strong>Note:</strong> <br>
&quot;~ レジスタはプレーンテキストを Vim にドロップしたときのみ使はれる。URI のリストは內部で扱はれる。
</p></blockquote>

<span id="quote_005f"></span><span id="index-quote_005f"></span>
<span id="index-Xiao-Qu-Zhuan-Yong-rezisuta-_0022_005f"></span>
<span id="g_t9_002e-Xiao-Qu-Zhuan-Yong-rezisuta-_0022_005f"></span><h4 class="unnumberedsubsubsec">9. 消去專用レジスタ &quot;_</h4>
<p>このレジスタを指定してテキストを削除しても、{譯注: レジスタには} 何も起こらない。そのため、普通のレジスタに影響を與へずに削除が行へる。このレジスタから貼り付けようとしても、何も出てこない。
</p>
<span id="quote_005f_002f"></span><span id="quote_002f"></span><span id="index-quote_005f_002f"></span>
<span id="index-quote_002f"></span>
<span id="index-Zui-Zhong-Jian-Suo-patanYong-rezisuta-_0022_002f"></span>
<span id="g_t10_002e-Zui-Zhong-Jian-Suo-patanYong-rezisuta-_0022_002f"></span><h4 class="unnumberedsubsubsec">10. 最終檢索パターン用レジスタ &quot;/</h4>
<p>最後に使はれた檢索パターンが蓄へられる。これはコマンド &quot;n&quot; やオプション &rsquo;<samp>hlsearch</samp>&rsquo; による强調表示に使はれる。このレジスタは &lsquo;:let&lsquo; で變更できるので、&rsquo;<samp>hlsearch</samp>&rsquo; による强調表示を、實際に檢索を行はずに別のマッチに適用することができる。このレジスタを使つてコピーしたり削除することはできない。檢索の方向は |<a href="eval_002etxt.html#v_003asearchforward">v:searchforward</a>| で設定することができます。
</p><blockquote>
<p><strong>Note:</strong> <br>
函數から拔けると、この値は函數に入る前の値に復元される。|<a href="eval_002etxt.html#function_002dsearch_002dundo">function-search-undo</a>|
</p></blockquote>

<span id="g_t_0040_002f"></span><span id="index-_0040_002f"></span>
<p>レジスタには、コマンド &lsquo;<code>:let</code>&lsquo; で書き込むことができる |<a href="eval_002etxt.html#g_t_003alet_002d_0040">:let-@</a>|。例:
</p><pre class="verbatim">:let @/ = &quot;the&quot;
</pre>
<p>レジスタを指定せずに貼り付けコマンドを使ふと、最後に書き込みが行はれたレジスタが使はれる (その內容は無名レジスタと同じである)。混亂したときは、コマンド &lsquo;:dis&lsquo; を使ふとレジスタの內容が分かる (このコマンドは、全てのレジスタの內容を表示する。無名レジスタは &rsquo;&quot;&rsquo; と示される)。
</p>
<p>以下の 3 個のコマンドは、必ず行全體に對して働く。
</p>
<span id="g_t_003aco"></span><span id="g_t_003acopy"></span><span id="index-_003aco"></span>
<span id="index-_003acopy"></span>
<dl compact="compact">
<dt>:[range]co[py] {address}</dt>
<dd><p>[range] 行を、{address} 行目の下にコピーする。
</p>

<span id="g_t_003at"></span><span id="index-_003at"></span>
</dd>
<dt>:t</dt>
<dd><p>&quot;:copy&quot; と同義。
</p>
<span id="g_t_003am"></span><span id="g_t_003amo"></span><span id="g_t_003amove"></span><span id="E134"></span><span id="index-_003am"></span>
<span id="index-_003amo"></span>
<span id="index-_003amove"></span>
<span id="index-E134"></span>
</dd>
<dt>:[range]m[ove] {address}</dt>
<dd><p>[range] 行を、{address} 行目の下に移動する。
</p></dd>
</dl>

<span id="formatting"></span><span id="index-formatting"></span>
<span id="index-tekisutonoZheng-Xing--1"></span>
<span id="g_t6_002e-tekisutonoZheng-Xing-"></span><h3 class="section">6. テキストの整形</h3>

<span id="g_t_003ace"></span><span id="g_t_003acenter"></span><span id="index-_003ace"></span>
<span id="index-_003acenter"></span>
<dl compact="compact">
<dt>:[range]ce[nter] [width]</dt>
<dd><p>[range] の行を、幅 [width] (既定値は &rsquo;<samp>textwidth</samp>&rsquo;, &rsquo;<samp>textwidth</samp>&rsquo; が 0 のときは 80) に基づいて中央揃へする。
</p>
<span id="g_t_003ari"></span><span id="g_t_003aright"></span><span id="index-_003ari"></span>
<span id="index-_003aright"></span>
</dd>
<dt>:[range]ri[ght] [width]</dt>
<dd><p>[range] の行を、幅 [width] (既定値は &rsquo;<samp>textwidth</samp>&rsquo;, &rsquo;<samp>textwidth</samp>&rsquo; が 0 のときは 80) に基づいて右揃へする。
</p>
<span id="g_t_003ale"></span><span id="g_t_003aleft"></span><span id="index-_003ale"></span>
<span id="index-_003aleft"></span>
</dd>
<dt>:[range]le[ft] [indent]</dt>
<dd><p>[range] の行を左揃へする。行中のインデントを [indent] (既定値 0) に設定する。
</p>
<span id="gq"></span><span id="index-gq"></span>
</dd>
<dt>gq{motion}</dt>
<dd><p>{motion} の行を整形する。整形は3種類の方法のうちどれかで行はれる。
</p><ol>
<li> &rsquo;<samp>formatexpr</samp>&rsquo; が空でなければその expression が評價される。これはバッファごとに異なつてもよい。
</li><li> &rsquo;<samp>formatprg</samp>&rsquo; が空でなければ外部プログラムが使はれる。
</li><li> それ以外の場合は內部整形ルーチンが使はれる。
</li></ol>

<p>3 番目の場合は、オプション &rsquo;<samp>textwidth</samp>&rsquo; が整形された各行の長さを制禦する (後述)。&rsquo;<samp>textwidth</samp>&rsquo; が 0 なら、整形された行の長さは畫面の幅となる (ただし、最大で 79)。
&rsquo;<samp>formatoptions</samp>&rsquo; は、整形の仕方を制禦する |<a href="#fo_002dtable">fo-table</a>|。カーソルは最後に整形された行の最初の非空白文字の上に置かれる。
</p><blockquote>
<p><strong>Note:</strong> <br>
以前はコマンド &quot;Q&quot; でこの機能を行つてゐた。やはり整形に &quot;Q&quot; を使ひたいならば、次のマッピングを使ふこと。
</p><pre class="verbatim">:nnoremap Q gq
</pre></blockquote>

<span id="gqgq"></span><span id="gqq"></span><span id="index-gqgq"></span>
<span id="index-gqq"></span>
</dd>
<dt>gqgq</dt>
<dt>gqq</dt>
<dd><p>現在行を整形する。カウントを指定するとその行數だけ整形される。
</p>
<span id="v_005fgq"></span><span id="index-v_005fgq"></span>
</dd>
<dt>{Visual}gq</dt>
<dd><p>ビジュアル選擇されたテキストを整形する。({Visual} については |<a href="visual_002etxt.html#Visual_002dmode">Visual-mode</a>| を參照)。
</p>
<span id="gw"></span><span id="index-gw"></span>
</dd>
<dt>gw{motion}</dt>
<dd><p>{motion} で動いた範圍の行を整形する。|<a href="#gq">gq</a>| に似てゐるがカーソルは元の位置に戾る。&rsquo;<samp>formatprg</samp>&rsquo; と &rsquo;<samp>formatexpr</samp>&rsquo; は使はれない。
</p>
<span id="gwgw"></span><span id="gww"></span><span id="index-gwgw"></span>
<span id="index-gww"></span>
</dd>
<dt>gwgw</dt>
<dt>gww</dt>
<dd><p>&quot;gw&quot; と同樣にして現在行を整形する。
</p>
<span id="v_005fgw"></span><span id="index-v_005fgw"></span>
</dd>
<dt>{Visual}gw</dt>
<dd><p>選擇されたテキストを &quot;gw&quot; と同樣にして整形する。({Visual} については |<a href="visual_002etxt.html#Visual_002dmode">Visual-mode</a>| を參照)。
</p></dd>
</dl>

<span id="gqap"></span><span id="index-gqap"></span>
<p>例: 現在の段落を整形するには、次のやうにする。
</p><pre class="verbatim">gqap
</pre>
<p>コマンド &quot;gq&quot; は、移動コマンドによつてカーソルが動くはずの位置にカーソルを移動させる。このため、&quot;.&quot; で整形を繰り返すことができる。これは、&quot;gqj&quot; (現在行と次行を整形) と、&quot;gq}&quot; (段落の最後までを整形) で有用である。
</p><blockquote>
<p><strong>Note:</strong> <br>
&rsquo;<samp>formatprg</samp>&rsquo; が設定されてゐるときは、&quot;gq&quot; を實行すると (フィルタコマンド使用時と同樣に) カーソルは整形された最初の行に移動する。
</p></blockquote>

<p>カーソルのある位置の段落をフォーマットし、その位置からさらに編輯を再開するにはかうする。
</p><pre class="verbatim">gwap
</pre><p>いつも段落をフォーマットしておきたいなら &rsquo;<samp>formatoptions</samp>&rsquo; に &rsquo;a&rsquo; フラグを追加すればよい。|<a href="#auto_002dformat">auto-format</a>| も參照のこと。
</p>
<p>オプション &rsquo;<samp>autoindent</samp>&rsquo; がオンのとき、Vim は最初の行のインデントを續く行に對して適用する。
</p>
<p>テキストの整形處理は空の行には變更を加へない (しかし、空白のみで構成された行には變更を行ふ！)。
</p>
<p>オプション &rsquo;<samp>joinspaces</samp>&rsquo; は、行が連結されるときに使はれる。
</p>
<p>オプション &rsquo;<samp>formatexpr</samp>&rsquo; でテキストの整形に使ふ expression を設定したり、&rsquo;<samp>formatprg</samp>&rsquo; で外部プログラムの名前を設定することができる。外部プログラムによる整形處理には、&rsquo;<samp>textwidth</samp>&rsquo; や他のオプションは何の影響も與へない。
</p>
<span id="format_002dformatexpr"></span><span id="index-format_002dformatexpr"></span>
<p>&rsquo;<samp>formatexpr</samp>&rsquo; オプションには、バッファの再整形を行ふ Vim script 函數を設定することができる。整形はファイルの種類に强く依存するので、これは通常 |<a href="usr_005f41_002etxt.html#ftplugin">ftplugin</a>| で發生するべきである。對應するスクリプトは實際に必要とされるときにだけ讀み込まれ、かつそのスクリプト名は &lt;filetype&gt;format.vim とされるべきなので、|<a href="eval_002etxt.html#autoload">autoload</a>| スクリプトを使用することは理にかなつてゐる。
</p>
<p>例へば、Vim と共に配布され <code>$VIMRUNTIME</code> ディレクトリに配置されてゐる XML ファイルタイププラグインは、&rsquo;<samp>formatexpr</samp>&rsquo; オプションを以下のやうに設定する:
</p><pre class="verbatim">setlocal formatexpr=xmlformat#Format()
</pre>
<p>これは xmlformat#Format() 函數を定義してゐるスクリプトが以下のディレクトリで見つかることを意味してゐる:
</p>
<p>&lsquo;$VIMRUNTIME/autoload/xmlformat.vim&lsquo;
</p>
<p>以下は、選擇されたテキストから末尾の空白を取り除くスクリプトの例である。これを autoload ディレクトリに置くこと。例、~/.vim/autoload/format.vim:
</p>
<pre class="verbatim">func! format#Format()
  &quot; 明示的な gq コマンドの場合だけ再整形する
  if mode() != 'n'
    &quot; Vim の內部再整形に立ち戾る
    return 1
  endif
  let lines = getline(v:lnum, v:lnum + v:count - 1)
  call map(lines, {key, val -&gt; substitute(val, '\s\+$', '', 'g')})
  call setline('.', lines)

  &quot; 內部の整形は實行させない！
  return 0
endfunc
</pre>
<p>その後以下のやうに整形を有效にすることができる:
</p><pre class="verbatim">setlocal formatexpr=format#Format()
</pre><blockquote>
<p><strong>Note:</strong> <br>
この函數は、插入モードから呼ばれた場合に明示的に非ゼロを返す (基本的に &rsquo;<samp>textwidth</samp>&rsquo; の制限を超えてテキストが插入されることを意味する)。これは Vim に內部の整形機能に立ち戾つて再整形させることになる。
</p></blockquote>

<p>しかしながら、テキストを再整形するために |<a href="#gq">gq</a>| コマンドが使用された場合、その函數は選擇された行を受け取り、それらの行から末尾の空白を取り除き、そして所定の位置にそのテキストを配置しなほす。もし 1 つの行を複數行に分割しようとしてゐる場合、何か上書きしてしまはないよう注意すること。
</p>
<p>插入もしくは置換モードからのテキストの再整形を可能にしたい場合、函數が再歸的に呼び出されることがあるため注意しなければならない。これをデバッグするためには、&rsquo;<samp>debug</samp>&rsquo; オプションを設定することが役に立つ。
</p>
<span id="right_002djustify"></span><span id="index-right_002djustify"></span>
<p>テキストを右揃へするコマンドは、Vim には存在しない。&quot;par&quot; 等の外部コマンド (例: &quot;!}par&quot; で段落の最後までを整形する) を實行したり、&rsquo;<samp>formatprg</samp>&rsquo; に &quot;par&quot; を指定することで、これを行ふことができる。
</p>
<span id="format_002dcomments"></span><span id="index-format_002dcomments"></span>
<p>コメント整形の槪要がユーザーマニュアルの |<a href="usr_005f30_002etxt.html#g_t30_002e6">30.6</a>| にある。
</p>
<p>Vim は特殊な方法で自動的にコメントを插入・整形できる。Vim は行の最初の特定の文字列 (空白を無視する) によつて、コメントを認識できる。コメントには 3 種類が使へる。
</p>
<ul>
<li> 各行の最初で繰り返されるコメント文字列。例へば、&quot;#&quot; で始まるシェルスクリプトのコメントなど。
</li><li> 最初の行にのみ現れ、續きの行には現れないコメント文字列。例へば、このリストにおけるダッシュ &rsquo;-&rsquo;。
</li><li> 最初の文字列、最後の文字列、そしてその閒の行の 3 つの部分から成るコメント。開始部分、中閒部分、終了部分に使はれる文字列は異なる。例へば、C 言語形式のコメント。
<pre class="verbatim">/*
* これは C のコメント
*/
</pre></li></ul>

<p>オプション &rsquo;<samp>comments</samp>&rsquo; は要素のコンマ區切りのリストである。各要素はコメント文字列の種類を定義してゐる。要素は次のやうに構成される。
</p><pre class="verbatim">@{flags@}:@{string@}
</pre>
<p>{string} は普通のテキストで、これがなければならない。
</p>
<p>{flags}:
</p><table>
<tr><td width="20%">n</td><td width="80%">入れ子になつたコメント。混在した要素の入れ子も有效である。&rsquo;<samp>comments</samp>&rsquo; が &quot;n:),n:&gt;&quot; であれば、&quot;&gt; ) &gt;&quot; で始まる行はコメント。</td></tr>
<tr><td width="20%">b</td><td width="80%">{string} の後に餘白 (&lt;Space&gt;、&lt;Tab&gt; または &lt;EOL&gt;) が必要。</td></tr>
<tr><td width="20%">f</td><td width="80%">最初の行のみがコメント文字列を持つ。次の行にはコメントを繰り返さないが、インデントは保持する (例、bullet-list)。</td></tr>
<tr><td width="20%">s</td><td width="80%">3 部コメントの開始部分。</td></tr>
<tr><td width="20%">m</td><td width="80%">3 部コメントの中閒部分。</td></tr>
<tr><td width="20%">e</td><td width="80%">3 部コメントの終了部分。</td></tr>
<tr><td width="20%">l</td><td width="80%">左揃へ。&rsquo;s&rsquo; か &rsquo;e&rsquo; と共に指定された場合、それぞれ最初または最後の部分の一番左の文字が、眞ん中の一番左の文字に對して揃へられる。この動作はデフォルトであるが、省略もできる。詳しくは後述。</td></tr>
<tr><td width="20%">r</td><td width="80%">右揃へ。一番左でなく一番右であること以外、l と同じ。詳しくは後述。</td></tr>
<tr><td width="20%">O</td><td width="80%">コマンド &quot;O&quot; ではこのコメントを考慮しない。</td></tr>
<tr><td width="20%">x</td><td width="80%">3 部コメントで、中閒部分のコメントがすでに自動で插入されてゐるとき、新しい行の最初のアクションとして、終了部分のコメント文字列の最後の文字を打ち込むだけで、コメントを終了させる。詳細は以下を參照。</td></tr>
<tr><td width="20%">{digits}</td><td width="80%">&rsquo;s&rsquo; か &rsquo;e&rsquo; と共に指定された場合: 自動的に插入された、中閒または最後のコメントの最初の部分に對し、{digits} 分のオフセットを加へる。このオフセットは左端を基準とする。詳しくは後述。</td></tr>
<tr><td width="20%">-{digits}</td><td width="80%">{digits} に似てゐるが、インデントを減らす。開始部分と終了部分に減らすべきインデントが存在してゐるときのみ機能する。</td></tr>
</table>

<p>コメント文字列にフラグ &rsquo;f&rsquo;, &rsquo;s&rsquo;, &rsquo;m&rsquo;, &rsquo;e&rsquo; のいづれも指定しないとき、Vim はコメント文字列を行の最初に繰り返すと假定する。フラグ欄は空になる。
</p>
<p>{string} の前や後にある餘白は、{string} の一部とされる。コメント文字列に必要でない限り、餘白を前や後に付けないこと。
</p>
<p>あるコメント開始文字列が他のコメントの一部であるときは、共通部分の後で特定の部分を指定すること。例へば、&quot;-&quot; と &quot;-&gt;&quot; の兩方を含みたいときは、次のやうにする。
</p><pre class="verbatim">:set comments=f:-&gt;,f:-
</pre>
<p>3 部コメントには常に開始部分、中閒部分、終了部分を指定しなければならない。そして、他の要素を閒に入れてはならない。C言語での3部コメントの例は次の通り。
</p><pre class="verbatim">sr:/*,mb:*,ex:*/
</pre><p>&quot;*ptr&quot; がコメントとして認識されないやうに、中閒部分の文字列がフラグ &rsquo;b&rsquo; を含んでゐる。3 部コメントでは、Vim は開始部分と中閒部分の文字列の後のテキスト內に、最後の文字列が含まれてゐないかを調べる。終了部分の文字列が見つかると、コメントは次の行には續かない。3 部コメントには、Vim が中閒の行を認識できるやうにするために、中閒部分の文字列を指定しなければならない。
</p>
<p>上記の 3 部コメントの定義における、フラグ &quot;x&quot; の使用について注意しておく。C コメントでリターンを打てば、Vim は新しい行に對して &quot; * &quot; のやうなコメントの中閒部分の開始文字列を插入する。このコメントを閉ぢるには、新しい行において何も打ち込む前に &quot;/&quot; と打ち込めばよい。これは中閒のコメント指示を最後のコメント指示に置き換へ、&quot; */&quot; とする。指定された桁揃へは適用される。その前にバックスペースを打ち込む必要はない。
</p>
<p>中閒部分がマッチしたとき、終了部分もマッチしてゐてそちらの方が長い場合は、終了部分が使はれる。これによつて C スタイルコメントが中閒部分の末尾にスペースを付けなくても機能するやうになる。
</p>
<p>桁揃へフラグを使つてコメントを目立たせる例を示す。&rsquo;<samp>comments</samp>&rsquo; が次のやうになつてゐる場合:
</p><pre class="verbatim">:set comments=sr:/***,m:**,ex-2:******/
</pre><pre class="verbatim">                                   /***
                                     **&lt;--&quot;r&quot; フラグによつて右揃へされてゐる
                                     **
 &quot;-2&quot; フラグによつてスペース         **
 2 個分のオフセットがついてゐる  ---&gt;**
                                   ******/
</pre><p>これを入力する際、コメントの開始行を入力し、リターンを 4 回押す。そして &quot;/&quot; を押せばコメントが終了する。
</p>
<p>3 部コメントについて、より細かいことをいくつか說明する。桁揃へフラグとオフセットフラグが考慮される箇所は、次の 3 箇所ある。コメント開始行のあとの新規行を開くとき、コメント終了行の前の新規行を開くとき、自動的にコメントを終了させるときである。終了部分の桁揃へフラグは、上の行を參照する。これによつて、&quot;s&quot; と &quot;e&quot; に同じ桁揃へフラグを指定したとき、開始部分と終了部分のインデント量が同じになる。コメントの部分ごとに 1 個だけの桁揃へが使はれるやうになつてゐる。しかし、オフセットの數は &quot;r&quot; と &quot;l&quot; フラグより優先する。
</p>
<p>&rsquo;<samp>cindent</samp>&rsquo; をオンにしてゐると、多くの場合、桁揃へフラグより優先される。|<a href="#gq">gq</a>| や |<a href="#g_t_003d">=</a>| を使つて再インデントするときも、桁揃へフラグは適用されない。同じ擧動を定義するには、それらのコマンドのオプションを使ふ。1 つの考へとしては、&rsquo;<samp>cindent</samp>&rsquo; に文脈に應じてコメントをインデントさせるオプションを追加することであるが、3 部コメントの桁揃へを摸倣することはほとんどできない。しかし &rsquo;<samp>indentexpr</samp>&rsquo; は 3 部コメントをもつとうまく扱へる可能性を持つ。
</p>
<p>他の例:
</p><table>
<tr><td width="15%">&quot;b:*&quot;</td><td width="85%">&quot;*&quot; の後に非ブランク文字が付いてゐなければ、&quot;*&quot; で始まる行を含む。これはポインタの値への參照 &quot;*str&quot; が、コメントとして認識されるのを防ぐ。</td></tr>
<tr><td width="15%">&quot;n:&gt;&quot;</td><td width="85%">&quot;&gt;&quot;, &quot;&gt;&gt;&quot;, &quot;&gt;&gt;&gt;&quot; などで始まる行を含む。</td></tr>
<tr><td width="15%">&quot;fb:-&quot;</td><td width="85%">&quot;- &quot; で始まるリストを整形する。</td></tr>
</table>

<p>既定では &quot;b:#&quot; が含まれてゐる。これは &quot;#include&quot; で始まる行がコメントとならないことを意味する。しかし、&quot;# define&quot; で始まる行はコメントとなる。これは妥協的解決である。
</p>
<span id="fo_002dtable"></span><span id="index-fo_002dtable"></span>
<p>テキストの整形方法はオプション &rsquo;<samp>formatoptions</samp>&rsquo; で調整できる。&rsquo;<samp>formatoptions</samp>&rsquo; は以下のフラグを含む文字列である。既定値は &quot;<var>tcq</var>&quot; である。讀みやすくするために、フラグをコンマで區切つてもよい。
</p>
<span id="index-huragu-_0027formatoptions_0027-niZhi-Ding-saretatokinoZuo-Yong-"></span>
<span id="huragu-_0027formatoptions_0027-niZhi-Ding-saretatokinoZuo-Yong-"></span><h4 class="unnumberedsubsec">フラグ &rsquo;formatoptions&rsquo; に指定されたときの作用</h4>

<table>
<tr><td width="10%">t</td><td width="90%">&rsquo;<samp>textwidth</samp>&rsquo; を使つてテキストを自動折返しする</td></tr>
<tr><td width="10%">c</td><td width="90%">&rsquo;<samp>textwidth</samp>&rsquo; を使つてコメントを自動折返して、現在のコメント開始文字列を自動插入する。</td></tr>
<tr><td width="10%">r</td><td width="90%">插入モードで <code class="tt-key">&lt;Enter&gt;</code> を打ち込んだ後に、現在のコメント開始文字列を自動插入する。</td></tr>
<tr><td width="10%">o</td><td width="90%">ノーマルモードで &rsquo;o&rsquo;, &rsquo;O&rsquo; を打ち込んだ後に、現在のコメント開始文字列を自動的に插入する。</td></tr>
<tr><td width="10%">q</td><td width="90%">&quot;gq&quot; でコメントを整形する。
<blockquote>
<p><strong>Note:</strong> <br>
整形は空行やコメント開始文字列のみの行は變更しないことに注意。新しい段落はそのやうな行の次、またはコメント開始文字列が變はつた所から始まる。
</p></blockquote></td></tr>
<tr><td width="10%">w</td><td width="90%">行末に空白が付いてゐるとき、段落が次行に續いてゐると認識する。行末が空白以外の行で段落が終はるとする。</td></tr>
<tr><td width="10%">a</td><td width="90%">段落を自動整形する。テキストが插入されたり削除されるたび、段落は再整形される。|<a href="#auto_002dformat">auto-format</a>| を參照。&rsquo;c&rsquo; フラグも設定されてゐるときはコメント插入時のみ機能する。</td></tr>
<tr><td width="10%">n</td><td width="90%">テキストの整形時、番號付きリストを認識する。これは實際には &rsquo;<samp>formatlistpat</samp>&rsquo; を使ふ。それゆゑ、どんな種類のリストでも處理できる。

<p>數字の後のテキストのインデントが次の行に使はれる。數字の後に &rsquo;.&rsquo;, &rsquo;:&rsquo;, &rsquo;)&rsquo;, &rsquo;]&rsquo; や &rsquo;}&rsquo; が付いてもよい。オプション &rsquo;<samp>autoindent</samp>&rsquo; がオンでなければならないことに注意。&quot;2&quot; と一緖には機能しない。例:
</p><pre class="verbatim">1. 1 つ目の項目
   折り返し
2. 2 つ目の項目
</pre></td></tr>
<tr><td width="10%">2</td><td width="90%">テキストを整形するとき、段落の最初の行ではなく 2 番目の行のインデントを使つてそれ以降の行を整形する。これは最初の行のインデントが他の行と異なるやうな段落をサポートする。&rsquo;<samp>autoindent</samp>&rsquo; もオンである必要がある。例:
<pre class="verbatim">        ここはある段落の 1 行目
ここは上の行と同じ段落の 2 行目
ここは 3 行目。
</pre><p>これはコメントの中でも機能します (コメント文字がないかのやうに)。
</p></td></tr>
<tr><td width="10%">v</td><td width="90%">插入モードでVi互換の自動折返しを使ふ: 插入モードに入つて以來入力された空白でのみ折返しが行はれる。(<strong>Note:</strong> これは 100% の Vi 互換ではない。Vi にはこのあたりに「豫期できない機能」、といふかバグがあつた。Vi は實際のテキストの列の代はりに畫面上の列を使用する。)</td></tr>
<tr><td width="10%">b</td><td width="90%">&rsquo;v&rsquo; と同樣だが、折返し餘白の中または前で、空白を入力したときのみ自動折返しをする。插入開始時に &rsquo;<samp>textwidth</samp>&rsquo; より行が長かつたり、&rsquo;<samp>textwidth</samp>&rsquo; に達するまで空白を入力しなかつたときは、Vim は自動折返しをしない。</td></tr>
<tr><td width="10%">l</td><td width="90%">插入モードでは長い行は折り返されない: 插入開始時に行が &rsquo;<samp>textwidth</samp>&rsquo; より長い場合、Vim は自動で整形を行はない。</td></tr>
<tr><td width="10%">m</td><td width="90%">文字コードが 255 より後のマルチバイト文字の閒でも改行する。これは文字全てがそれだけで單語であるやうな、アジア言語のテキストで便利である。</td></tr>
<tr><td width="10%">M</td><td width="90%">行の連結時に、マルチバイト文字の前後に空白を插入しない。こちらの方がフラグ &rsquo;B&rsquo; より優先する。</td></tr>
<tr><td width="10%">B</td><td width="90%">行の連結時に、マルチバイト文字同士の閒に空白を插入しない。こちらよりフラグ &rsquo;M&rsquo; の方が優先する。</td></tr>
<tr><td width="10%">1</td><td width="90%">1 文字の單語の後では改行しない。代はりにその前で改行される (可能ならば)。</td></tr>
<tr><td width="10%">j</td><td width="90%">可能ならば、行を連結する際にコメントリーダーを削除する。例へば、以下の行を連結する場合:
<pre class="verbatim">int i;   // the index
         // in the list
</pre><p>以下のやうになる:
</p><pre class="verbatim">int i;   // the index in the list
</pre></td></tr>
<tr><td width="10%">p</td><td width="90%">ピリオドに續く單一の空白で改行しない。これは、2 つの空白で區切られた文章を含む散文用に &rsquo;<samp>joinspaces</samp>&rsquo; と |<a href="options_002etxt.html#cpo_002dJ">cpo-J</a>| を補完するためのものである。例へば、&rsquo;<samp>textwidth</samp>&rsquo; を 28 に設定すると:
<pre class="verbatim">Surely you're joking, Mr. Feynman!
</pre><p>以下のやうになる:
</p><pre class="verbatim">Surely you're joking,
Mr. Feynman!
</pre><p>以下のやうにはならない:
</p><pre class="verbatim">Surely you're joking, Mr.
Feynman!
</pre></td></tr>
</table>


<p>&rsquo;t&rsquo; と &rsquo;c&rsquo; で Vim が自動折返しを行ふタイミングを指定できる。
</p><table>
<tr><td width="20%">フラグ</td><td width="80%">作用</td></tr>
<tr><td width="20%">&quot;&quot;</td><td width="80%">自動整形しない (&quot;gq&quot; で手動の整形處理を行ふ)</td></tr>
<tr><td width="20%">&quot;t&quot;</td><td width="80%">テキストを自動整形するが、コメントにはしない</td></tr>
<tr><td width="20%">&quot;c&quot;</td><td width="80%">コメントを自動整形するが、テキストにはしない (C 言語コードに適してゐる)</td></tr>
<tr><td width="20%">&quot;tc&quot;</td><td width="80%">テキストとコメントを自動整形する</td></tr>
</table>

<blockquote>
<p><strong>Note:</strong> <br>
&rsquo;<samp>textwidth</samp>&rsquo; が 0 のとき、Vim はいかなる自動整形も行はないので注意 (&rsquo;<samp>comments</samp>&rsquo; によるコメント開始文字列の插入はする)。例外はフラグ &rsquo;a&rsquo; が入つてゐる場合である。|<a href="#auto_002dformat">auto-format</a>|
</p></blockquote>

<blockquote>
<p><strong>Note:</strong> <br>
&rsquo;<samp>paste</samp>&rsquo; がオンのとき、Vim は全ての整形處理を行はないので注意。
</p></blockquote>

<blockquote>
<p><strong>Note:</strong> <br>
Vim に自動折返しをさせなくても、&rsquo;<samp>textwidth</samp>&rsquo; は非 0 であつてよいことに注意。&rsquo;<samp>textwidth</samp>&rsquo; は &quot;gq&quot; による整形處理でも便利だからである。
</p></blockquote>

<p>&rsquo;<samp>comments</samp>&rsquo; が &quot;/*&quot; と (&quot;*&quot; と) &quot;*/&quot; を含んでゐるときは、Vim 組み込みの機能によりこれらのタイプのコメントをもう少し巧く扱ふことができる。
</p>
<p>(&rsquo;<samp>formatoptions</samp>&rsquo; に &rsquo;r&rsquo; か &rsquo;o&rsquo; が含まれてゐるとき) &quot;/*&quot; または &quot;*/&quot; の前か後で新しい行を始めると、行の正しい開始位置が自動的に與へられる。同じことが整形處理と自動折返しでも行はれる。&quot;/*&quot; や &quot;*&quot; で始まり、かつ &quot;*/&quot; を含む行の後で行を始めるときは、コメント開始文字列が插入されず、新しい行のインデントはコメントの最初の行に合はせられる。
</p>
<p>例:
</p><pre class="verbatim">/*
 * 典型的なコメント。
 */
この行のインデントは、上のコメントの先頭行と同じになる。
</pre>

<p>これら全ては、特に異なるファイルタイプに對する異なる設定に對應する際、新しい autocommand と連携して、クールに振舞ふはずである。
</p>
<p>いくつかの例:
</p>
<p>C 言語コード用 (コメントの整形のみ):
</p><pre class="verbatim">:set fo=croq
</pre><p>メール／ネットニューズ用 (全て整形、コマンド &quot;o&quot; でコメントを始めない):
</p><pre class="verbatim">:set fo=tcrq
</pre>
<span id="auto_002dformat"></span><span id="autoformat"></span><span id="index-auto_002dformat"></span>
<span id="index-autoformat"></span>
<span id="index-Zi-Dong-Zheng-Xing-"></span>
<span id="Zi-Dong-Zheng-Xing-"></span><h4 class="unnumberedsubsec">自動整形</h4>

<p>オプション &rsquo;<samp>formatoptions</samp>&rsquo; にフラグ &rsquo;<var>a</var>&rsquo; が含まれると、テキストを插入したり削除したときに自動整形が行はれる。これはテキストの段落分けを編輯するときに便利である。以下では使ひ方についてのヒントをいくつか。
</p>
<ul>
<li> 段落を適切に定義する必要がある。もつとも單純なものは、空行が區切りになる場合である。區切りとなる空行がないときは、フラグ &rsquo;w&rsquo; を使ひ、段落の最終行以外の行末に空白を付けるやうにしてみること。

</li><li> &rsquo;<samp>formatoptions</samp>&rsquo; をファイルタイプ |<a href="filetype_002etxt.html#filetype">filetype</a>| に基づいて設定することができる。またはモードライン |<a href="options_002etxt.html#modeline">modeline</a>| で特定のファイルに對して設定することもできる。

</li><li> &rsquo;<samp>formatoptions</samp>&rsquo; を &quot;<var>aw2tcq</var>&quot; に設定し、テキストのインデントを次のやうにすることもできる。

<pre class="verbatim">    bla bla foobar bla 
bla foobar bla foobar bla
    bla bla foobar bla 
bla foobar bla bla foobar
</pre>
</li><li> コメントだけを自動整形するには &rsquo;c&rsquo; フラグを追加する。ソースコードの編輯向き。

</li><li> 行の長さを望みどほりにするには &rsquo;<samp>textwidth</samp>&rsquo; を設定する。これが 0 ならば 79 になる。畫面の幅が 79 桁より小さい場合は畫面幅になる。
</li></ul>

<span id="index-Ci-niikutukanoJing-Gao-"></span>
<span id="Ci-niikutukanoJing-Gao-_003a"></span><h4 class="unnumberedsubsec">次にいくつかの警告:</h4>

<ul>
<li> テキストの部分部分が段落內で適切に分割されてゐないとき、そのテキスト內で變更を行ふと、有無をいわさず整形が始まつてしまふ。次のやうにしてみること。

<pre class="verbatim">:set fo-=a
</pre>
</li><li> フラグ &rsquo;w&rsquo; (行末の空白で段落が終はつてゐないことを判斷する) を使つてゐるときに |<a href="#dd">dd</a>| で段落の最終行を削除すると、その段落が次の段落とつながつてしまふ。

</li><li> 變更されたテキストは、アンドゥのために記憶される。整形も變更の一種である。そのため、整形を行ふ度にテキストがアンドゥ用に記憶される。すると大量のメモリを消費するかもしれない。

</li><li> 長い段落や、複雜なインデントの段落を整形するのには、時閒がかかることがある。
</li></ul>

<span id="sorting"></span><span id="index-sorting"></span>
<span id="index-tekisutonosoto"></span>
<span id="g_t7_002e-tekisutonosoto"></span><h3 class="section">7. テキストのソート</h3>

<p>Vimはソート函數とソートコマンドを備へてゐる。ソート函數については |<a href="eval_002etxt.html#sort_0028_0029">sort()</a>|, |<a href="eval_002etxt.html#uniq_0028_0029">uniq()</a>| を參照。
</p>
<span id="g_t_003asor"></span><span id="g_t_003asort"></span><span id="index-_003asor"></span>
<span id="index-_003asort"></span>
<dl compact="compact">
<dt>:[range]sor[t][!] [b][f][i][n][o][r][u][x] [/{pattern}/]</dt>
<dd><p>[range]の行をソートする。範圍が指定されない場合は全行をソートする。
</p>
<p>[!] をつけると順序が逆になる。
</p>			
<p>[i] をつけると大文字・小文字を區別しない。
</p>
<p>[n][f][x][o][b] オプションはどれかひとつのみ指定できる。
</p>
<p>[n] をつけると行の ({pattern} のマッチの後ろまたは內側の) 最初の 10 進數の數字でソートする。數字が &rsquo;-&rsquo; で始まる場合、マイナスとみなされる。
</p>
<p>[f] をつけると行の小數點數でソートする。小數點數の値は ({pattern} によるマッチの後ろまたは內側の) テキストを str2float() に渡すやうにして決定される。このオプションは Vim が小數點數サポートを有效にしてコンパイルされたときのみ使へる。
</p>
<p>[x] をつけると行の ({pattern} のマッチの後ろまたは內側の) 最初の 16 進數の數字でソートする。&quot;0x&quot; と &quot;0X&quot; は無視される。數字が &rsquo;-&rsquo; で始まる場合、マイナスとみなされる。
</p>
<p>[o] をつけると行の ({pattern} のマッチの後ろまたは內側の) 最初の 8 進數の數字でソートする。
</p>
<p>[b] をつけると ({pattern} によるマッチの後ろまたは內側の) 行の最初の 2 進數でソートする。
</p>
<p>[u] をつけると (u は unique=「一意の」といふ意味に基づく) 連續する同一行の最初の行だけを殘す。([i] がつくと大文字・小文字を無視する) このフラグがつかない場合、連續する同一行はそのままの順序で殘される。
</p><blockquote>
<p><strong>Note:</strong> <br>
先頭と末尾の空白が原因で異なる行にみなされるかもしれない。
</p></blockquote>

<p>/pattern/ が指定され、フラグ [r] がない場合は {pattern} にマッチするテキストはスキップされる。これによつて、そのマッチの後に來るテキストでソートできる。スラッシュの代はりにどんな non-letter でも使ふことができる。
例へば、コンマで區切られた2番目のフィールドでソートするには:
</p><pre class="verbatim">:sort /[^,]*,/
</pre><p>畫面上の10桁目でソートするには(そのためタブとスペースは同一視される):
</p><pre class="verbatim">:sort /.*\%10v/
</pre><p>行中の最初の數字でソートするには:
</p><pre class="verbatim">:sort /.\{-}\ze\d/
</pre><p>(解說: &quot;.\{-}&quot; は任意のテキストにマッチする。&quot;\ze&quot; はそのマッチの終はりをセットし、&quot;\d&quot; は數字にマッチする。)
[r] がつくと、前述のやうに {pattern} をスキップするのでなく、{pattern} にマッチする部分でソートする。例へば、各行の最初の 3 文字だけでソートするには:
</p><pre class="verbatim">:sort /\a\a\a/ r
</pre>
<p>{pattern} が使はれると {pattern} を含まない行は現在の順序のままになる。逆順でソートすると、それらはソートされた行の後で逆順になる。逆順でなければ、ソートされた行の前でもとの順序のまま置かれる。
</p>
<p>{pattern} が空である場合 (例: // が指定されたとき)、最後に使はれた檢索パターンが使はれる。よつて、まづ檢索コマンドでパターンを確かめてみることができる。
</p></dd>
</dl>

<blockquote>
<p><strong>Note:</strong> <br>
&lsquo;:global&lsquo; といつしよに &lsquo;:sort&lsquo; を使つてもマッチする行をソートすることにはならない。これはまつたく無意味である。
</p></blockquote>

<p>ソートの詳細は使つてゐるライブラリ函數による。ソートが現在のロケールに從ふといふ保證はない。それを調べるには實行してみるしかない。ソートは「安定」ソートである。
</p>
<p>ソートは中斷することができる。しかし中斷するのが遲いと行が重複してしまふかもしれない。これも使つてゐるシステムのライブラリ函數による。
</p>
<hr>
<div class="header">
<p>
Up: <a href="Mu-Ci-.html" accesskey="u" rel="up">目次</a> &nbsp; [<a href="Indexes-CP.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>

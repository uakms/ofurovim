<!DOCTYPE html>
<html lang="ja">
<!-- Created by GNU Texinfo 6.5, http://www.gnu.org/software/texinfo/ -->
<head>

<title>editing.txt (Vim Reference Manual)</title>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<meta name="description" content="editing.txt (Vim Reference Manual)">
<meta name="keywords" content="editing.txt (Vim Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2any">
<link href="Mu-Ci-.html#g_t_76ee_6b21" rel="start" title="目次">
<link href="Indexes-CP.html#Indexes-CP" rel="index" title="Indexes CP">
<link href="Mu-Ci-.html#g_t_76ee_6b21" rel="up" title="目次">
<link href="motion_002etxt.html#motion_002etxt" rel="next" title="motion.txt">
<link href="starting_002etxt.html#starting_002etxt" rel="prev" title="starting.txt">
<style>
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>
<link rel="stylesheet" type="text/css" href="style.css">


</head>

<body lang="ja">
<a name="editing_002etxt"></a>
<div class="header">
<p>
Up: <a href="Mu-Ci-.html#g_t_76ee_6b21" accesskey="u" rel="up">目次</a> &nbsp; [<a href="Indexes-CP.html#Indexes-CP" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<a name="huairunoBian-Ji-toBao-Cun-"></a>
<h2 class="unnumbered">ファイルの編輯と保存</h2>
<pre class="verbatim">*editing.txt*   For Vim バージョン 8.1.  Last change: 2019 Jun 10


		  VIMリファレンスマニュアル    by Bram Moolenaar
</pre>

<a name="edit_002dfiles"></a><a name="index-edit_002dfiles"></a>
<a name="index-huairunoBian-Ji-"></a>
<a name="huairunoBian-Ji-"></a>
<h3 class="section">ファイルの編輯</h3>

<table>
<tr><td width="50%">1. はじめに</td><td width="50%">|<a href="#edit_002dintro">edit-intro</a>|</td></tr>
<tr><td width="50%">2. ファイルの編輯</td><td width="50%">|<a href="#edit_002da_002dfile">edit-a-file</a>|</td></tr>
<tr><td width="50%">3. 引數リスト</td><td width="50%">|<a href="#argument_002dlist">argument-list</a>|</td></tr>
<tr><td width="50%">4. 書き込み</td><td width="50%">|<a href="#writing">writing</a>|</td></tr>
<tr><td width="50%">5. 書き込みと終了</td><td width="50%">|<a href="#write_002dquit">write-quit</a>|</td></tr>
<tr><td width="50%">6. ダイアログ</td><td width="50%">|<a href="#edit_002ddialogs">edit-dialogs</a>|</td></tr>
<tr><td width="50%">7. カレントディレクトリ</td><td width="50%">|<a href="#current_002ddirectory">current-directory</a>|</td></tr>
<tr><td width="50%">8. バイナリファイルの編輯</td><td width="50%">|<a href="#edit_002dbinary">edit-binary</a>|</td></tr>
<tr><td width="50%">9. 暗號化</td><td width="50%">|<a href="#encryption">encryption</a>|</td></tr>
<tr><td width="50%">10. タイムスタンプ</td><td width="50%">|<a href="#timestamps">timestamps</a>|</td></tr>
<tr><td width="50%">11. ファイル檢索</td><td width="50%">|<a href="#file_002dsearching">file-searching</a>|</td></tr>
</table>

<a name="edit_002dintro"></a><a name="index-edit_002dintro"></a>
<a name="g_t1_002e-hazimeni-1"></a>
<h3 class="section">1. はじめに</h3>

<p>「Vim でファイルを編輯する」とは、以下のことを表す。
</p>
<ol>
<li> バッファへファイルを讀み込む
</li><li> 編輯コマンドによりバッファの內容を變更する
</li><li> バッファをファイルへ書き込む
</li></ol>

<a name="current_002dfile"></a><a name="index-current_002dfile"></a>
<p>バッファを書き込まない限り、元のファイルは變更を受けないままで殘つてゐる。ファイルの編輯を始めると (バッファにファイルを讀み込むと)、そのファイルの名前は「カレントファイル名」として記憶される。これをカレントバッファの名前とも呼ぶ。コマンドラインでは &quot;%&quot; で表せる。|<a href="cmdline_002etxt.html#g_t_003a_005f_0025">:_%</a>|
</p>
<a name="alternate_002dfile"></a><a name="index-alternate_002dfile"></a>
<p>カレントファイル名が既に存在したときは、前の方は「代替ファイル名」になる。これはコマンドラインでは &quot;#&quot; で表され |<a href="cmdline_002etxt.html#g_t_003a_005f_0023">:_#</a>|、|<a href="#CTRL_002d_005e">CTRL-^</a>| を使ふとカレントファイルと代替ファイルを切り替へることができる。ただし |<a href="#g_t_003akeepalt">:keepalt</a>| を使つたときは代替ファイル名は變はらない。代替ファイル名はウィンドウごとに記憶される。
</p>
<a name="g_t_003akeepalt"></a><a name="g_t_003akeepa"></a><a name="index-_003akeepalt"></a>
<a name="index-_003akeepa"></a>
<dl compact="compact">
<dt>:keepalt {cmd}</dt>
<dd><p>現在の代替ファイル名を變へずに {cmd} を實行する。
</p><blockquote>
<p><strong>Note:</strong> <br>
閒接的に呼び出されるコマンド (例へば函數によつて) は代替ファイル名を變へてしまふ。
</p></blockquote>
</dd>
</dl>

<p>全てのファイル名はバッファリストに記憶される。編輯 (例へば &quot;:e filename&quot;) や保存 (例へば &quot;:w filename&quot;) のためにファイル名を入力すると、そのファイル名がリストに追加される。このリストを使へば、どのファイルを編輯したかを覺えておいたり、コマンド <kbd>CTRL-^</kbd> によつてあるファイルから別のファイルへ素早く移行できる (例へばテキストをコピーするとき)。まづファイルの番號を、次に <kbd>CTRL-^</kbd> を打ち込む。
</p>

<a name="CTRL_002dG"></a><a name="g_t_003af"></a><a name="g_t_003afi"></a><a name="g_t_003afile"></a><a name="index-CTRL_002dG"></a>
<a name="index-_003af"></a>
<a name="index-_003afi"></a>
<a name="index-_003afile"></a>
<dl compact="compact">
<dt>CTRL-G または</dt>
<dt>:f[ile]</dt>
<dd><p>カレントファイル名 (これは &quot;<code>:cd</code>&quot; が使はれたとき以外は打ち込まれた通り {譯注: 普通、カレントディレクトリのファイルを編輯するときはパスを省いて打ち込むと思ふが、さうするとパスなしのファイル名になる})、カーソル位置 (これはオプション &rsquo;<samp>ruler</samp>&rsquo; がオフのとき) とファイルの狀態 (讀込專用、變更あり、讀込エラー、新規ファイル) を表示する。このメッセージを短くする方法については、オプション &rsquo;<samp>shortmess</samp>&rsquo; を參照。
</p>
</dd>
<dt>:f[ile]!</dt>
<dd><p>|<a href="#g_t_003afile">:file</a>| と同樣だが、&rsquo;<samp>shortmess</samp>&rsquo; が設定されてゐるときでも名前を切り詰めない。
</p>
</dd>
<dt>{count}CTRL-G</dt>
<dd><p><kbd>CTRL-G</kbd> と同樣だが、カレントファイル名をフルパスで表示する。{count} が 2 以上なら、カレントバッファの番號も表示する。
</p></dd>
</dl>

<a name="g_005fCTRL_002dG"></a><a name="word_002dcount"></a><a name="byte_002dcount"></a><a name="index-g_005fCTRL_002dG"></a>
<a name="index-word_002dcount"></a>
<a name="index-byte_002dcount"></a>
<dl compact="compact">
<dt>g CTRL-G</dt>
<dd><p>カーソルの現在の位置を、列、行、單語、文字、バイト、の 5 種類の單位で表示する。文字數とバイト數が同じのときは文字位置が省略される。
</p>
<p>行の中に畫面上で 1 文字分以上の幅を占める文字 (&lt;Tab&gt; または特殊文字) があるときは、「實際」の列番號と畫面上の列番號の兩方が、ダッシュで區切られて表示される {譯注: 例へば、タブ幅 &rsquo;<samp>tabstop</samp>&rsquo; が 8 のとき、行頭の &lt;Tab&gt; の次では「實際」の列番號は 2、畫面上の列番號は 9 となり、&quot;1-8&quot; と表示される}。オプション &rsquo;<samp>ruler</samp>&rsquo; と |<a href="eval_002etxt.html#wordcount_0028_0029">wordcount()</a>| 函數も參照。
</p></dd>
</dl>

<a name="v_005fg_005fCTRL_002dG"></a><a name="index-v_005fg_005fCTRL_002dG"></a>
<dl compact="compact">
<dt>{Visual}g CTRL-G</dt>
<dd><p>&quot;g CTRL-G&quot; と似てゐるが、單語、文字、行、バイトの項目はビジュアル選擇領域內で數へられて表示される。矩形ビジュアルモードでは、何列目かも表示される。
</p>
<p>矩形ビジュアルモードでは桁數も表示される ({Visual} については |<a href="visual_002etxt.html#Visual_002dmode">Visual-mode</a>| を參照。)
</p>
<a name="g_t_003afile_005ff"></a><a name="index-_003afile_005ff"></a>
</dd>
<dt>:f[ile][!] {name}</dt>
<dd><p>カレントファイル名を {name} に設定する。! をつけると |<a href="#g_t_003afile">:file</a>| のやうにメッセージを切り詰めなくなる。
</p>
<p>バッファが名前を持つならその名前が代替ファイル名 |<a href="#alternate_002dfile">alternate-file</a>| になる。元の名前を保持するためにリストされない (unlisted) バッファが作成される。
<a name="g_t_003a0file"></a><a name="index-_003a0file"></a>
</p></dd>
<dt>:0f[ile][!]</dt>
<dd><p>カレントバッファの名前を削除する。! をつけると |<a href="#g_t_003afile">:file</a>| のやうにメッセージを切り詰めなくなる。
</p>
</dd>
<dt>:buffers</dt>
<dt>:files</dt>
<dt>:ls</dt>
<dd><p>現在認識してゐるファイル名を全て一覽表示する。|<a href="windows_002etxt.html#windows_002etxt">windows.txt</a>| |<a href="windows_002etxt.html#g_t_003afiles">:files</a>| |<a href="windows_002etxt.html#g_t_003abuffers">:buffers</a>| |<a href="windows_002etxt.html#g_t_003als">:ls</a>| を參照。
</p></dd>
</dl>

<p>Vim は入力したファイル名のフルパス名を記憶してゐる。ファイル名が表示されるとき、大抵は打ち込んだ名前だけが表示されるが、コマンド |<a href="#g_t_003acd">:cd</a>| でディレクトリを移動した後では、フルパス名が使はれる。
</p>
<a name="home_002dreplace"></a><a name="index-home_002dreplace"></a>
<p>環境變數 <code>$HOME</code> が設定されてゐて、ファイル名がその文字列で始まつてゐるならば、ファイル名のその部分は &quot;~&quot; に置き換へられて表示される。これはファイル名を短くするためである。ファイルを讀み書きするときはフルパス名が使はれ、&quot;~&quot; はファイル名を表示するときだけ使はれる。ファイル名の置き換へを行つたところ &quot;~&quot; だけになつてしまふときは、代はりに &quot;~/&quot; が使はれる (オプション &rsquo;<samp>backupext</samp>&rsquo; が &quot;~&quot; に設定されたときに混亂を防ぐため)。
</p>
<p>バッファを書き出すとき、既定ではカレントファイル名を用ゐる。そのため、コマンド &quot;ZZ&quot; や &quot;:wq&quot; を使ふと、元のファイルは上書きされてしまふことになる。これを望まないならば、コマンド &quot;:write&quot; の引數にファイル名を與へることで、バッファを別のファイルに書き出せる。例:
</p>
<div class="example">
<pre class="example">vim テスト用 {譯注: これはシェルに對して}
[コマンドでバッファを編輯する]
:w 新ファイル
:q
</pre></div>

<p>かうすると &quot;新ファイル&quot; が生成されるが、これは &quot;テスト用&quot; を編輯してコピーしたものである。ファイル &quot;テスト用&quot; は變更されないまま殘る。しかしどちらにしろ、オプション &rsquo;<samp>backup</samp>&rsquo; がオンのときは、Vim は元のファイルを上書きする前に、元のファイルの名前を變更するかコピーする。元のファイルが必要なことに氣づいたときは、このファイルを使へる。&rsquo;<samp>patchmode</samp>&rsquo; も參照。普通、バックアップファイルの名前は元のファイル名に &rsquo;<samp>backupext</samp>&rsquo; を追加したものである。既定値は &quot;~&quot; といふ妙なものだが、これはたまたま存在してゐるファイルに上書きするのを避けるためである。&quot;.bak&quot; の方がよければ、&rsquo;<samp>backupext</samp>&rsquo; を變更すること。MS-DOS 機等で、MS-DOS 系のファイルシステム (例へば、messydos や crossdos ) が使はれてゐることが檢出されたときや、&rsquo;<samp>shortname</samp>&rsquo; がオンのときには、餘分なドットは &rsquo;_&rsquo; に置き換へられる。&rsquo;<samp>backupdir</samp>&rsquo; を設定することで、バックアップファイルを他のディレクトリに置くことができる。
</p>
<a name="auto_002dshortname"></a><a name="index-auto_002dshortname"></a>
<blockquote>
<p><strong>技術的情報:</strong> <br>
Amiga ではファイル名に 30 文字まで使へる。しかし MS-DOS 互換のファイルシステムで有效なのは 8 文字＋ 3 文字に過ぎない。Vim は &quot;.swp&quot; ファイルを生成するときにファイルシステムの判別を試みる。MS-DOS 系のファイルシステムと思はれるときは、&rsquo;<samp>shortname</samp>&rsquo; をオンにするのと同じ效果を持つフラグがオンになる。このフラグは新ファイルの編輯を開始するとすぐにオフにされる。このフラグはカレントファイルのための &quot;.swp&quot; ファイルと &quot;.~&quot; ファイルの名前を作るときに使はれる。しかし、ユーザーが普通のファイルシステムで編輯作業を行ひ、MS-DOS 系のファイルシステムに保存するときには、フラグはオンにならない。そのときは、&quot;.~&quot; ファイルの生成が失敗してエラーメッセージが表示される。そのときはオプション &rsquo;<samp>shortname</samp>&rsquo; を使ふこと。
</p></blockquote>

<p>ファイル名を指定せずに編輯を始めたときは、メッセージ欄に &quot;[無題]&quot; と表示される。コマンド &quot;<code>:write</code>&quot; がファイル名引數付きで使はれたときは、そのファイル名がカレントファイルのファイル名に設定される。
</p>
<p>かうなるのはフラグ &rsquo;<var>F</var>&rsquo; |<a href="options_002etxt.html#cpo_002dF">cpo-F</a>| がオプション &rsquo;<samp>cpoptions</samp>&rsquo; に含まれてゐるときだけである (既定では含まれてゐる)。これは空のバッファにテキストを入力してから、それをファイルに保存するときに便利である。
</p>
<p>&rsquo;<samp>cpoptions</samp>&rsquo; が &rsquo;<var>f</var>&rsquo; |<a href="options_002etxt.html#cpo_002df">cpo-f</a>| を含んでゐるときは (既定では含まれて「ゐない」)、&quot;<code>:read file</code>&quot; でファイル名が設定される。これは引數なしで Vim を起動してから、&quot;<code>:read file</code>&quot; でファイルの編輯を開始するときに便利である。
</p>
<p>ファイル名が設定されてゐて &rsquo;<samp>filetype</samp>&rsquo; が空のとき、ファイルタイプ判別オートコマンドが發生する。
<a name="not_002dedited"></a><a name="index-not_002dedited"></a>
ファイル名が設定されるのはその名前のファイルの編輯を本當に始めるより前なので、そのファイルを誤つて上書きしないやうになつてゐる。これはフラグ &quot;<var>notedited</var>&quot; を設定することで可能になる。このフラグの狀態はコマンド <kbd>CTRL-G</kbd> か &quot;<code>:file</code>&quot; で確認できる。フラグ &quot;<var>notedited</var>&quot; がオンのときは &quot;[Not edited]&quot; と表示される。カレントファイルの名前でバッファ內容を書き出すとき (&quot;<code>:w!</code>&quot; で)、フラグ &quot;<var>notedited</var>&quot; はオフに設定される。
</p>
<a name="abandon"></a><a name="index-abandon"></a>
<p>Vim はバッファが變更されたかどうかを記憶してゐて、變更點が誤つて失はれないやうになつてゐる。保存せずに終了しようとしたり、別のファイルの編輯を開始しようとすると、Vim は拒否する。この保護を無效にするためには、コマンドに &rsquo;!&rsquo; を追加すること。その場合、變更は失はれる。例へばバッファの內容が變更されてゐるとき、&quot;<code>:q</code>&quot; は使へないが &quot;<code>:q!</code>&quot; は使へる。バッファの內容が變更されたかどうかを見るためにはコマンド <kbd>CTRL-G</kbd> を使ふこと。バッファが變更されてゐたときは、メッセージに文字列 &quot;[變更あり]&quot;、&rsquo;m&rsquo; フラグが &rsquo;<samp>shortmess</samp>&rsquo; のときは &quot;+&quot; が含まれる。
</p>
<p>確認なしで變更を保存してほしいなら、オプション &rsquo;<samp>autowriteall</samp>&rsquo; をオンにすること。關聯するオプションには &rsquo;<samp>autowrite</samp>&rsquo; があるが、これは Vi 互換で、全てのコマンドに對して動作するわけではない。
</p>
<p>變更されたバッファを保存せずにそのままにしておきたいなら、オプション &rsquo;<samp>hidden</samp>&rsquo; をオンにすること。|<a href="windows_002etxt.html#hidden_002dbuffer">hidden-buffer</a>| を參照。いくつかのコマンドは &rsquo;<samp>hidden</samp>&rsquo; がオンになつてゐなくてもこのやうに振る舞ふので、コマンドについてはヘルプを參照。
</p>
<a name="edit_002da_002dfile"></a><a name="index-edit_002da_002dfile"></a>
<a name="index-huairunoBian-Ji--1"></a>
<a name="g_t2_002e-huairunoBian-Ji-"></a>
<h3 class="section">2. ファイルの編輯</h3>

<a name="g_t_003ae"></a><a name="g_t_003aedit"></a><a name="reload"></a><a name="index-_003ae"></a>
<a name="index-_003aedit"></a>
<a name="index-reload"></a>
<dl compact="compact">
<dt>:e[dit] [++opt] [+cmd]</dt>
<dd><p>カレントファイルを開く。これは Vim 外部でカレントファイルに變更が加へられたとき、開き直すのに便利である。カレントバッファに變更が加へられてゐるのに、オプション &rsquo;<samp>autowriteall</samp>&rsquo; がオフであるか、ファイルが書き込み可能でないときは、實行に失敗する。
</p>
<p>|<a href="#g_t_002b_002bopt">++opt</a>| と |<a href="#g_t_002bcmd">+cmd</a>| も參照。
</p>
<a name="g_t_003aedit_0021"></a><a name="discard"></a><a name="index-_003aedit_0021"></a>
<a name="index-discard"></a>
</dd>
<dt>:e[dit]! [++opt] [+cmd]</dt>
<dd><p>どのやうな場合でもカレントファイルを開く。カレントバッファに對する變更は全て失はれる。これは編輯作業をもう一度最初からやり直したいときに便利である。
</p>
<p>|<a href="#g_t_002b_002bopt">++opt</a>| と |<a href="#g_t_002bcmd">+cmd</a>| も參照。
</p>
<a name="g_t_003aedit_005ff"></a><a name="index-_003aedit_005ff"></a>
</dd>
<dt>:e[dit] [++opt] [+cmd] {file}</dt>
<dd><p>{file} を開く。
</p>
<p>カレントバッファに變更が加へられてゐると實行に失敗する。ただしオプション &rsquo;<samp>hidden</samp>&rsquo; がオンであるときと、&rsquo;<samp>autowriteall</samp>&rsquo; がオンであり、かつファイルが書き込み可能なときには實行できる。
</p>
<p>|<a href="#g_t_002b_002bopt">++opt</a>| と |<a href="#g_t_002bcmd">+cmd</a>| も參照。
</p>
<a name="g_t_003aedit_0021_005ff"></a><a name="index-_003aedit_0021_005ff"></a>
</dd>
<dt>:e[dit]! [++opt] [+cmd] {file}</dt>
<dd><p>どのやうな場合でも {file} を開く。カレントバッファに對する變更は全て失はれる。
</p>
<p>|<a href="#g_t_002b_002bopt">++opt</a>| と |<a href="#g_t_002bcmd">+cmd</a>| も參照。
</p>
</dd>
<dt>:e[dit] [++opt] [+cmd] #[count]</dt>
<dd><p>[count] 番目のバッファ (コマンド |<a href="windows_002etxt.html#g_t_003afiles">:files</a>| で表示されるもの) を開く。このコマンドは [count] <kbd>CTRL-^</kbd> と同じである。しかし代替バッファがファイル名を持たないと &quot;<code>:e #</code>&quot; は機能しないが、<kbd>CTRL-^</kbd> はそのときも機能する。
</p>
<p>|<a href="#g_t_002b_002bopt">++opt</a>| と |<a href="#g_t_002bcmd">+cmd</a>| も參照。
</p>
<a name="g_t_003aene"></a><a name="g_t_003aenew"></a><a name="index-_003aene"></a>
<a name="index-_003aenew"></a>
</dd>
<dt>:ene[w]</dt>
<dd><p>無名のバッファの編輯を新規に開始する。カレントバッファに變更が加へられてゐると實行に失敗する。ただしオプション &rsquo;<samp>hidden</samp>&rsquo; がオンであるときと、&rsquo;<samp>autowriteall</samp>&rsquo; がオンであり、かつファイルが書き込み可能なときには實行できる。
</p>
<p>&rsquo;<samp>fileformats</samp>&rsquo; の値が空でないとき、その先頭の形式が新バッファに適用される。&rsquo;<samp>fileformats</samp>&rsquo; の値が空のときは、カレントバッファの &rsquo;<samp>fileformat</samp>&rsquo; の値が使はれる。
</p>
<a name="g_t_003aene_0021"></a><a name="g_t_003aenew_0021"></a><a name="index-_003aene_0021"></a>
<a name="index-_003aenew_0021"></a>
</dd>
<dt>:ene[w]!</dt>
<dd><p>無名のバッファの編輯を新規に開始する。カレントバッファに對する變更は全て失はれる。
</p>
<p>オプション &rsquo;<samp>fileformat</samp>&rsquo; の値はコマンド |<a href="#g_t_003aenew">:enew</a>| と同樣に設定される。
</p>
<a name="g_t_003afin"></a><a name="g_t_003afind"></a><a name="index-_003afin"></a>
<a name="index-_003afind"></a>
</dd>
<dt>:fin[d][!] [++opt] [+cmd] {file}</dt>
<dd><p>オプション &rsquo;<samp>path</samp>&rsquo; 內のディレクトリから {file} を探し、それを |<a href="#g_t_003aedit">:edit</a>| する。
</p>
<p>{Vim が |<a href="various_002etxt.html#g_t_002bfile_005fin_005fpath">+file_in_path</a>| 機能付きでコンパイルされたときのみ有效}
</p>
</dd>
<dt>:{count}fin[d][!] [++opt] [+cmd] {file}</dt>
<dd><p>コマンド &quot;<code>:find</code>&quot; と同樣だが、オプション &rsquo;<samp>path</samp>&rsquo; 內のディレクトリで {count} にマッチしたファイルを編輯する。つまり &quot;<code>:2find file</code>&quot; とすると &rsquo;<samp>path</samp>&rsquo; 內で 2 番目に見つかつた &quot;file&quot; を編輯する。&rsquo;<samp>path</samp>&rsquo; 內で見つかつたマッチが {count} より少ないと、エラーメッセージが表示される。
</p>
<a name="g_t_003aex"></a><a name="index-_003aex"></a>
</dd>
<dt>:ex [++opt] [+cmd] [file]</dt>
<dd><p>|<a href="#g_t_003aedit">:edit</a>| と同じ。
</p>
<a name="g_t_003avi"></a><a name="g_t_003avisual"></a><a name="index-_003avi"></a>
<a name="index-_003avisual"></a>
</dd>
<dt>:vi[sual][!] [++opt] [+cmd] [file]</dt>
<dd><p>Ex モード內では: Ex モード (|<a href="intro_002etxt.html#Ex_002dmode">Ex-mode</a>|) からノーマルモードに戾る。それ以外はコマンド |<a href="#g_t_003aedit">:edit</a>| と同じ。
</p>
<a name="g_t_003avie"></a><a name="g_t_003aview"></a><a name="index-_003avie"></a>
<a name="index-_003aview"></a>
</dd>
<dt>:vie[w][!] [++opt] [+cmd] file</dt>
<dd><p>Ex モード內では: Ex モード (|<a href="intro_002etxt.html#Ex_002dmode">Ex-mode</a>|) からノーマルモードに戾る。それ以外はコマンド |<a href="#g_t_003aedit">:edit</a>| と同じだが、そのバッファに對してオプション &rsquo;<samp>readonly</samp>&rsquo; をオンにする。
</p>
<a name="CTRL_002d_005e"></a><a name="CTRL_002d6"></a><a name="index-CTRL_002d_005e"></a>
<a name="index-CTRL_002d6"></a>
</dd>
<dt>CTRL-^</dt>
<dd><p>代替ファイルを編輯する。たいていの場合、代替ファイルは前に編輯したファイルである。これを使ふと 2 つのファイル閒を素早く切り替へることができる。これは &quot;<code>:e #</code>&quot; と同じだが、對象のファイル名が無い場合も機能する。
</p>
<p>オプション &rsquo;<samp>autowrite</samp>&rsquo; か &rsquo;<samp>autowriteall</samp>&rsquo; がオンならば、バッファを移動するときに書き込みをする。
</p>
<p>たいていは &quot;^&quot; と &quot;6&quot; は同じキーである。<code class="tt-key">CTRL</code> を押しながら <code class="tt-key">6</code> のキーを押せば <kbd>CTRL-^</kbd> を押したのと同じ效果を得られる。しかし英語排列でないキーボードでは他のキーが割り當てられる。
</p>
</dd>
<dt>{count}CTRL-^</dt>
<dd><p>[count] 番目の代替ファイルを編輯する (コマンド &quot;<code>:e #[count]</code>&quot; と同じ)。[count] が指定されないと、前に編輯したファイルを編輯する。これを使ふと 2 つ (かそれ以上) のファイル閒を素早く行き來できる。
</p>
<p>さらに詳しくは上の |<a href="#CTRL_002d_005e">CTRL-^</a>| を參照。
</p>
<a name="g_t_005df"></a><a name="g_t_005bf"></a><a name="index-_005df"></a>
<a name="index-_005bf"></a>
</dd>
<dt>[count]]f</dt>
<dt>[count][f</dt>
<dd><p>コマンド &quot;gf&quot; と同じ。推奬されない。
</p>
<a name="gf"></a><a name="E446"></a><a name="E447"></a><a name="index-gf"></a>
<a name="index-E446"></a>
<a name="index-E447"></a>
</dd>
<dt>[count]gf</dt>
<dd><p>カーソルの下か後ろの名前のファイルを編輯する。覺え方: &quot;goto file&quot;。
</p>
<p>オプション &rsquo;<samp>isfname</samp>&rsquo; により、どの文字がファイル名に使はれるはずなのかを調べる。ファイル名に續く句讀點の &quot;.,:;!&quot; は無視される。エスケープされた複數のスペース &quot;\ &quot; は 1 つのスペースに減らされる。
</p>
<p>&rsquo;<samp>path</samp>&rsquo; により、ファイルを探すディレクトリ名のリストを調べる。カレントファイルに對して相對的なファイルも探される。
</p>
<p>&rsquo;<samp>suffixesadd</samp>&rsquo; により、擴張子を補つたファイル名を調べる。
ファイルが見つからないと、&rsquo;<samp>includeexpr</samp>&rsquo; によつてファイル名を修正し、再びファイルを探す。
</p>
<p>[count] が指定されると、&rsquo;<samp>path</samp>&rsquo; 內で見つかつた [count] 番目のファイルを編輯する。
</p>
<p>Vim がカレントファイルの破毀 |<a href="#abandon">abandon</a>| を拒否したときは、このコマンドの實行は失敗する。
</p>
<p>このファイルを新しいウィンドウで編輯したいときは |<a href="windows_002etxt.html#CTRL_002dW_005fCTRL_002dF">CTRL-W_CTRL-F</a>| を使ふこと。
新しいファイルを編輯したいならば、次のやうにする。
</p><div class="example">
<pre class="example">:e &lt;cfile&gt;
</pre></div>
<p>どのやうな場合でもコマンド gf を機能させるには、次のやうにする。
</p><div class="example">
<pre class="example">:map gf :e &lt;cfile&gt;&lt;CR&gt;
</pre></div>
<p>カーソル下のファイル名が &quot;type://machine/path&quot; のやうなハイパーテキストリンクであるならば、プラグイン |<a href="pi_005fnetrw_002etxt.html#netrw">netrw</a>| が必要になる。
</p>
<p>Unix では、文字 &rsquo;~&rsquo; は &quot;~user/file&quot; のやうに展開される。環境變數も展開される |<a href="options_002etxt.html#expand_002denv">expand-env</a>|。
</p>
<p>{Vimが |<a href="various_002etxt.html#g_t_002bfile_005fin_005fpath">+file_in_path</a>| 機能付きでコンパイルされたときのみ有效}
</p>
<a name="v_005fgf"></a><a name="index-v_005fgf"></a>
</dd>
<dt>{Visual}[count]gf</dt>
<dd><p>コマンド &quot;gf&quot; と同樣だが、編輯するファイルの名前にはビジュアル選擇されたテキストが使はれる。オプション &rsquo;<samp>isfname</samp>&rsquo; の値は無視される。先頭の空白は無視されるが、それ以外の空白や特殊文字はファイル名に含まれる。({Visual} については |<a href="visual_002etxt.html#Visual_002dmode">Visual-mode</a>| を參照。)
</p>
<a name="gF"></a><a name="index-gF"></a>
</dd>
<dt>[count]gF</dt>
<dd><p>&quot;gf&quot; と同じだが、ファイル名の後に番號があるとき、その行へカーソルが移動する點が異なる。ファイル名と行番號はファイル名でない文字 (&rsquo;<samp>isfname</samp>&rsquo; を參照) かつ數字でない文字で區切られてなければならない。ファイル名、區切り文字、番號の閒の空白文字は無視される。
</p>
<p>例:
</p><pre class="verbatim">eval.c:10
eval.c @ 20
eval.c (30)
eval.c 40
</pre>
<a name="v_005fgF"></a><a name="index-v_005fgF"></a>
</dd>
<dt>{Visual}[count]gF</dt>
<dd><p>&quot;v_gf&quot; と同じ。
</p></dd>
</dl>

<p>以上のコマンドは 1 つのファイルの編輯を開始するために使用される。これはファイルがバッファに讀み込まれ、カレントファイル名が設定されることを意味する。開かれるファイルはカレントディレクトリに依存する。コマンド |<a href="#g_t_003acd">:cd</a>| を參照。
</p>
<p>ファイルが讀み込まれた後に表示されるメッセージの說明については、|<a href="insert_002etxt.html#read_002dmessages">read-messages</a>| を參照。
</p>
<p>バッファ內がめちやめちやになつて最初からもう 1 度やり直したいときには、コマンド &quot;<code>:e!</code>&quot; が使へる。コマンド &quot;<code>:e</code>&quot; が便利なのは、カレントファイル名を變更したときだけである。
</p>
<a name="g_t_003afilename"></a><a name="g_t_007bfile_007d"></a><a name="index-_003afilename"></a>
<a name="index-_007bfile_007d"></a>
<p>ファイル名を指定する場所で使へる特殊なアイテムについては、この節に書かれてゐることの他に |<a href="cmdline_002etxt.html#cmdline_002dspecial">cmdline-special</a>| に書かれてゐる。
</p>
<blockquote>
<p><strong>Note:</strong> <br>
Unix と MS-DOS 以外に對する注意: 1 つのファイル名を受け付けるコマンド (&quot;<code>:edit file</code>&quot; 等) では、ファイル名に空白が入つてゐても構はないが、ファイル名末尾の空白は無視される。これは、空白を含むファイル名が普通にあるシステム (MS-Windows, Amiga 等) では便利である。例: &quot;:e   Long File Name &quot; を實行すると、ファイル &quot;Long File Name&quot; を開く。
</p>
<p>2 つ以上のファイル名を受け付けるコマンド (&quot;<code>:next file1 file2</code>&quot; 等) では、ファイル名內の空白は &rsquo;\&rsquo; でエスケープしなければならない。
</p></blockquote>

<a name="wildcard"></a><a name="wildcards"></a><a name="index-wildcard"></a>
<a name="index-wildcards"></a>
<a name="index-wairudokado"></a>
<p>{file} 內のワイルドカードは展開される。ただし、ファイル名補完と同樣に &rsquo;<samp>wildignore</samp>&rsquo; と &rsquo;<samp>suffixes</samp>&rsquo; が適用される。使用できるワイルドカードの種類はシステムによつて異なる。以下は標準的なものである。
</p><table>
<tr><td width="15%">?</td><td width="85%">あらゆる 1 文字にマッチ</td></tr>
<tr><td width="15%">*</td><td width="85%">何もないのも含め、全てにマッチ</td></tr>
<tr><td width="15%">**</td><td width="85%">何もないのも含め、全てにマッチ。ディレクトリを再歸的にたどる。</td></tr>
<tr><td width="15%">[abc]</td><td width="85%">&rsquo;a&rsquo;, &rsquo;b&rsquo; または &rsquo;c&rsquo; にマッチ</td></tr>
</table>

<p>ワイルドカードとしての特別な意味を無效にするには、前に &rsquo;\&rsquo; を置くこと。しかし MS-Windows では &rsquo;\&rsquo; がパスの區切り文字なので、オプション &rsquo;<samp>isfname</samp>&rsquo; の値に &quot;[&quot; が含まれてゐると、&quot;path\[abc]&quot; はワイルドカード扱ひになつてしまふ。これを避ける單純な方法は、&quot;path\[[]abc]&quot; とすることである。すると文字通りのファイル &quot;path[abc]&quot; を編輯できる。
</p>
<a name="starstar_002dwildcard"></a><a name="index-starstar_002dwildcard"></a>
<p>&quot;**&quot; の展開は、Unix, Win32, Mac OS/X、その他數種類のシステムでのみ使用できる。&quot;**&quot; はディレクトリツリーを再歸的に檢索する。深さの上限は 100 ディレクトリである。
</p><blockquote>
<p><strong>Note:</strong> <br>
いくつかのコマンドでは、この擧動が少し異なる。|<a href="#file_002dsearching">file-searching</a>| を參照。
</p></blockquote>
<p>例:
</p><div class="example">
<pre class="example">:n **/*.txt
</pre></div>
<p>これは次のファイルにマッチする:
</p><pre class="verbatim">aaa.txt
subdir/bbb.txt
a/b/c/d/ccc.txt
</pre><p>&quot;**&quot; の直前または直後にワイルドカード以外の文字が使用されてゐる場合、これらはトップディレクトリでのみマッチする。これらは、ツリーのさらに下のディレクトリには使用されない。例:
</p><div class="example">
<pre class="example">:n /usr/inc**/types.h
</pre></div>
<p>これは次のファイルにマッチする:
</p><pre class="verbatim">/usr/include/types.h
/usr/include/sys/types.h
/usr/inc/old/types.h
</pre><blockquote>
<p><strong>Note:</strong> <br>
&quot;/inc&quot; とマッチする必要がないため、&quot;/sys&quot; を含むパスが含まれてゐる。したがつて、&quot;/usr/inc*/inc*/inc*&quot; ではなく、&quot;/usr/inc*/*/*...&quot; にマッチするやうなものである。
</p></blockquote>

<a name="backtick_002dexpansion"></a><a name="g_t_0060_002dexpansion"></a><a name="index-backtick_002dexpansion"></a>
<a name="index-_0060_002dexpansion"></a>
<p>Unix などではファイル名の引數にバッククォート &rsquo;&lsquo;&rsquo; も使へる。例:
</p><div class="example">
<pre class="example">:next `find . -name ver\\*.c -print`
:view `ls -t *.patch  \| head -n1`
</pre></div>
<p>Vim はバッククォート內のコマンドをシェルで實行し、その標準出力を Vim コマンドの引數とする。(シェルからのエラーメッセージは破毀される。)
</p>
<p>Vim が何のシェルコマンドを實行してゐるか確認するためには、&rsquo;<samp>verbose</samp>&rsquo; オプションに 4 を設定する。シェルコマンドが 0 以外の終了コードを返した場合、エラーメッセージが表示され Vim コマンドは中斷される。これを防ぐためには、次のやうにしてシェルが常に 0 を返すやうにする:
</p><div class="example">
<pre class="example">:next `find . -name ver\\*.c -print \|\| true`
</pre></div>

<p>アスタリスク &rsquo;*&rsquo; の前の &rsquo;\&rsquo; は、シェルが find を實行する前に &quot;ver*.c&quot; を展開してしまふのを防ぐために必要となる。シェルのパイプ記號 &quot;|&quot; の前のバックスラッシュは Vim がコマンドの終はりとしてパースするのを防ぐ。
</p>
<p>これは、必ず項目全體がバッククォートで括られてゐるといふ制限付きで、他の多くのシステムでも機能する。最初のバッククォートの直前や最後のバッククォートの直後に文字列を書くことはできない。
</p>
<a name="g_t_0060_003d"></a><a name="index-_0060_003d"></a>
<p>バッククォート內を、外部コマンドとしてではなく Vim の式として展開させることもできる。そのためには初めのバッククォートのすぐ後に等號を置けばよい。例:
</p><div class="example">
<pre class="example">:e `=tempname()`
</pre></div>
<p>この式はほとんど何を含んでもよい。そのため、これを使つて &rsquo;&quot;&rsquo;, &rsquo;|&rsquo;, &rsquo;%&rsquo;, &rsquo;#&rsquo; の特別な意味を打ち消すこともできる。ただし、他のワイルドカードと同樣に &rsquo;<samp>wildignore</samp>&rsquo; は適用される。
</p>
<p>この式の中の環境變數は式が評價される時に展開される。したがつてこれは機能する:
</p><div class="example">
<pre class="example">:e `=$HOME . '/.vimrc'`
</pre></div>
<p>これは機能しない。<code>$HOME</code> は文字列內にあり、文字通りに用ゐられる:
</p><div class="example">
<pre class="example">:e `='$HOME' . '/.vimrc'`
</pre></div>

<p>式が文字列を返したときは名前は改行で區切られる。式の結果がリスト (|<a href="eval_002etxt.html#List">List</a>|) のときは各要素が名前として扱はれる。改行によつても名前は區切られる。
</p><blockquote>
<p><strong>Note:</strong> <br>
そのやうな式はファイル名が Ex コマンドの引數として期待される場所でのみサポートされる。
</p></blockquote>

<a name="g_t_002b_002bopt"></a><a name="g_t_005b_002b_002bopt_005d"></a><a name="index-_002b_002bopt"></a>
<a name="index-_005b_002b_002bopt_005d"></a>
<p>引數のうち [++opt] はオプション &rsquo;<samp>fileformat</samp>&rsquo;, &rsquo;<samp>fileencoding</samp>&rsquo; または &rsquo;<samp>binary</samp>&rsquo; の値を、そのコマンドに限つてある値に指定し、不正な文字への對應を指定するために使はれる。指定の形式は次の通り。
</p><pre class="verbatim">++{optname}
</pre><p>または
</p><pre class="verbatim">++{optname}={value}
</pre>
<a name="g_t_002b_002bff"></a><a name="g_t_002b_002benc"></a><a name="g_t_002b_002bbin"></a><a name="g_t_002b_002bnobin"></a><a name="g_t_002b_002bedit"></a><a name="index-_002b_002bff"></a>
<a name="index-_002b_002benc"></a>
<a name="index-_002b_002bbin"></a>
<a name="index-_002b_002bnobin"></a>
<a name="index-_002b_002bedit"></a>
<p>{optname} は次のうちのどれか:
</p><table>
<tr><td width="40%">ff または fileformat</td><td width="60%">&rsquo;<samp>fileformat</samp>&rsquo; を指定</td></tr>
<tr><td width="40%">enc または encoding</td><td width="60%">&rsquo;<samp>fileencoding</samp>&rsquo; を指定</td></tr>
<tr><td width="40%">bin または binary</td><td width="60%">&rsquo;<samp>binary</samp>&rsquo; を指定</td></tr>
<tr><td width="40%">nobin または nobinary</td><td width="60%">&rsquo;<samp>binary</samp>&rsquo; を無效にする</td></tr>
<tr><td width="40%">bad</td><td width="60%">不正な文字への對應を指定する</td></tr>
<tr><td width="40%">edit</td><td width="60%">|<a href="insert_002etxt.html#g_t_003aread">:read</a>| 用。ファイルを編輯するときと同じやうにオプションの値を保つ。</td></tr>
</table>

<p>{value} に空白を含めてはいけない。値は、そのオプションに對して適切なものなら何でもよい。例:
</p><div class="example">
<pre class="example">:e ++ff=unix
</pre></div>
<p>かうすると &rsquo;<samp>fileformat</samp>&rsquo; を &quot;<var>unix</var>&quot; に設定して同じファイルを編輯し直す。
</p><div class="example">
<pre class="example">:w ++enc=latin1 newfile
</pre></div>
<p>かうするとカレントバッファの內容を latin1 の文字コードで &quot;newfile&quot; に書き出す。
</p>
<p>引數 [++opt] は空白で區切つて複數指定してもよい。それらはみな引數 |<a href="#g_t_002bcmd">+cmd</a>| より前に指定しなければならない。
</p>
<a name="g_t_002b_002bbad"></a><a name="index-_002b_002bbad"></a>
<p>&quot;++bad=&quot; の引數は、變換できない文字と不正なバイトをどうするかを指定する。とりうる値は次の3つのうちどれかである:
</p><table>
<tr><td width="20%">++bad=X</td><td width="80%">不正な文字をこの 1 バイト文字で置き換へる。</td></tr>
<tr><td width="20%">++bad=keep</td><td width="80%">不正な文字を變換せずにそのままにしておく。
<blockquote>
<p><strong>Note:</strong> <br>
これを使ふとテキスト中に不正なバイトが現れることになる。
</p></blockquote></td></tr>
<tr><td width="20%">++bad=drop</td><td width="80%">不正な文字を削除する。</td></tr>
</table>

<p>既定値は &quot;++bad=?&quot; となつてゐる。つまり、不正な文字をそれぞれクエスチョンマークで置き換へる。逆クエスチョンマーク (latin-1 の 0xBF) が使はれる場所もある。
</p>
<blockquote>
<p><strong>Note:</strong> <br>
++bad をつけてエラーにならなかつたとしても、すべてのコマンドが ++bad に對應してゐるわけではない。例 |<a href="#g_t_003awrite">:write</a>|。
</p></blockquote>

<blockquote>
<p><strong>Note:</strong> <br>
讀み込み時に上の方法で &rsquo;<samp>fileformat</samp>&rsquo; と &rsquo;<samp>fileencoding</samp>&rsquo; を指定すると、それらは以後その値に設定されることに注意。書き込み時に設定してもさうはならず、次に書き込むときには以前の値が使はれる。&rsquo;<samp>binary</samp>&rsquo; オプションも同樣。
</p></blockquote>


<a name="g_t_002bcmd"></a><a name="g_t_005b_002bcmd_005d"></a><a name="index-_002bcmd"></a>
<a name="index-_005b_002bcmd_005d"></a>
<p>引數 [+cmd] は、新しく開いたファイルでカーソルの位置を指定したり、他のあらゆるコマンドを實行するために使はれる:
</p><table>
<tr><td width="25%">+</td><td width="75%">最後の行で編輯を開始する。</td></tr>
<tr><td width="25%">+{num}</td><td width="75%">{num} 行目で編輯を開始する。</td></tr>
<tr><td width="25%">+/{pat}</td><td width="75%">{pat} を含んだ最初の行で編輯を開始する。</td></tr>
<tr><td width="25%">+{command}</td><td width="75%">新しいファイルを開いた後に {command} を實行する。{command} には任意の Ex コマンドが使へる。</td></tr>
</table>
<p>{pat} や {command} に空白を含めるためには、その前に &rsquo;\&rsquo; を付ける。&rsquo;\&rsquo; そのものを使ふには、2 回ずつ繰り返すこと。
</p><div class="example">
<pre class="example">:edit  +/The\ book           ファイル
:edit  +/dir\ dirname\\      ファイル
:edit  +set\ dir=c:\\\\temp  ファイル
</pre></div>
<blockquote>
<p><strong>Note:</strong> <br>
最後の例では &rsquo;\&rsquo; の繰り返しが 2 回行はれてゐることに注意。&quot;+cmd&quot; の引數なので 1 回、コマンド &quot;:set&quot; のためにもう 1 回だ。
</p></blockquote>

<a name="file_002dformats"></a><a name="index-file_002dformats"></a>
<p>オプション &rsquo;<samp>fileformat</samp>&rsquo; はファイルに對して &lt;EOL&gt; の形式を設定する。
</p><table>
<tr><td width="30%">&rsquo;<samp>fileformat</samp>&rsquo;</td><td width="45%">&lt;EOL&gt;の文字</td><td width="25%">形式の名稱
<a name="DOS_002dformat"></a><a name="index-DOS_002dformat"></a></td></tr>
<tr><td width="30%">&quot;dos&quot;</td><td width="45%">&lt;CR&gt;&lt;NL&gt; または &lt;NL&gt;</td><td width="25%">DOS形式
<a name="Unix_002dformat"></a><a name="index-Unix_002dformat"></a></td></tr>
<tr><td width="30%">&quot;unix&quot;</td><td width="45%">&lt;NL&gt;</td><td width="25%">Unix形式
<a name="Mac_002dformat"></a><a name="index-Mac_002dformat"></a></td></tr>
<tr><td width="30%">&quot;mac&quot;</td><td width="45%">&lt;CR&gt;</td><td width="25%">Mac形式</td></tr>
</table>
<p>以前はオプション &rsquo;<samp>textmode</samp>&rsquo; が使はれてゐた。現在ではそれは時代遲れである。
</p>
<p>ファイルを讀み込むときに、上で述べた文字は &lt;EOL&gt; として解釋される。DOS 形式 (MS-DOS、OS/2 と Win32 での既定値) では、&lt;CR&gt;&lt;NL&gt; と &lt;NL&gt; の兩方が &lt;EOL&gt; と解釋される。
</p><blockquote>
<p><strong>Note:</strong> <br>
DOS 形式でファイルを保存するときには、&lt;NL&gt; 1 個ごとに對して &lt;CR&gt; が追加されることに注意。|<a href="insert_002etxt.html#file_002dread">file-read</a>| も參照。
</p></blockquote>

<p>ファイルを書き込むときには、上で述べた文字が &lt;EOL&gt; として使はれる。DOS 形式では &lt;CR&gt;&lt;NL&gt; が使はれる。|<a href="#DOS_002dformat_002dwrite">DOS-format-write</a>| も參照。
</p>
<p>DOS 形式でファイルを讀み込んで、Unix 形式でそれを保存することも可能である。(&rsquo;<samp>fileformats</samp>&rsquo; が &quot;dos&quot; を含んでゐると假定すると) 以下の操作は全ての &lt;CR&gt;&lt;NL&gt; を &lt;NL&gt; で置き換へることになる。
</p><div class="example">
<pre class="example">:e ファイル
:set fileformat=unix
:w
</pre></div>
<p>(&rsquo;<samp>fileformats</samp>&rsquo; の値に &quot;unix&quot; が含まれてゐるとき) Unix 形式でファイルを讀み込んで、DOS 形式で保存すると、&lt;NL&gt; は全て &lt;CR&gt;&lt;NL&gt; で置き換へられる。
</p><div class="example">
<pre class="example">:e ファイル
:set fileformat=dos
:w
</pre></div>

<p>新しいファイルの編輯を開始したときオプション &rsquo;<samp>fileformats</samp>&rsquo; の値が空でないならば (それがデフォルト)、Vim はファイルが指定された形式で改行されてゐるかどうか檢出を試みる。値が &quot;<var>unix</var>,<var>dos</var>&quot; であるときは、Vim は 1 個の &lt;NL&gt; (Unix と Amiga 形式) か &lt;CR&gt;&lt;NL&gt; の組 (MS-DOS 形式) が使はれるものとして行を調べる。全ての行が &lt;CR&gt;&lt;NL&gt; で終はつてゐるときだけ、&rsquo;<samp>fileformat</samp>&rsquo; の値は &quot;<var>dos</var>&quot; に設定され、さうでなければ &quot;<var>unix</var>&quot; に設定される。&rsquo;<samp>fileformats</samp>&rsquo; の値が &quot;<var>mac</var>&quot; を含んでゐて、ファイルに &lt;NL&gt; が 1 個も見つからないときは、&rsquo;<samp>fileformat</samp>&rsquo; の値は &quot;<var>mac</var>&quot; に設定される。
</p>
<p>&rsquo;<samp>fileformat</samp>&rsquo; の値が MS-DOS 以外のシステム上で &quot;<var>dos</var>&quot; に設定されると、普通でないことが起きてゐることを氣づかせるために、メッセージ &quot;[dosフォーマット]&quot; が表示される。&rsquo;<samp>fileformat</samp>&rsquo; の値が &quot;<var>unix</var>&quot; であると、MS-DOSシステムでは &quot;[unixフォーマット]&quot; のメッセージが表示される。&rsquo;<samp>fileformat</samp>&rsquo; の値が &quot;<var>mac</var>&quot; であると、Macintosh 以外の全てのシステムでは、メッセージ &quot;[macフォーマット]&quot; が表示される。
</p>
<p>オプション &rsquo;<samp>fileformats</samp>&rsquo; の値が空で、DOS 形式が使用されてゐるが、ファイルを讀み込んでゐるときにいくつかの行が &lt;CR&gt;&lt;NL&gt; で終はつてゐなかつたならば、ファイルのメッセージ內に &quot;[CR無]&quot; が含まれる。
</p>
<p>&rsquo;<samp>fileformats</samp>&rsquo; の値が空で、Mac 形式が使用されてゐるが、ファイルを讀み込んでゐるときに &lt;NL&gt; が見つかつたならば、ファイルのメッセージ內に &quot;[NL無]&quot; が含まれる。
</p>
<p>新しいファイルが存在しないと、&rsquo;<samp>fileformats</samp>&rsquo; の値が空のときにはカレントバッファの &rsquo;<samp>fileformat</samp>&rsquo; の値が使はれる。さうでなければ、&rsquo;<samp>fileformats</samp>&rsquo; 內の 1 番目の形式が新しいファイルに對して用ゐられる。
</p>
<p>實行可能ファイルやバイナリファイル、Vim script ファイルを編輯する前には、オプション &rsquo;<samp>binary</samp>&rsquo; をオンに設定するべきだ。これにはオプション &quot;-b&quot; を付けて Vim を起動するのが簡單である。かうすると &rsquo;<samp>fileformat</samp>&rsquo; が使はれなくなる。こうしないと 1 個の &lt;NL&gt; が不意に &lt;CR&gt;&lt;NL&gt; で置き換へられてしまふことを覺悟しなければならない。
</p>
<p>オプション &rsquo;<samp>key</samp>&rsquo; をオンに設定することで、保存されるファイルを暗號化できる。これは他人がユーザーのファイルを讀むことに對して、ある程度の安全を保證する。|<a href="#encryption">encryption</a>|
</p>

<a name="argument_002dlist"></a><a name="arglist"></a><a name="index-argument_002dlist"></a>
<a name="index-arglist"></a>
<a name="index-Yin-Shu-risuto"></a>
<a name="g_t3_002e-Yin-Shu-risuto"></a>
<h3 class="section">3. 引數リスト</h3>

<p>Vim の開始時に複數のファイル名を與へると、それらは引數リストとして記憶される。リスト內のファイルにはどれでも移動できる。
</p>
<p>これをコマンド |<a href="windows_002etxt.html#g_t_003abuffers">:buffers</a>| で表示されるバッファリストと混同してはいけない。引數リストは Vi から既にあつたが、バッファリストは Vim で新たに導入された。引數リスト內のファイルはバッファリストにも含まれる (コマンド |<a href="windows_002etxt.html#g_t_003abdel">:bdel</a>| や |<a href="windows_002etxt.html#g_t_003abwipe">:bwipe</a>| で消去されない限り)。逆にバッファリスト內のファイルが引數リストに含まれないことは普通にある。
</p>
<p>この話題はユーザーマニュアルの第 |<a href="usr_005f07_002etxt.html#g_t07_002e2">07.2</a>| 章で紹介されてゐる。
</p>
<p>グローバルな引數リストが 1 個あり、これは既定では全てのウィンドウに使はれる。ウィンドウについてローカルな引數リストを新たに創ることもできる。|<a href="#g_t_003aarglocal">:arglocal</a>| を參照。
</p>
<p>引數リストは以下のコマンド及び expression 用函數 |<a href="eval_002etxt.html#argc_0028_0029">argc()</a>| と |<a href="eval_002etxt.html#argv_0028_0029">argv()</a>| で利用できる。これらはみなカレントウィンドウの引數リストに對して働く。
</p>
<a name="g_t_003aar"></a><a name="g_t_003aarg"></a><a name="g_t_003aargs"></a><a name="index-_003aar"></a>
<a name="index-_003aarg"></a>
<a name="index-_003aargs"></a>
<dl compact="compact">
<dt>:ar[gs]</dt>
<dd><p>引數リストを表示する。カレントファイルは &rsquo;[&rsquo; &rsquo;]&rsquo; で挾まれて表示される。
</p>
<a name="g_t_003aargs_005ff"></a><a name="index-_003aargs_005ff"></a>
</dd>
<dt>:ar[gs] [++opt] [+cmd] {arglist}</dt>
<dd><p>{arglist} を新たな引數リストとして定義し、そのうち最初のファイルの編輯を始める。變更點があり、Vim がカレントバッファを抛棄 |<a href="#abandon">abandon</a>| したくないときには失敗する。
</p>
<p>|<a href="#g_t_002b_002bopt">++opt</a>| と |<a href="#g_t_002bcmd">+cmd</a>| も參照。
</p>
<a name="g_t_003aargs_005ff_0021"></a><a name="index-_003aargs_005ff_0021"></a>
</dd>
<dt>:ar[gs]! [++opt] [+cmd] {arglist}</dt>
<dd><p>{arglist} を新たな引數リストとして定義し、そのうち最初のファイルの編輯を始める。カレントバッファに對する變更點は全て失はれる。
</p>
<p>|<a href="#g_t_002b_002bopt">++opt</a>| と |<a href="#g_t_002bcmd">+cmd</a>| も參照。
</p>
<a name="g_t_003aarge"></a><a name="g_t_003aargedit"></a><a name="index-_003aarge"></a>
<a name="index-_003aargedit"></a>
</dd>
<dt>:[count]arge[dit][!] [++opt] [+cmd] {name} ..</dt>
<dd><p>引數リストに {name}s を追加し、その編輯を始める。{name} が既に引數リスト內にあるときは、その編輯を始める。これはコマンド |<a href="#g_t_003aargadd">:argadd</a>| を使ひ、次に |<a href="#g_t_003aedit">:edit</a>| を使ふのと同じである。
</p>
<p>ファイル名中のスペースは &quot;\&quot; でエスケープされなければならない。
</p>
<p>[count] は |<a href="#g_t_003aargadd">:argadd</a>| と同樣に使はれる。
</p>
<p>もしもカレントファイルが抛棄 |<a href="#abandon">abandon</a>| することができないなら、編輯されてゐないことを除いて、引數リストに {name}s が加へられる。複製の終了はチェックしない。
</p>
<p>|<a href="#g_t_002b_002bopt">++opt</a>| と |<a href="#g_t_002bcmd">+cmd</a>| も參照。
</p>
<a name="g_t_003aarga"></a><a name="g_t_003aargadd"></a><a name="E479"></a><a name="index-_003aarga"></a>
<a name="index-_003aargadd"></a>
<a name="index-E479"></a>
</dd>
<dt>:[count]arga[dd] {name} ..</dt>
<dt>:[count]arga[dd]</dt>
<dd><p>引數リストに {name} を追加する。{name} が省略された時は引數リストに現在のバッファ名を追加する。
[count] が省かれると {name} は引數リストの現在の項目の次に插入される。指定されると [count] 番目の項目の次に插入される。引數リストが &quot;a b c&quot; で &quot;b&quot; が現在の引數の場合のコマンドの結果一覽:
</p><table>
<tr><td width="50%">コマンド</td><td width="50%">新たな引數リスト</td></tr>
<tr><td width="50%">:argadd x</td><td width="50%">a b x c</td></tr>
<tr><td width="50%">:0argadd x</td><td width="50%">x a b c</td></tr>
<tr><td width="50%">:1argadd x</td><td width="50%">a x b c</td></tr>
<tr><td width="50%">:$argadd x</td><td width="50%">a b c x</td></tr>
</table>
<p>最後の 1 つの後に:
</p><table>
<tr><td width="50%">:+2argadd y</td><td width="50%">a b c x y</td></tr>
</table>
<p>重複檢査はないので、1 個のファイルを引數リストに 2 回加へることもできる。現在編輯中のファイルは變更されない。
</p><blockquote>
<p><strong>Note:</strong> <br>
次の方法が使へることに注意。
</p><div class="example">
<pre class="example">:args ## x
</pre></div>
<p>これは項目 &quot;x&quot; を追加し、新たなリストを竝び替へる。
</p></blockquote>

<a name="g_t_003aargd"></a><a name="g_t_003aargdelete"></a><a name="E480"></a><a name="index-_003aargd"></a>
<a name="index-_003aargdelete"></a>
<a name="index-E480"></a>
</dd>
<dt>:argd[elete] {pattern} ..</dt>
<dd><p>{pattern} にマッチするファイルを引數リストから削除する。{pattern} の意味はファイルパターンと同樣なので、|<a href="autocmd_002etxt.html#file_002dpattern">file-pattern</a>| を參照。現在の項目を削除するには &quot;%&quot; が使へる。
</p>
<p>このコマンドは現在編輯中のファイルが引數リストから削除されたときでも、それをそのままに保つ。
</p>
<p>例:
</p><div class="example">
<pre class="example">:argdel *.obj
</pre></div>

</dd>
<dt>:[range]argd[elete]</dt>
<dd><p>引數リストから {range} の範圍のファイルを削除する。
</p>
<p>例:
</p><div class="example">
<pre class="example">:10,$argdel
</pre></div>
<p>10 以降が削除され、1 から 9 は殘る。
</p><div class="example">
<pre class="example">:$argd
</pre></div>
<p>最後の引數を削除する。
</p><div class="example">
<pre class="example">:argd
:.argd
</pre></div>
<p>現在の引數を削除する。
</p><div class="example">
<pre class="example">:%argd
</pre></div>
<p>引數リストから全てのファイルを削除する。範圍の上限が大きすぎるときは、最後の引數までが削除される。
</p>
<a name="g_t_003aargu"></a><a name="g_t_003aargument"></a><a name="index-_003aargu"></a>
<a name="index-_003aargument"></a>
</dd>
<dt>:[count]argu[ment] [count] [++opt] [+cmd]</dt>
<dd><p>引數リスト內で [count] 番目のファイルを編輯する。[count] が省かれると現在の項目を編輯する。變更點があり、Vim がカレントバッファを抛棄 |<a href="#abandon">abandon</a>| したくないときには失敗する。
</p>
<p>|<a href="#g_t_002b_002bopt">++opt</a>| と |<a href="#g_t_002bcmd">+cmd</a>| も參照。
</p>
</dd>
<dt>:[count]argu[ment]! [count] [++opt] [+cmd]</dt>
<dd><p>引數リスト內で [count] 番目のファイルを編輯する。カレントバッファに對するいかなる變更も失はれる。[count] が省かれると現在の項目を編輯する。
</p>
<p>|<a href="#g_t_002b_002bopt">++opt</a>| と |<a href="#g_t_002bcmd">+cmd</a>| も參照。
</p>
<a name="g_t_003an"></a><a name="g_t_003ane"></a><a name="g_t_003anext"></a><a name="E165"></a><a name="E163"></a><a name="index-_003an"></a>
<a name="index-_003ane"></a>
<a name="index-_003anext"></a>
<a name="index-E165"></a>
<a name="index-E163"></a>
</dd>
<dt>:[count]n[ext] [++opt] [+cmd]</dt>
<dd><p>引數リストの中で [count] 個次のファイルを編輯する。變更點があり、Vim がカレントバッファを抛棄 |<a href="#abandon">abandon</a>| したくないときには失敗する。
</p>
<p>|<a href="#g_t_002b_002bopt">++opt</a>| と |<a href="#g_t_002bcmd">+cmd</a>| も參照。
</p>
</dd>
<dt>:[count]n[ext]! [++opt] [+cmd]</dt>
<dd><p>引數リストの中で [count] 個次のファイルを編輯する。カレントバッファに對するいかなる變更も失はれる。
</p>
<p>|<a href="#g_t_002b_002bopt">++opt</a>| と |<a href="#g_t_002bcmd">+cmd</a>| も參照。
</p>
<a name="g_t_003anext_005ff"></a><a name="index-_003anext_005ff"></a>
</dd>
<dt>:n[ext] [++opt] [+cmd] {arglist}</dt>
<dd><p>コマンド |<a href="#g_t_003aargs_005ff">:args_f</a>| と同じ。
</p>
</dd>
<dt>:n[ext]! [++opt] [+cmd] {arglist}</dt>
<dd><p>コマンド |<a href="#g_t_003aargs_005ff_0021">:args_f!</a>| と同じ。
</p>
<a name="g_t_003aNext"></a><a name="g_t_003aN"></a><a name="E164"></a><a name="index-_003aNext"></a>
<a name="index-_003aN"></a>
<a name="index-E164"></a>
</dd>
<dt>:[count]N[ext] [count] [++opt] [+cmd]</dt>
<dd><p>引數リストの中で [count] 個前のファイルを編輯する。變更點があり、Vim がカレントバッファを破毀 |<a href="#abandon">abandon</a>| したくないときには失敗する。
</p>
<p>|<a href="#g_t_002b_002bopt">++opt</a>| と |<a href="#g_t_002bcmd">+cmd</a>| も參照。
</p>
</dd>
<dt>:[count]N[ext]! [count] [++opt] [+cmd]</dt>
<dd><p>引數リスト內で [count] 個前のファイルを編輯する。カレントバッファに對するいかなる變更も失はれる。
</p>
<p>|<a href="#g_t_002b_002bopt">++opt</a>| と |<a href="#g_t_002bcmd">+cmd</a>| も參照。
</p>
<a name="g_t_003aprev"></a><a name="g_t_003aprevious"></a><a name="index-_003aprev"></a>
<a name="index-_003aprevious"></a>
</dd>
<dt>:[count]prev[ious] [count] [++opt] [+cmd]</dt>
<dd><p>コマンド |<a href="#g_t_003aNext">:Next</a>| と同じ。
</p>
<p>|<a href="#g_t_002b_002bopt">++opt</a>| と |<a href="#g_t_002bcmd">+cmd</a>| も參照。
</p>
<a name="g_t_003arew"></a><a name="g_t_003arewind"></a><a name="index-_003arew"></a>
<a name="index-_003arewind"></a>
</dd>
<dt>:rew[ind] [++opt] [+cmd]</dt>
<dd><p>引數リスト內で最初のファイルの編輯を始める。變更點があり、Vim がカレントバッファを抛棄 |<a href="#abandon">abandon</a>| したくないときには失敗する。
</p>
<p>|<a href="#g_t_002b_002bopt">++opt</a>| と |<a href="#g_t_002bcmd">+cmd</a>| も參照。
</p>
</dd>
<dt>:rew[ind]! [++opt] [+cmd]</dt>
<dd><p>引數リスト內で最初のファイルを編輯する。カレントバッファに對するいかなる變更も失はれる。
</p>
<p>|<a href="#g_t_002b_002bopt">++opt</a>| と |<a href="#g_t_002bcmd">+cmd</a>| も參照。
</p>
<a name="g_t_003afir"></a><a name="g_t_003afirst"></a><a name="index-_003afir"></a>
<a name="index-_003afirst"></a>
</dd>
<dt>:fir[st][!] [++opt] [+cmd]</dt>
<dd><p>コマンド |<a href="#g_t_003arewind">:rewind</a>| の別名。
</p>
<a name="g_t_003ala"></a><a name="g_t_003alast"></a><a name="index-_003ala"></a>
<a name="index-_003alast"></a>
</dd>
<dt>:la[st] [++opt] [+cmd]</dt>
<dd><p>引數リスト內で最後のファイルの編輯を始める。變更點があり、Vim がカレントバッファを抛棄 |<a href="#abandon">abandon</a>| したくないときには失敗する。
</p>
<p>|<a href="#g_t_002b_002bopt">++opt</a>| と |<a href="#g_t_002bcmd">+cmd</a>| も參照。
</p>
</dd>
<dt>:la[st]! [++opt] [+cmd]</dt>
<dd><p>引數リスト內で最初のファイルを編輯する。カレントバッファに對するいかなる變更も失はれる。
</p>
<p>|<a href="#g_t_002b_002bopt">++opt</a>| と |<a href="#g_t_002bcmd">+cmd</a>| も參照。
</p>
<a name="g_t_003awn"></a><a name="g_t_003awnext"></a><a name="index-_003awn"></a>
<a name="index-_003awnext"></a>
</dd>
<dt>:[count]wn[ext] [++opt]</dt>
<dd><p>カレントファイルを書き込み、引數リスト內で [count] 個次のファイルの編輯を始める。
</p>
<p>|<a href="#g_t_002b_002bopt">++opt</a>| と |<a href="#g_t_002bcmd">+cmd</a>| も參照。
</p>
</dd>
<dt>:[count]wn[ext] [++opt] {file}</dt>
<dd><p>カレントファイルを {file} に書き込み、引數リスト內で [count] 個次のファイルの編輯を始める。ただし {file} が既に存在し、オプション &rsquo;<samp>writeany</samp>&rsquo; がオフのときは失敗する。
</p>
<p>|<a href="#g_t_002b_002bopt">++opt</a>| と |<a href="#g_t_002bcmd">+cmd</a>| も參照。
</p>
</dd>
<dt>:[count]wn[ext]! [++opt] {file}</dt>
<dd><p>カレントファイルを {file} に書き込み、引數リスト內で [count] 個次のファイルの編輯を始める。
</p>
<p>|<a href="#g_t_002b_002bopt">++opt</a>| と |<a href="#g_t_002bcmd">+cmd</a>| も參照。
</p>
<a name="g_t_003awN"></a><a name="g_t_003awNext"></a><a name="g_t_003awp"></a><a name="g_t_003awprevious"></a><a name="index-_003awN"></a>
<a name="index-_003awNext"></a>
<a name="index-_003awp"></a>
<a name="index-_003awprevious"></a>
</dd>
<dt>:[count]wN[ext][!] [++opt] [file]</dt>
<dt>:[count]wp[revious][!] [++opt] [file]</dt>
<dd><p>コマンド |<a href="#g_t_003awnext">:wnext</a>| と同じだが、次でなく前のファイルに移る。
</p>
<p>上のコマンドの [count] の既定値は 1 である。[count] を 2 回使へるコマンドもある。最後 (最も右) のものが使はれる。
</p>
<p>引數 [+cmd] が存在しないならば、カーソルはそのファイルに對して最後に認識された位置に置かれる。オプション &rsquo;<samp>startofline</samp>&rsquo; がオンのときは、カーソルは行の最初の非空白文字に置かれ、オフのときは最後に認識された列が使はれる。最後に認識されたカーソル位置がないときは、カーソルは最初の行 (Ex モードでは最後の行) に置かれる。
</p>
<a name="g_t_007barglist_007d"></a><a name="index-_007barglist_007d"></a>
<p>引數リスト內のワイルドカードは展開され、ファイル名は竝び替へられる。だから C のソースファイルを全て編輯するには、コマンド &quot;vim *.c&quot; が使へる。Vim の中でコマンド &quot;:n *.c&quot; としても同じである。
</p>
<p>ファイル名は空白文字によつて區切られる。ファイル名にスペースまたはタブを含めるには、その前にバックスラッシュを書くこと。例へば、&quot;foo bar&quot; といふ 1 つのファイルを開くにはかうする:
</p><div class="example">
<pre class="example">:next foo\ bar
</pre></div>

<p>Unix およびその他いくつかのシステムではバッククォートも使へる。例:
</p><div class="example">
<pre class="example">:n `find . -name \\*.c -print`
</pre></div>
<p>アスタリスクの前の &rsquo;\&rsquo; は、&quot;*.c&quot; がプログラム find を實行する前にシェルで展開されるのを防ぐために必要となる。
</p>
<a name="arglist_002dposition"></a><a name="index-arglist_002dposition"></a>
<p>引數リストがあるときは、ウィンドウのタイトル (それがあつて、オプション &rsquo;<samp>title</samp>&rsquo; オンならば) やコマンド <kbd>CTRL-G</kbd> で出るファイルメッセージで編輯してゐるファイルを知ることができる。次のやうなものが表示されるだらう。
</p><pre class="verbatim">(file 4 of 11)
</pre><p>オプション &rsquo;<samp>shortmess</samp>&rsquo; の値が &rsquo;<var>f</var>&rsquo; を含んでゐるときは以下のやうになる。
</p><pre class="verbatim">(4 of 11)
</pre><p>實際は引數リスト內の現在の位置でないファイルを編輯してゐるならば、以下のやうになる。
</p><pre class="verbatim">(file (4) of 11)
</pre><p>これは、引數リストの中の 4 番目にゐるが、編輯中のファイルは引數リストの中の 4 番目でないことを意味する。これは &quot;<code>:e file</code>&quot; をするときに起こる。
</p></dd>
</dl>


<a name="index-rokarunaYin-Shu-risuto"></a>
<a name="rokarunaYin-Shu-risuto"></a>
<h4 class="unnumberedsubsec">ローカルな引數リスト</h4>

<a name="g_t_003aarglocal"></a><a name="index-_003aarglocal"></a>
<dl compact="compact">
<dt>:argl[ocal]</dt>
<dd><p>グローバルな引數リストのローカルなコピーを作る。別のファイルの編輯は始めない。
</p>
</dd>
<dt>:argl[ocal][!] [++opt] [+cmd] {arglist}</dt>
<dd><p>カレントウィンドウについてローカルな、新たな引數リストを定義する。ウィンドウが 1 個のときは |<a href="#g_t_003aargs_005ff">:args_f</a>| と同じである。
</p>
<a name="g_t_003aargglobal"></a><a name="index-_003aargglobal"></a>
</dd>
<dt>:argg[lobal]</dt>
<dd><p>カレントウィンドウにグローバルな引數リストを使ふ。別のファイルの編輯は始めない。
</p>
</dd>
<dt>:argg[lobal][!] [++opt] [+cmd] {arglist}</dt>
<dd><p>カレントウィンドウにグローバルな引數リストを使ふ。コマンド |<a href="#g_t_003aargs_005ff">:args_f</a>| と同樣、グローバルな引數リストを新たに定義する。グローバルな引數リストを使つてゐるウィンドウは全てこの新しいリストを參照するやうになる。
</p></dd>
</dl>

<p>複數の引數リストが存在可能であり、それらはウィンドウ同士で共有できる。共有されてゐるときは、あるウィンドウ內で引數リストに變更を加へると、別のウィンドウの引數リストも影響を受ける。
</p>
<p>ウィンドウが分割されると、新しいウィンドウはカレントウィンドウから引數リストを受け繼ぐ。すると 2 個のウィンドウは、片方でコマンド |<a href="#g_t_003aarglocal">:arglocal</a>| か |<a href="#g_t_003aargglobal">:argglobal</a>| を使つて別の引數リストを使ふやうになるまで、そのリストを共有することになる。
</p>

<a name="index-Yin-Shu-risutowoShi-u"></a>
<a name="Yin-Shu-risutowoShi-u"></a>
<h4 class="unnumberedsubsec">引數リストを使ふ</h4>

<a name="g_t_003aargdo"></a><a name="index-_003aargdo"></a>
<dl compact="compact">
<dt>:[range]argdo[!] {cmd}</dt>
<dd><p>引數リスト內の全てのファイルで {cmd} を實行する。または [range] が指定された場合、その範圍內の引數のみで實行する。以下と同樣の動作になる。
</p><div class="example">
<pre class="example">:rewind
:{cmd}
:next
:{cmd}
etc.
</pre></div>
</dd>
</dl>
<p>カレントファイルを抛棄 |<a href="#abandon">abandon</a>| できず、&rsquo;!&rsquo; も付けられてゐないときは、實行は失敗する。どれかのファイル內でエラーが檢出されると、引數リスト內の以降のファイルには進まない。
引數リスト末尾のファイル (またはエラーの起きたファイル) がカレントファイルになる。{cmd} の中では &rsquo;|&rsquo; で複數のコマンドを連結できる。{cmd} は引數リストに變更を加へてはならない。
</p><blockquote>
<p><strong>Note:</strong> <br>
このコマンドの實行中、オプション &rsquo;<samp>eventignore</samp>&rsquo; でオートコマンドのイベント Syntax を指定することでそれを無效化できる。かうすると各ファイルの處理がかなり高速になる。
</p></blockquote>

<p>|<a href="windows_002etxt.html#g_t_003awindo">:windo</a>|, |<a href="tabpage_002etxt.html#g_t_003atabdo">:tabdo</a>|, |<a href="windows_002etxt.html#g_t_003abufdo">:bufdo</a>|, |<a href="quickfix_002etxt.html#g_t_003acdo">:cdo</a>|, |<a href="quickfix_002etxt.html#g_t_003aldo">:ldo</a>|, |<a href="quickfix_002etxt.html#g_t_003acfdo">:cfdo</a>|, |<a href="quickfix_002etxt.html#g_t_003alfdo">:lfdo</a>| も參照。
</p>
<p>例:
</p><div class="example">
<pre class="example">:args *.c
:argdo set ff=unix | update
</pre></div>
<p>かうするとオプション &rsquo;<samp>fileformat</samp>&rsquo; の値を &quot;unix&quot; に設定し、變更があつたファイルを保存する。それが全ての *.c ファイルについて行はれる。
</p>
<p>例:
</p><div class="example">
<pre class="example">:args *.[ch]
:argdo %s/\&lt;my_foo\&gt;/My_Foo/ge | update
</pre></div>
<p>かうすると全ての *.c ファイルと *.h ファイルで單語 &quot;my_foo&quot; を &quot;My_Foo&quot; に變へる。コマンド &quot;<code>:substitute</code>&quot; でフラグ &quot;e&quot; を使つて &quot;my_foo&quot; といふ單語の使はれてゐないファイルでエラーが起きるのを防いでゐる。コマンド &quot;<code>:update</code>&quot; は變更のあつたファイルのみを保存する。
</p>
<a name="writing"></a><a name="save_002dfile"></a><a name="index-writing"></a>
<a name="index-save_002dfile"></a>
<a name="index-Shu-kiIp-mi"></a>
<a name="g_t4_002e-Shu-kiIp-mi"></a>
<h3 class="section">4. 書き込み</h3>

<blockquote>
<p><strong>Note:</strong><br>
オプション &rsquo;<samp>write</samp>&rsquo; がオフのときは、どのファイルも書き込めないことに注意。
</p></blockquote>

<a name="g_t_003aw"></a><a name="g_t_003awrite"></a><a name="E502"></a><a name="E503"></a><a name="E504"></a><a name="E505"></a><a name="E512"></a><a name="E514"></a><a name="E667"></a><a name="E796"></a><a name="index-_003aw"></a>
<a name="index-_003awrite"></a>
<a name="index-E502"></a>
<a name="index-E503"></a>
<a name="index-E504"></a>
<a name="index-E505"></a>
<a name="index-E512"></a>
<a name="index-E514"></a>
<a name="index-E667"></a>
<a name="index-E796"></a>
<dl compact="compact">
<dt>:w[rite] [++opt]</dt>
<dd><p>バッファ全體をカレントファイルに書き込む。これはファイルに對する變更點を保存するときの普通の方法である。オプション &rsquo;<samp>readonly</samp>&rsquo; がオンであるかファイルに書き込めない理由が何かあるときには實行に失敗する。
</p>
<p>++opt については |<a href="#g_t_002b_002bopt">++opt</a>| を參照。しかし ++bin, ++nobin, ++ff, ++enc だけが有效。
</p>
</dd>
<dt>:w[rite]! [++opt]</dt>
<dd><p>&quot;<code>:write</code>&quot; と似てゐるが、&rsquo;<samp>readonly</samp>&rsquo; がオンであつたり書き込みが拒否される理由があつても無理矢理書き込みを行ふ。
</p><blockquote>
<p><strong>Note:</strong> <br>
これはファイルの權限や所屬を變更したり、(シンボリック) リンクを途切れさせるかもしれないので注意。それを避けるには &rsquo;<samp>cpoptions</samp>&rsquo; にフラグ &rsquo;<var>W</var>&rsquo; を追加すること。
</p></blockquote>

</dd>
<dt>:[range]w[rite][!] [++opt]</dt>
<dd><p>指定された範圍の行をカレントファイルに書き出す。これは普通の操作ではない。ファイルがバッファ內の全ての行を含むやうにならないからだ。
</p>
<a name="g_t_003aw_005ff"></a><a name="g_t_003awrite_005ff"></a><a name="index-_003aw_005ff"></a>
<a name="index-_003awrite_005ff"></a>
</dd>
<dt>:[range]w[rite] [++opt] {file}</dt>
<dd><p>指定された範圍の行をファイル {file} に書き出す。ただしそれが既に存在し、かつオプション &rsquo;<samp>writeany</samp>&rsquo; がオフのときは失敗する。
</p>
<a name="g_t_003aw_0021"></a><a name="index-_003aw_0021"></a>
</dd>
<dt>:[range]w[rite]! [++opt] {file}</dt>
<dd><p>指定された範圍の行をファイル {file} に書き出す。既存のファイルは上書きされる。
</p>
<a name="g_t_003aw_005fa"></a><a name="g_t_003awrite_005fa"></a><a name="E494"></a><a name="index-_003aw_005fa"></a>
<a name="index-_003awrite_005fa"></a>
<a name="index-E494"></a>
</dd>
<dt>:[range]w[rite][!] [++opt] &gt;&gt;</dt>
<dd><p>指定された範圍の行をカレントファイルに追加する。
</p>
</dd>
<dt>:[range]w[rite][!] [++opt] &gt;&gt; {file}</dt>
<dd><p>指定された範圍の行をファイル {file} に追加する。&rsquo;!&rsquo; を付けるとそのファイルがまだ存在しなくても書き込みを行ふ。
</p>
<a name="g_t_003aw_005fc"></a><a name="g_t_003awrite_005fc"></a><a name="index-_003aw_005fc"></a>
<a name="index-_003awrite_005fc"></a>
</dd>
<dt>:[range]w[rite] [++opt] !{cmd}</dt>
<dd><p>[range] の行を標準入力として {cmd} を實行する (&rsquo;!&rsquo; の前の空白に注意)。{cmd} は &quot;:!{cmd}&quot; のやうに實行され、全ての &rsquo;!&rsquo; は前囘のコマンドに置き換へられる |<a href="various_002etxt.html#g_t_003a_0021">:!</a>。
</p>
<p>コマンド &quot;<code>:w</code>&quot; での [range] の既定値はバッファ全體 (1,$) である。バッファ全體を書き込むと、そのバッファは變更されてゐないとみなされるやうになる。
</p>
<p>&quot;<code>:w somefile</code>&quot; によつて別のファイルに書き出した場合は、&rsquo;<samp>cpoptions</samp>&rsquo; の &quot;+&quot; フラグに依存する。&quot;+&quot; が含まれてゐる場合は、バッファがまだ元のファイルと異なつてゐたとしても、書き込みコマンドによつて &rsquo;<samp>modified</samp>&rsquo; フラグがオフになる。
</p>
<p>&quot;<code>:w</code>&quot; にファイル名が與へられるとそれが代替ファイルになる。これは例へば書き込みに失敗した後に &quot;<code>:w #</code>&quot; でもう一度試したいときに使へる。オプション &rsquo;<samp>cpoptions</samp>&rsquo; からフラグ &rsquo;<var>A</var>&rsquo; を取り除くとこれを無效化できる。
</p>
<blockquote>
<p><strong>Note:</strong> <br>
書き込みには &rsquo;<samp>fsync</samp>&rsquo; オプションが關係してくる。設定されてゐる場合には書き込みがより遲くなるかもしれない。(しかしより安全である。)
</p></blockquote>

<a name="g_t_003asav"></a><a name="g_t_003asaveas"></a><a name="index-_003asav"></a>
<a name="index-_003asaveas"></a>
</dd>
<dt>:sav[eas][!] [++opt] {file}</dt>
<dd><p>カレントファイルをファイル名 {file} として保存し、カレントバッファのファイル名を {file} に變へる。それまでのカレントファイルの名前は代替ファイルの名前になる。既存のファイルを上書きするには [!] が必要になる。
</p>
<p>&rsquo;<samp>filetype</samp>&rsquo; が空の場合、保存の前に新しいファイル名に對してファイルタイプ檢出が行はれる。保存が成功すると &rsquo;<samp>readonly</samp>&rsquo; がオフになる。
</p>
<a name="g_t_003aup"></a><a name="g_t_003aupdate"></a><a name="index-_003aup"></a>
<a name="index-_003aupdate"></a>
</dd>
<dt>:[range]up[date][!] [++opt] [&gt;&gt;] [file]</dt>
<dd><p>&quot;<code>:write</code>&quot; と似てゐるが、バッファに變更點があるときのみ書き込みを行ふ。
</p></dd>
</dl>


<a name="buffer_002dwrite"></a><a name="index-buffer_002dwrite"></a>
<a name="Fu-Shu-batuhuadenoShu-kiIp-mi"></a>
<h4 class="unnumberedsubsec">複數バッファでの書き込み</h4>

<a name="g_t_003awa"></a><a name="g_t_003awall"></a><a name="index-_003awa"></a>
<a name="index-_003awall"></a>
<dl compact="compact">
<dt>:wa[ll]</dt>
<dd><p>變更點のあるバッファを全て書き込む。ファイル名を持たないバッファに對してはエラーメッセージが表示される。讀み込み專用のバッファは書き込まれない。
</p>
</dd>
<dt>:wa[ll]!</dt>
<dd><p>變更點のあるバッファを、讀み込み專用であつても全て書き込む。ファイル名を持たないバッファは書き込まれず、エラーメッセージが表示される。
</p></dd>
</dl>


<p>Vim は別の場所で變更を受けたファイルを上書きしようとしたときには警告する。|<a href="#timestamp">timestamp</a>| を參照。
</p>
<a name="backup"></a><a name="E207"></a><a name="E506"></a><a name="E507"></a><a name="E508"></a><a name="E509"></a><a name="E510"></a><a name="index-backup"></a>
<a name="index-E207"></a>
<a name="index-E506"></a>
<a name="index-E507"></a>
<a name="index-E508"></a>
<a name="index-E509"></a>
<a name="index-E510"></a>
<p>オプション &rsquo;<samp>backup</samp>&rsquo;, &rsquo;<samp>writebackup</samp>&rsquo; または &rsquo;<samp>patchmode</samp>&rsquo; がオンのときに既存のファイルに (追加でなく) 書き込まうとすると、元のファイルのバックアップが作られる。ファイルは元のコピーかリネームしたものである (&rsquo;<samp>backupcopy</samp>&rsquo; を參照)。ファイルの書き込みに成功したとき &rsquo;<samp>writebackup</samp>&rsquo; がオンで &rsquo;<samp>backup</samp>&rsquo; がオフだと、バックアップファイルは削除される。&rsquo;<samp>patchmode</samp>&rsquo; がオンのときはバックアップファイルはリネームされるかも知れない。
</p>
<a name="backup_002dtable"></a><a name="index-backup_002dtable"></a>
<table>
<tr><td width="15%">&rsquo;backup&rsquo;</td><td width="20%">&rsquo;writebackup&rsquo;</td><td width="65%">動作</td></tr>
<tr><td width="15%">off</td><td width="20%">off</td><td width="65%">バックアップは作られない</td></tr>
<tr><td width="15%">off</td><td width="20%">on</td><td width="65%">カレントファイルをバックアップし、後で消去する (既定)</td></tr>
<tr><td width="15%">on</td><td width="20%">off</td><td width="65%">古いバックアップを消去し、カレントファイルをバックアップする</td></tr>
<tr><td width="15%">on</td><td width="20%">on</td><td width="65%">古いバックアップを消去し、カレントファイルをバックアップする</td></tr>
</table>

<p>&rsquo;<samp>backupskip</samp>&rsquo; に指定したパターンが書き込まれるファイルの名前にマッチしたときは、バックアップファイルは作られない。その場合 &rsquo;<samp>backup</samp>&rsquo; と &rsquo;<samp>writebackup</samp>&rsquo; の値は無視される。
</p>
<p>&rsquo;<samp>backup</samp>&rsquo; がオンのときは、古いバックアップファイル (新しいバックアップファイルと同名) は削除される。&rsquo;<samp>backup</samp>&rsquo; がオフだが &rsquo;<samp>writebackup</samp>&rsquo; がオンのときは、既存のバックアップファイルは削除されない。ファイルの書き込み中に作られたバックアップファイルは別の名前になる。
</p>
<p>ファイルシステムによつてはクラッシュで新しいファイルとバックアップを兩方失ふこともあり得る (新しいファイルは存在はしても中身が滅茶苦茶になつてゐたり)。その場合は復歸機能を試すこと。スワップファイルがまだディスクに殘つてゐるかもしれないからだ。|<a href="recover_002etxt.html#g_t_003arecover">:recover</a>|
</p>
<p>オプション &rsquo;<samp>backupdir</samp>&rsquo; で指定されたディレクトリはバックアップファイルをしまふのに使はれる。(既定値: 書き込まれたファイルと同じディレクトリ)
</p>
<p>バックアップが、元のファイルのコピーである新規のファイルになるか、元のファイルがリネームされたものになるかは、オプション &rsquo;<samp>backupcopy</samp>&rsquo; で決まる。コピーが作られるのがいつでファイルがリネームされるのがいつかについてはその箇所を參照。
</p>
<p>バックアップファイルの生成に失敗すると、書き込みは行はれない。それでも書き込みたいときにはコマンドに &rsquo;!&rsquo; を追加すること。
</p>
<a name="write_002dpermissions"></a><a name="index-write_002dpermissions"></a>
<p>新しいファイルを書き込むときは讀み書きの權限が付く。unix ではマスクの値は 0666 に umask を適用させたものになる。Vim で開いたファイルに書き込むときは權限は維持されるが、s ビットはクリアされる。
</p>
<a name="write_002dreadonly"></a><a name="index-write_002dreadonly"></a>
<p>オプション &rsquo;<samp>cpoptions</samp>&rsquo; の値にフラグ &rsquo;<var>W</var>&rsquo; が含まれるときは、Vim は讀み込み專用ファイルの上書きを拒否する。&rsquo;<var>W</var>&rsquo; が含まれないと、システムが許可すれば (ディレクトリは書き込み可能でなければならない) &quot;<code>:w!</code>&quot; は讀込專用ファイルを上書きする。
</p>
<a name="write_002dfail"></a><a name="index-write_002dfail"></a>
<p>新ファイルの書き込みに失敗したときは、變更點と元のファイルを同時に失はないよう注意しなければならない。バックアップファイルがないときに書き込みに失敗すると、その時點で元のファイルはなくなつてゐるのだ！ファイルを書き出すまで VIM を終了してはいけない！バックアップが作られてゐたら、それが元のファイルの所に戾される (可能ならば)。Vim を終了して變更點が失はれても、大抵は元のファイルはそこに殘つてゐる。Vim が元のファイルを戾すのに失敗すると、元のファイルが失はれた旨のエラーメッセージが出る。
</p>
<a name="DOS_002dformat_002dwrite"></a><a name="index-DOS_002dformat_002dwrite"></a>
<p>オプション &rsquo;<samp>fileformat</samp>&rsquo; の値が &quot;<var>dos</var>&quot; のときは、&lt;EOL&gt; には &lt;CR&gt; &lt;NL&gt; が使はれる。これは MS-DOS, Win32 と OS/2 での既定値である。その他のシステムでは &quot;[dos format]&quot; といふメッセージが表示され、普通でない &lt;EOL&gt; が使はれてゐることを知らせてくれる。
<a name="Unix_002dformat_002dwrite"></a><a name="index-Unix_002dformat_002dwrite"></a>
&rsquo;<samp>fileformat</samp>&rsquo; の値が &quot;<var>unix</var>&quot; のときは、&lt;EOL&gt; には &lt;NL&gt; が使はれる。MS-DOS, Win32 と OS/2 では &quot;[unix format]&quot; といふメッセージが表示される。
<a name="Mac_002dformat_002dwrite"></a><a name="index-Mac_002dformat_002dwrite"></a>
&rsquo;<samp>fileformat</samp>&rsquo; の値が &quot;<var>mac</var>&quot; のときは、&lt;EOL&gt; には &lt;CR&gt; が使はれる。Mac 以外のシステムでは &quot;[mac format]&quot; といふメッセージが表示される。
</p>
<p>|<a href="#file_002dformats">file-formats</a>| やオプション &rsquo;<samp>fileformat</samp>&rsquo; 及び &rsquo;<samp>fileformats</samp>&rsquo; も參照。
</p>
<a name="ACL"></a><a name="index-ACL"></a>
<p>ACL は Access Control List を表す。これはファイルのアクセス權を制禦するための先進的な手段である。新しい MS-Windows と Unix システムで使はれるが、ファイルシステムがそれをサポートするときのみである。
</p>
<p>Vim はファイルを書き込むときに ACL 情報を保たうとする。バックアップファイルは元のファイルの ACL 情報を受け繼ぐ。
</p>
<p>ACL 情報は (ファイルを開くときに) ファイルが讀込專用かどうか調べるのにも使はれる。
</p>
<a name="read_002donly_002dshare"></a><a name="index-read_002donly_002dshare"></a>
<p>MS-Windows がネットワーク上でドライブを共有するとき、そこは讀込專用にすることができる。つまりファイルに讀込專用の屬性がなく、NC ネットワーク共有ドライブ上の ACL 設定が書き込みを許可してゐても、そのファイルには書き込みができない。Win32 プラットフォーム上の Vim は讀込專用のネットワークドライブを判別し、ファイルを讀込專用とマークする。そのファイルは |<a href="#g_t_003awrite">:write</a>| で上書きできない。
</p>
<a name="write_002ddevice"></a><a name="index-write_002ddevice"></a>
<p>ファイル名が實際はデバイス名のとき、Vim はバックアップを作らうとはしない (無理な話だ)。デバイスは既に存在するので、保存にはフラグ &quot;!&quot; が必要である。
</p>
<p>Unixでの例:
</p><div class="example">
<pre class="example">:w! /dev/lpt0
</pre></div>
<p>MS-DOS や MS-Windows での例:
</p><div class="example">
<pre class="example">:w! lpt0
</pre></div>
<p>Unix では、ファイル名が通常ファイルやディレクトリを指してゐないときにデバイスと判斷される。Vim は Fifo 及び名前付きパイプもデバイスと判斷する。
</p>
<p>MS-DOS と MS-Windows では、デバイスは名前から判斷される:
</p><pre class="verbatim">AUX
CON
CLOCK$
NUL
PRN
COMn	n=1,2,3... 等
LPTn	n=1,2,3... 等
</pre><p>ファイル名は大文字でも小文字でもよい。
</p>
<a name="write_002dquit"></a><a name="index-write_002dquit"></a>
<a name="index-Shu-kiIp-mitoZhong-Liao-"></a>
<a name="g_t5_002e-Shu-kiIp-mitoZhong-Liao-"></a>
<h3 class="section">5. 書き込みと終了</h3>

<a name="g_t_003aq"></a><a name="g_t_003aquit"></a><a name="index-_003aq"></a>
<a name="index-_003aquit"></a>
<dl compact="compact">
<dt>:q[uit]</dt>
<dd><p>カレントウィンドウを閉ぢる。最後のウィンドウで使ふと Vim を終了させる。變更點があつてVimがカレントバッファを抛棄 |<a href="#abandon">abandon</a>| しようとしないときや、引數リストの最後のファイルが編輯されてゐないときは失敗する。
</p>
<p>他のタブページが存在するとき、カレントタブページ內の最後のウィンドウを閉ぢるとカレントタブページが閉ぢられる。|<a href="tabpage_002etxt.html#tab_002dpage">tab-page</a>|
</p>
<p>|<a href="autocmd_002etxt.html#QuitPre">QuitPre</a>| オートコマンドイベントが發行される。
</p>
<p>他のウィンドウを終了するには |<a href="windows_002etxt.html#CTRL_002dW_005fq">CTRL-W_q</a>| を參照。
</p>
</dd>
<dt>:conf[irm] q[uit]</dt>
<dd><p>終了だが、變更點があるときや、引數リスト內で末尾にないファイルを編輯してゐるときにはプロンプトを表示する。コマンド |<a href="#g_t_003aconfirm">:confirm</a>| やオプション &rsquo;<samp>confirm</samp>&rsquo; を參照。
</p>
</dd>
<dt>:q[uit]!</dt>
<dd><p>現在のバッファに變更點があつても、書き込まずに Vim を終了する。バッファは、&rsquo;<samp>hidden</samp>&rsquo; が設定されてゐるときにも讀み込まれない。
</p>
<p>そのウィンドウが最後の 1 つで、變更點のある隱しバッファがある場合には、終了せずにカレントバッファを破毀したあとで、最初の變更點がある隱しバッファを新たな現在のバッファとする。
</p>
<p>必ず終了するにはコマンド &quot;<code>:qall!</code>&quot; を使ふこと。
</p>
</dd>
<dt>:cq[uit]</dt>
<dd><p>書き込みをせずに必ず終了し、エラーコードを返す。コマンド |<a href="quickfix_002etxt.html#g_t_003acq">:cq</a>| を參照。Manx の QuickFix モードで使はれる (|<a href="quickfix_002etxt.html#quickfix">quickfix</a>| を參照)。
</p>
<a name="g_t_003awq"></a><a name="index-_003awq"></a>
</dd>
<dt>:wq [++opt]</dt>
<dd><p>カレントファイルを書き込んで Vim を終了する。ファイルが讀込專用であるときや、バッファに名前が付いてゐないときには書き込みに失敗する。引數リスト內の末尾のファイルがまだ編輯されてゐないときには終了に失敗する。
</p>
</dd>
<dt>:wq! [++opt]</dt>
<dd><p>カレントファイルを書き込んで Vim を終了する。バッファに名前が付いてゐないときには書き込みに失敗する。
</p>
</dd>
<dt>:wq [++opt] {file}</dt>
<dd><p>{file} に書き込んで Vim を終了する。引數リスト內の末尾のファイルがまだ編輯されてゐないときには終了に失敗する。
</p>
</dd>
<dt>:wq! [++opt] {file}</dt>
<dd><p>{file} に書き込んで Vim を終了する。
</p>
</dd>
<dt>:[range]wq[!] [++opt] [file]</dt>
<dd><p>上と同樣だが、[range] の範圍內の行のみを書き込む。
</p>
<a name="g_t_003ax"></a><a name="g_t_003axit"></a><a name="index-_003ax"></a>
<a name="index-_003axit"></a>
</dd>
<dt>:[range]x[it][!] [++opt] [file]</dt>
<dd><p>|<a href="#g_t_003awq">:wq</a>| と似てゐるが、變更點があるときのみ書き込む。オプション &rsquo;<samp>hidden</samp>&rsquo; がオンで複數のウィンドウが存在するとき、ファイルを書き込んだ後はカレントバッファは隱れバッファになる。
</p>
<a name="g_t_003aexi"></a><a name="g_t_003aexit"></a><a name="index-_003aexi"></a>
<a name="index-_003aexit"></a>
</dd>
<dt>:[range]exi[t][!] [++opt] [file]</dt>
<dd><p>|<a href="#g_t_003axit">:xit</a>| と同樣。
</p>
<a name="ZZ"></a><a name="index-ZZ"></a>
</dd>
<dt>ZZ</dt>
<dd><p>變更點があればカレントファイルを書き込み、Vim を終了する (コマンド |<a href="#g_t_003ax">:x</a>| と同樣)。
</p>
<blockquote>
<p><strong>Note:</strong> <br>
カレントファイルを複數のウィンドウで開いてゐるときは、ファイルに變更點があれば書き込まれ、そしてウィンドウが閉ぢられることに注意。
</p></blockquote>

<a name="ZQ"></a><a name="index-ZQ"></a>
</dd>
<dt>ZQ</dt>
<dd><p>變更點を確かめずに終了する (コマンド &quot;<code>:q!</code>&quot; と同樣)。
</p></dd>
</dl>


<a name="window_002dexit"></a><a name="index-window_002dexit"></a>
<a name="index-Fu-Shu-nouindoutobatuhua"></a>
<a name="Fu-Shu-nouindoutobatuhua"></a>
<h4 class="unnumberedsubsec">複數のウィンドウとバッファ</h4>

<a name="g_t_003aqa"></a><a name="g_t_003aqall"></a><a name="index-_003aqa"></a>
<a name="index-_003aqall"></a>
<dl compact="compact">
<dt>:qa[ll]</dt>
<dd><p>變更點のあるバッファがない限り、Vim を終了する (變更點のある次のバッファに移動するにはコマンド &quot;<code>:bmod</code>&quot; を使ふこと)。オプション &rsquo;<samp>autowriteall</samp>&rsquo; がオンのときは、|<a href="#g_t_003awqall">:wqall</a>| と同樣に變更點のあるバッファが全て書き込まれる。
</p>
</dd>
<dt>:conf[irm] qa[ll]</dt>
<dd><p>Vim を終了する。變更點のあるバッファがあるときはプロンプトを表示する。コマンド |<a href="#g_t_003aconfirm">:confirm</a>| を參照すること。
</p>
</dd>
<dt>:qa[ll]!</dt>
<dd><p>Vim を終了する。バッファの變更點は全て失はれる。
</p>
<p>終了コードを非ゼロにしたい場合は |<a href="quickfix_002etxt.html#g_t_003acquit">:cquit</a>| を使ふ。
</p>
<a name="g_t_003aquita"></a><a name="g_t_003aquitall"></a><a name="index-_003aquita"></a>
<a name="index-_003aquitall"></a>
</dd>
<dt>:quita[ll][!]</dt>
<dd><p>コマンド |<a href="#g_t_003aqall">:qall</a>| と同樣。
</p>
<a name="g_t_003awqa"></a><a name="g_t_003awqall"></a><a name="g_t_003axa"></a><a name="g_t_003axall"></a><a name="index-_003awqa"></a>
<a name="index-_003awqall"></a>
<a name="index-_003axa"></a>
<a name="index-_003axall"></a>
</dd>
<dt>:wqa[ll] [++opt]</dt>
<dt>:xa[ll]</dt>
<dd><p>變更點のあるバッファを全て書き込み、Vim を終了する。ファイル名のないバッファや讀込專用または何らかの理由で書き込めないバッファ、またはジョブが實行中の端末があるときは、Vim を終了しない。
</p>
</dd>
<dt>:conf[irm] wqa[ll] [++opt]</dt>
<dt>:conf[irm] xa[ll]</dt>
<dd><p>變更點のあるバッファを全て書き込み、Vim を終了する。讀込專用または何らかの理由で書き込めないバッファがあるときは、プロンプトを表示する。コマンド |<a href="#g_t_003aconfirm">:confirm</a>| を參照。
</p>
</dd>
<dt>:wqa[ll]! [++opt] or :xa[ll]!</dt>
<dd><p>變更點のあるバッファを、讀込專用であつても全て書き込み、Vim を終了する。ファイル名のないバッファや何らかの理由で書き込めないバッファがあるとき、もしくは、ジョブが動作してゐるターミナルがあるときは、Vim を終了しない。
</p></dd>
</dl>

<a name="edit_002ddialogs"></a><a name="index-edit_002ddialogs"></a>
<a name="index-daiarogu"></a>
<a name="g_t6_002e-daiarogu"></a>
<h3 class="section">6. ダイアログ</h3>

<a name="g_t_003aconfirm"></a><a name="g_t_003aconf"></a><a name="index-_003aconfirm"></a>
<a name="index-_003aconf"></a>
<dl compact="compact">
<dt>:conf[irm] {command}</dt>
<dd><p>{command} を實行する際、確認が必要ならばダイアログを表示する。コマンド |<a href="#g_t_003aq">:q</a>|, |<a href="#g_t_003aqa">:qa</a>| や |<a href="#g_t_003aw">:w</a>| あるいは、|<a href="windows_002etxt.html#g_t_003aonly">:only</a>|, |<a href="windows_002etxt.html#g_t_003abuffer">:buffer</a>|, |<a href="windows_002etxt.html#g_t_003abdelete">:bdelete</a>| など、同樣に失敗しうるコマンドと共に使へる(|<a href="#g_t_003aw">:w</a>| では讀み取り專用屬性を無視するかどうかを尋ねる)。
</p>
<p>例:
</p><div class="example">
<pre class="example">:confirm w foo
</pre></div>
<p>ファイル &quot;foo&quot; が既に存在するときに確認を取る。
</p><div class="example">
<pre class="example">:confirm q
</pre></div>
<p>バッファに修正個所があるときに確認を取る。
</p><div class="example">
<pre class="example">:confirm qa
</pre></div>
<p>修正個所があり、保存されてゐないバッファがあるとき、各バッファについて保存するか破毀するか尋ねる。「全て保存」や「全て破毀」といふ選擇肢もある。
</p>
<p>常に &quot;<code>:confirm</code>&quot; を使ひたいなら、代はりにオプション &rsquo;<samp>confirm</samp>&rsquo; をオンにすること。
</p>
<a name="g_t_003abrowse"></a><a name="g_t_003abro"></a><a name="E338"></a><a name="E614"></a><a name="E615"></a><a name="E616"></a><a name="index-_003abrowse"></a>
<a name="index-_003abro"></a>
<a name="index-E338"></a>
<a name="index-E614"></a>
<a name="index-E615"></a>
<a name="index-E616"></a>
</dd>
<dt>:bro[wse] {command}</dt>
<dd><p>{command} の引數のためにファイル選擇ダイアログを開く。現在の所、これらのコマンドと共に使へる |<a href="#g_t_003ae">:e</a>|, |<a href="#g_t_003aw">:w</a>|, |<a href="#g_t_003awall">:wall</a>|, |<a href="#g_t_003awq">:wq</a>|, |<a href="#g_t_003awqall">:wqall</a>|, |<a href="#g_t_003ax">:x</a>|, |<a href="#g_t_003axall">:xall</a>|, |<a href="#g_t_003aexit">:exit</a>|, |<a href="#g_t_003aview">:view</a>|, |<a href="windows_002etxt.html#g_t_003asview">:sview</a>|, |<a href="insert_002etxt.html#g_t_003ar">:r</a>|, |<a href="#g_t_003asaveas">:saveas</a>|, |<a href="windows_002etxt.html#g_t_003asp">:sp</a>|, |<a href="starting_002etxt.html#g_t_003amkexrc">:mkexrc</a>|, |<a href="starting_002etxt.html#g_t_003amkvimrc">:mkvimrc</a>|, |<a href="starting_002etxt.html#g_t_003amksession">:mksession</a>|, |<a href="starting_002etxt.html#g_t_003amkview">:mkview</a>|, |<a href="windows_002etxt.html#g_t_003asplit">:split</a>|, |<a href="windows_002etxt.html#g_t_003avsplit">:vsplit</a>|, |<a href="tabpage_002etxt.html#g_t_003atabe">:tabe</a>|, |<a href="tabpage_002etxt.html#g_t_003atabnew">:tabnew</a>|, |<a href="quickfix_002etxt.html#g_t_003acfile">:cfile</a>|, |<a href="quickfix_002etxt.html#g_t_003acgetfile">:cgetfile</a>|, |<a href="quickfix_002etxt.html#g_t_003acaddfile">:caddfile</a>|, |<a href="quickfix_002etxt.html#g_t_003alfile">:lfile</a>|, |<a href="quickfix_002etxt.html#g_t_003algetfile">:lgetfile</a>|, |<a href="quickfix_002etxt.html#g_t_003aladdfile">:laddfile</a>|, |<a href="diff_002etxt.html#g_t_003adiffsplit">:diffsplit</a>|, |<a href="diff_002etxt.html#g_t_003adiffpatch">:diffpatch</a>|, |<a href="vi_005fdiff_002etxt.html#g_t_003aopen">:open</a>|, |<a href="windows_002etxt.html#g_t_003apedit">:pedit</a>|, |<a href="various_002etxt.html#g_t_003aredir">:redir</a>|, |<a href="repeat_002etxt.html#g_t_003asource">:source</a>|, |<a href="#g_t_003aupdate">:update</a>|, |<a href="#g_t_003avisual">:visual</a>|, |<a href="windows_002etxt.html#g_t_003avsplit">:vsplit</a>|, &rsquo;<samp>confirm</samp>&rsquo; がオンのときは |<a href="#g_t_003aqall">:qall</a>| も。
</p>
<p>{Vim の Win32 版、Motif、Athena、GTK や Mac の GUI 版でのみ利用可能。}
</p>
<p>|<a href="#g_t_003abrowse">:browse</a>| が使へない時はエラーが表示される。|<a href="various_002etxt.html#g_t_002bbrowse">+browse</a>| の機能がなかつたり、{command} が :browse に對應してゐない場合、{command} はダイアログなしで實行される。&quot;:browse oldfiles&quot; については |<a href="starting_002etxt.html#g_t_003aoldfiles">:oldfiles</a>| を參照。
</p>
<p>使用法については、例をいくつか見るのが一番分かりやすい。
</p><div class="example">
<pre class="example">:browse e $vim/foo
</pre></div>
<p>ファイル選擇ダイアログをディレクトリ $vim/foo 內で開き、選擇されたファイルを編輯する。
</p><div class="example">
<pre class="example">:browse e
</pre></div>
<p>ファイル選擇ダイアログを &rsquo;<samp>browsedir</samp>&rsquo; で指定されたディレクトリ內で開き、選擇されたファイルを編輯する。
</p><div class="example">
<pre class="example">:browse w
</pre></div>
<p>ファイル選擇ダイアログをカレントファイルのディレクトリ內で、カレントファイルの名前を既定値として開き、選擇されたファイル名を使つてバッファを保存する。
</p><div class="example">
<pre class="example">:browse w C:/bar
</pre></div>
<p>ファイル選擇ダイアログをディレクトリ C:/bar 內で、カレントファイルの名前を既定値として開き、選擇されたファイル名を使つてバッファを保存する。
</p>
<p>オプション |<a href="options_002etxt.html#g_t_0027browsedir_0027">'browsedir'</a>| も參照すること。
</p>
<p>Vim のファイル選擇ダイアログをサポートしないバージョンでは、コマンドはそのまま實行される。
</p></dd>
</dl>

<a name="browsefilter"></a><a name="index-browsefilter"></a>
<p>MS-Windows と GTK では、ファイル選擇ダイアログで使はれるフィルタを指定できる。グローバル變數 g:browsefilter かローカル變數 b:browsefilter を設定すると、フィルタをグローバルにまたはバッファについてローカルに變更できる。この變數を指定する際の書式は &quot;{filter label}\t{pattern};{pattern}\n&quot; で、{filter label} はコンボボックス「ファイルの種類」に使はれるテキスト、{pattern} はファイル名を選別するフィルタである。&rsquo;;&rsquo; で區切れば複數のパターンを指定できる。
</p>
<p>Motif 上の Vim では同じ書式が使へるが、實際には 1 番目のパターンだけが使はれる (Motif ではパターンは 1 種類しか使へないが、それをユーザーが編輯できる)。
</p>
<p>例へばダイアログで Vim 關聯ファイルだけを表示するには、以下のコマンドを使ふ。
</p>
<pre class="verbatim">let g:browsefilter = &quot;Vim Scripts\t*.vim\nVim Startup Files\t*vimrc\n&quot;
</pre>
<p>フィルタは、變數 b:browsefilter を設定することでバッファ每に設定できる。b:browsefilter はファイルタイププラグインで設定することが一番多いだらう。するとファイルブラウザーダイアログには現在編輯中のファイルのタイプに關聯した候補が表示される。弊害: 別の種類のファイルの編輯が始め辛くなる。對策は、フィルタの最後の項目に &quot;All Files\t*.*\n&quot; を加へ、ユーザーが望みのファイルにアクセスできる道を殘すことだ。
</p>
<p>Vim が browsefilter をサポートしてゐないときにそれを設定しないやうにするには、has(&quot;browsefilter&quot;) が使へる:
</p>
<pre class="verbatim">if has(&quot;browsefilter&quot;)
let g:browsefilter = &quot;whatever&quot;
endif
</pre>
<a name="current_002ddirectory"></a><a name="index-current_002ddirectory"></a>
<a name="index-karentodeirekutori-1"></a>
<a name="g_t7_002e-karentodeirekutori"></a>
<h3 class="section">7. カレントディレクトリ</h3>

<p>|<a href="#g_t_003acd">:cd</a>|, |<a href="#g_t_003alcd">:lcd</a>| や |<a href="#g_t_003atcd">:tcd</a>| コマンドを使つて別のディレクトリに移ることができる。すると {譯注: そのディレクトリ內のファイルを編輯するとき} そのディレクトリ名をファイル名の前に付けなくても良くなる。また違ひは &quot;<code>:!ls</code>&quot; 等の外部コマンドの實行の際にも現れる。
</p>
<p>&rsquo;<samp>cpoptions</samp>&rsquo; にフラグ &rsquo;.&rsquo; が含まれてゐる場合、カレントバッファが變更されてゐると、&quot;!&quot; をつけない限りディレクトリ變更は失敗する。
</p>
<a name="g_t_003acd"></a><a name="E747"></a><a name="E472"></a><a name="index-_003acd"></a>
<a name="index-E747"></a>
<a name="index-E472"></a>
<dl compact="compact">
<dt>:cd[!]</dt>
<dd><p>Unix 以外のシステムでは: カレントディレクトリ名を表示する。Unix システムでは: カレントディレクトリをホームディレクトリに變更する。全てのシステムで、カレントディレクトリの表示にはコマンド |<a href="#g_t_003apwd">:pwd</a>| が使へる。Unix システムでは: ウィンドウローカルディレクトリを消去する。
</p>
</dd>
<dt>:cd[!] {path}</dt>
<dd><p>カレントディレクトリを {path} に變更する。{path} が相對的な指定なら、オプション &rsquo;<samp>cdpath</samp>&rsquo; 內に列擧されたディレクトリを基準に判斷される。
</p>
<p>ウィンドウローカルディレクトリを消去する。
</p>
<p>既に開かれたファイルについては、フルパスが把握されてゐるので變化はない。しかし引數リスト |<a href="#arglist">arglist</a>| 內のファイルの意味は變はるかもしれない！
</p>
<p>MS-DOS ではアクティブなドライブも變更する。カレントファイルのディレクトリに移るにはかうする。
</p><div class="example">
<pre class="example">:cd %:h
</pre></div>
<a name="g_t_003acd_002d"></a><a name="E186"></a><a name="index-_003acd_002d"></a>
<a name="index-E186"></a>
</dd>
<dt>:cd[!] -</dt>
<dd><p>前のカレントディレクトリ (前にコマンド &quot;<code>:cd {path}</code>&quot; で移つた所) に移る。
</p>
<a name="g_t_003achd"></a><a name="g_t_003achdir"></a><a name="index-_003achd"></a>
<a name="index-_003achdir"></a>
</dd>
<dt>:chd[ir][!] [path]</dt>
<dd><p>コマンド |<a href="#g_t_003acd">:cd</a>| と同じ。
</p>
<a name="g_t_003atcd"></a><a name="index-_003atcd"></a>
</dd>
<dt>:tcd[!] {path}</dt>
<dd><p>|<a href="#g_t_003acd">:cd</a>| と似てゐるが、カレントタブページのディレクトリを設定するだけである。カレントウィンドウもこのディレクトリを使用する。カレントディレクトリは、他のタブページ內のウィンドウやカレントタブページ內のウィンドウ固有のウィンドウローカルディレクトリに對しては變更されない。
</p>
<a name="g_t_003atch"></a><a name="g_t_003atchdir"></a><a name="index-_003atch"></a>
<a name="index-_003atchdir"></a>
</dd>
<dt>:tch[dir][!]</dt>
<dd><p>|<a href="#g_t_003atcd">:tcd</a>| と同じ。
</p>
<a name="g_t_003alc"></a><a name="g_t_003alcd"></a><a name="index-_003alc"></a>
<a name="index-_003alcd"></a>
</dd>
<dt>:lc[d][!] {path}</dt>
<dd><p>コマンド |<a href="#g_t_003acd">:cd</a>| と似てゐるが、カーソルがカレントウィンドウにある時にカレントディレクトリのみを變更する。別のウィンドウのカレントディレクトリは變更されず、別のウィンドウへの移動すると {path} の使用を止める。
</p>
<a name="g_t_003alch"></a><a name="g_t_003alchdir"></a><a name="index-_003alch"></a>
<a name="index-_003alchdir"></a>
</dd>
<dt>:lch[dir][!]</dt>
<dd><p>|<a href="#g_t_003alcd">:lcd</a>| と同じ。
</p>
<a name="g_t_003apw"></a><a name="g_t_003apwd"></a><a name="E187"></a><a name="index-_003apw"></a>
<a name="index-_003apwd"></a>
<a name="index-E187"></a>
</dd>
<dt>:pw[d]</dt>
<dd><p>カレントディレクトリ名を表示する。
</p>
<p>|<a href="eval_002etxt.html#getcwd_0028_0029">getcwd()</a>| も參照。
</p></dd>
</dl>

<p>|<a href="#g_t_003alcd">:lcd</a>| か |<a href="#g_t_003atcd">:tcd</a>| コマンドが使はれない限り、全てのウィンドウは同じカレントディレクトリを共有する。別のウィンドウに移るコマンドを使つてもカレントディレクトリについての變化は何もない。
</p>
<p>|<a href="#g_t_003alcd">:lcd</a>| コマンドがあるウィンドウ內で使はれると、指定されたディレクトリがそのウィンドウに對してのカレントディレクトリになる。|<a href="#g_t_003alcd">:lcd</a>| コマンドが使はれたことのないウィンドウはグローバルまたはタブローカルなカレントディレクトリを使ひ續ける。別のウィンドウに移つたときは、カレントディレクトリは {譯注: 移動先に對して} 最後に指定されたローカルなカレントディレクトリになる。何も指定されてゐなければ、グローバルまたはタブローカルなカレントディレクトリが使はれる。
</p>
<p>タブページに |<a href="#g_t_003atcd">:tcd</a>| コマンドが使はれると、指定されたディレクトリはカレントタブページとカレントウィンドウのカレントディレクトリになる。他のタブページのカレントディレクトリは影響を受けない。別のタブページに移動すると、カレントディレクトリがそのタブページで最後に指定されたローカルディレクトリになる。カレントタブページにローカルのカレントディレクトリがない場合は、グローバルなカレントディレクトリが使用される。
</p>
<p>|<a href="#g_t_003acd">:cd</a>| コマンドが使はれると、カレントウィンドウとカレントタブページは固有のローカルなカレントディレクトリを失ひ、グローバルなカレントディレクトリを使ふやうになる。
</p>
<p>|<a href="#g_t_003acd">:cd</a>| を使つた後は、ファイルの讀み書きにはフルパス名が使はれる。ネットワーク接續されたファイルシステムではこれが問題を起こすことがある。フルパス名を使つた結果、現在使用中のファイル名は同じファイルを指し續けることになる。
</p>
<p>例: ファイル a:test とディレクトリ a:vim があるとき、&quot;:e test&quot; &quot;:cd vim&quot; &quot;:w&quot; とするとファイル a:test を上書きし、a:vim/test には書き込まない。しかし &quot;:w test&quot; とするとファイル a:vim/test が書き込まれる。それは新しいファイル名が指定され、&quot;:cd&quot; 以前のファイル名には言及してないからだ。
</p>
<a name="edit_002dbinary"></a><a name="index-edit_002dbinary"></a>
<a name="index-bainarihuairunoBian-Ji-"></a>
<a name="g_t8_002e-bainarihuairunoBian-Ji-"></a>
<h3 class="section">8. バイナリファイルの編輯</h3>

<p>Vim はテキストファイルの編輯のために作られたが、バイナリファイルを編輯することもできる。
</p>
<p>Vim の引數 |<a href="starting_002etxt.html#g_t_002db">-b</a>| (バイナリ &quot;binary&quot; の &rsquo;b&rsquo;) は Vim にファイル入出力をバイナリモードで行はせ、バイナリファイルの編輯のためにいくつかのオプションを設定する (&rsquo;<samp>binary</samp>&rsquo; をオン、&rsquo;<samp>textwidth</samp>&rsquo; を 0、&rsquo;<samp>modeline</samp>&rsquo; をオフ、&rsquo;<samp>expandtab</samp>&rsquo; をオフにする)。
</p>
<p>オプション &rsquo;<samp>binary</samp>&rsquo; をオンにすることも同じ效果を持つ。これはファイルの讀み込み前にするといふことを忘れてはならない。
</p>
<p>バイナリファイルを編輯するときに忘れてはならないことがいくつかある:
</p><ul>
<li> 實行可能ファイルを編輯するときには、文字數が變はつてはならない。テキストを變更するには &quot;R&quot; か &quot;r&quot; だけを使用すること。&quot;x&quot; やバックスペースで文字を削除してはならない。
</li><li> オプション &rsquo;<samp>textwidth</samp>&rsquo; の値を 0 に設定する。さうしないと行が不意に2つに分割されてしまふ。
</li><li> &lt;EOL&gt; の數があまり多くないときは、1 行は非常に長くなる。スクリーンに收まりきらない行を編輯したいならば、オプション &rsquo;<samp>wrap</samp>&rsquo; をオフにすること。その時には水平スクロールが使はれる。行が餘りにも長いならば (Amiga では約 32767 文字以上、32bit システムではそれ以上、|<a href="vi_005fdiff_002etxt.html#limits">limits</a>| を參照)、その行は編輯できない。ファイルを讀み込むときに、その行は分割される。ファイルを讀み込むときに &quot;out of memory&quot; エラーが出る可能性もある。
</li><li> ファイルを讀み込む前にオプション &rsquo;<samp>binary</samp>&rsquo; がオンになつてゐることを確かめること。さもないと &lt;CR&gt; &lt;NL&gt; と &lt;NL&gt; の兩方が行末とみなされ、ファイルが保存されるときに &lt;NL&gt; が &lt;CR&gt; &lt;NL&gt; で置き換へられてしまふ。
</li><li> &lt;Nul&gt; 文字はスクリーンでは ^&nbsp;として表示される。それは &quot;CTRL-V CTRL-@&quot; か &quot;CTRL-V 000&quot; で入力できる。
</li><li> &lt;NL&gt; 文字を插入すると、行が分割される。バッファをファイルに保存するときには、&lt;NL&gt; が &lt;EOL&gt; として保存される。
</li><li> ファイルの終はりに &lt;EOL&gt; が 1 つもないとき、通常 Vim はそれを追加する。これを防ぐにはオプション &rsquo;<samp>binary</samp>&rsquo; をオンにすること。最後の &lt;EOL&gt; を追加したいならば、オプション &rsquo;<samp>endofline</samp>&rsquo; をオンにする。最後の行に &lt;EOL&gt; があつたかどうかを知るためにこのオプションの値を見てもよい (テキストからは判斷できない)。
</li></ul>

<a name="encryption"></a><a name="index-encryption"></a>
<a name="index-An-Hao-Hua--1"></a>
<a name="g_t9_002e-An-Hao-Hua-"></a>
<h3 class="section">9. 暗號化</h3>

<p>Vim はファイルを暗號化して保存し、再び讀み取ることができる。暗號化されたテキストは正しい鍵がないと讀むことができない。
<a name="E833"></a><a name="index-E833"></a>
{Vim が |<a href="various_002etxt.html#g_t_002bcryptv">+cryptv</a>| 機能付きでコンパイルされたときのみ有效}
</p>
<a name="E843"></a><a name="index-E843"></a>
<p>スワップファイルやアンドゥファイル內のテキストも暗號化される。
</p>
<p>しかしながら、これはブロック單位で實行されるので、より少ない時閒でパスワードがクラックされる可能性がある。スワップファイルを無效化することもできるが、クラッシュ時には作業內容が失はれることになる。アンドゥファイルは無效化してもそれほどの不利益はない。
</p><div class="example">
<pre class="example">:set noundofile
:noswapfile edit secrets
</pre></div>

<blockquote>
<p><strong>Note:</strong> <br>
メモリ內のテキストは暗號化されない。ユーザーがテキストを編輯してゐる閒、システム管理者はそれを見ることができる。&quot;<code>:!filter</code>&quot; や &quot;<code>:w !command</code>&quot; によつてフィルタに通してゐるときもテキストは暗號化されてをらず、他人に見られる可能性がある。&rsquo;<samp>viminfo</samp>&rsquo; ファイルは暗號化されない。
</p></blockquote>

<p>機密テキストを編輯するときは次のやうに設定するといふ手もある:
</p><div class="example">
<pre class="example">:set noundofile viminfo=
:noswapfile edit secrets.txt
</pre></div>
<p>スワップファイルを無效化するとクラッシュまたは停電の時に編輯內容が失はれてしまふので注意。
</p>
<blockquote>
<p><strong>警告:</strong> <br>
鍵の入力時にタイプミスをしてファイルを保存し、Vim を終了すると、テキストは失はれてしまふ！
</p></blockquote>

<p>暗號化を利用する通常の方法は、コマンド |<a href="#g_t_003aX">:X</a>| を使ふことだ。これは鍵を入力するやう求める。次の保存コマンドでファイルを暗號化するためにその鍵が使はれる。後で同じファイルを編輯するときは、Vim は鍵の入力を求める。保存に使はれたものと同じ鍵を打ち込むと、再びテキストを讀み込むことができる。閒違つたキーを使ふと、テキストはめちやめちやになつて表示される。
</p>
<a name="g_t_003aX"></a><a name="index-_003aX"></a>
<dl compact="compact">
<dt>:X</dt>
<dd><p>暗號化キーを入力するやう求める。ディスプレイを見てゐる誰かが鍵を見ないやうに、打ち込むときには實際のテキストは表示されない。
</p>
<p>打ち込まれた鍵はオプション &rsquo;<samp>key</samp>&rsquo; に保存される。これはファイルを書き込むときの暗號化に使はれる。Vim の引數 |<a href="starting_002etxt.html#g_t_002dx">-x</a>| も參照。
</p></dd>
</dl>

<p>オプション &rsquo;<samp>key</samp>&rsquo; の値はテキストが書き込まれるときに使はれる。値が空でないとき、書き込まれたファイルは、その値を鍵として暗號化されてゐる。Vim がファイルが暗號化されてゐることを認識できるやう、ファイル先頭に特殊な數が付加される。
</p>
<p>暗號化を無效にするには、オプション &rsquo;<samp>key</samp>&rsquo; に空の値を入れてリセットする。
</p><div class="example">
<pre class="example">:set key=
</pre></div>

<p>&rsquo;<samp>cryptmethod</samp>&rsquo; オプションを設定することで暗號化メソッドを選擇できる。次の中から選擇できる:
</p><div class="example">
<pre class="example">:setlocal cm=zip        &quot; 弱いメソッド。後方互換。
:setlocal cm=blowfish   &quot; 脆弱性ありのメソッド
:setlocal cm=blowfish2  &quot; 中强度のメソッド
</pre></div>

<p>ファイルを保存する前に設定する。暗號化されたファイルを讀み込んだとき、このオプションは自動的にファイル保存時に使はれたメソッドに設定される。ファイルを保存する前に &rsquo;<samp>cryptmethod</samp>&rsquo; を變更することで使用するメソッドを變更できる。
</p>
<p>新しいファイルに使はれるデフォルトのメソッドを設定したい場合は |<a href="starting_002etxt.html#vimrc">vimrc</a>| ファイルで次を設定すること:
</p><div class="example">
<pre class="example">set cm=blowfish2
</pre></div>
<p>&quot;blowfish2&quot; の使用が强く推奬される。&quot;blowfish2&quot; をサポートしてゐない古いバージョンの Vim を使はなければならない場合のみ、他のメソッドを使用する。
</p>
<p>ファイルを讀み込んだり書き込んだりしたとき、zip なら &quot;[crypted]&quot;、blowfish なら &quot;[blowfish]&quot; とメッセージが表示される。
</p>
<p>アンドゥファイルが保存されるとき、同じキーとメソッドがアンドゥファイル內のテキストに適用される。|<a href="undo_002etxt.html#persistent_002dundo">persistent-undo</a>|。
</p>
<p>&quot;blowfish&quot; をサポートしてゐるかどうかテストするには下記の條件を使ふ:
</p><div class="example">
<pre class="example">has('crypt-blowfish')
has('crypt-blowfish2')
</pre></div>
<p>上記の條件が利用できるのは Vim 7.4.1099 からであるが、&quot;blowfish&quot; のサポート自體はより古くからある。
</p>
<p>よつて上記の條件が僞になつたとしても &quot;blowfish&quot; をサポートしてゐることがある。&quot;blowfish&quot; を使へるかどうかは次の條件でテストできる:
</p><div class="example">
<pre class="example">v:version &gt;= 703
</pre></div>
<p>また &quot;blowfish2&quot; については次の條件でテストできる:
</p><div class="example">
<pre class="example">v:version &gt; 704 || (v:version == 704 &amp;&amp; has('patch401'))
</pre></div>
<p>Vim にパッチ 7.4.237 が含まれてゐることが分かつてゐるなら、次の條件で簡單にチェックできる:
</p><div class="example">
<pre class="example">has('patch-7.4.401')
</pre></div>
<a name="E817"></a><a name="E818"></a><a name="E819"></a><a name="E820"></a><a name="index-E817"></a>
<a name="index-E818"></a>
<a name="index-E819"></a>
<a name="index-E820"></a>
<p>暗號化が正しく機能しないと、保存したファイルが後で讀めなくなつてしまふ。そのため、暗號化が期待したとほりに機能してゐるかどうかを確認するための檢査が實行される。これらのエラーが表示されたときはファイルを暗號化して保存しないこと。これを直すためには Vim を再ビルドする必要があるだらう。
</p>
<a name="E831"></a><a name="index-E831"></a>
<p>*E831* これは內部エラーで普通は發生しない。このエラーの再現手順を見つけた方は開發者へ聯絡していただきたい。
</p>
<p>暗號化されたファイルを讀み込んだとき、&rsquo;<samp>key</samp>&rsquo; オプションの値が空でなければその値が復號に使はれる。空のときは入力プロンプトが表示される。キーを入力しないか閒違つたキーを入力するとファイルは復號されずに開かれる。キーが閒違つてゐても警告は表示されない (總當たり攻擊を難しくするため)。
</p>
<p>異なる鍵で暗號化したファイルの讀み込みを始めたいときは、オプション &rsquo;<samp>key</samp>&rsquo; の値に空文字列を設定すること。すると Vim が新しい値の入力を求める。値の入力にコマンド &quot;<code>:set</code>&quot; を使つてはならない。他の人が肩越しにコマンドの入力を讀むことができるからだ。
</p>
<p>オプション &rsquo;<samp>key</samp>&rsquo; の値は祕密であることになつてゐるので、その値は決して見られてはならない。vimrcファイル內でこのオプションを設定してはいけない。
</p>
<p>&quot;/etc/magic&quot;, &quot;/usr/share/misc/magic&quot; 等、システムの持つてゐる &quot;magic&quot; ファイルならどれでもよいが、下の行を追加すると、暗號化されたファイルが &quot;file&quot; コマンドに認識されるやうになる:
</p><pre class="verbatim">0   string  VimCrypt~       Vim encrypted file
&gt;9  string  01      - &quot;zip&quot; cryptmethod
&gt;9  string  02      - &quot;blowfish&quot; cryptmethod
&gt;9  string  03      - &quot;blowfish2&quot; cryptmethod
</pre>
<blockquote>
<p><strong>Notes:</strong>
</p><ul>
<li> オプション &rsquo;<samp>charconvert</samp>&rsquo; でコード變換をしてゐるときには暗號化はできない。
</li><li> コピーや削除したテキストは番號付きレジスタに格納される。レジスタの內容は <samp>.viminfo</samp> ファイル內に保存できるが、ここからは讀み出せるかもしれない。安全のためオプション &rsquo;<samp>viminfo</samp>&rsquo; を變更すること。
</li><li> コンピュータからしばらく離れてゐるときには誰かが Vim にコマンドを入力できるが、鍵を入手できるやうになつてゐてはいけない。
</li><li> キーを入力してゐるときにタイプミスをすると、テキストを復元できなくなつてしまふだらう！
</li><li> コマンド &quot;<code>:set key=value</code>&quot; で鍵を入力すると、それは履歷の中に保存され、viminfo ファイル內に &rsquo;<samp>key</samp>&rsquo; の値を晒すことになる。
</li><li> 100 パーセント安全といふことは決してない。Vim の暗號化は强度についてはテストされてゐない。
</li><li> &rsquo;<samp>cryptmethod</samp>&rsquo; が &quot;zip&quot; のときに使用されるアルゴリズムは簡單に破れる。4 文字の鍵なら約1時閒以內、6 文字の鍵なら1日以內で破れる (Pentium 133 PC で)。これにはファイル內に必ず現れるはずのテキストをいくつか知つてゐる必要がある。暗號破りの熟練者はどのやうな鍵であつても破ることができる。テキストが復號化されたといふことは鍵も明らかになつたといふことであり、同じ鍵で暗號化された他のテキストも復號化できてしまふ。
</li><li> Pkzip は &rsquo;<samp>cryptmethod</samp>&rsquo; の &quot;zip&quot; と同じ暗號化を用ゐてをり、合衆國政府はその輸出に對して異議を唱へてゐない。Pkzip の公開ファイル <samp>APPNOTE.TXT</samp> にはこのアルゴリズムが詳細に記述されてゐる。
</li><li> &rsquo;<samp>cryptmethod</samp>&rsquo; の &quot;blowfish&quot; の實裝には脆弱性がある。ファイルの最初の 64 バイト (條件によつてはもつと) はクラック可能である。これの使用は推奬されないが、Vim 7.3 と 7.4 でサポートされてゐる中ではそれが一番强度のあるメソッドである。&quot;zip&quot; メソッドはさらに弱い。
</li><li> Vim はオランダに起源を持つ。そこがソースの出處である。從つて、暗號化コードはアメリカ合衆國から輸出されてはゐない。
</li></ul>
</blockquote>

<a name="timestamp"></a><a name="timestamps"></a><a name="index-timestamp"></a>
<a name="index-timestamps"></a>
<a name="index-taimusutanpu"></a>
<a name="g_t10_002e-taimusutanpu"></a>
<h3 class="section">10. タイムスタンプ</h3>

<p>Vim は編輯を始めたときのファイルの修正タイムスタンプとモードとサイズを覺えてゐる。これは同じファイルの別のバージョンを (知らずに) 作つてしまふのを防ぐためである。
</p>
<p>シェルコマンド (|<a href="various_002etxt.html#g_t_003a_0021cmd">:!cmd</a>| |<a href="starting_002etxt.html#suspend">suspend</a>| |<a href="insert_002etxt.html#g_t_003aread_0021">:read!</a>| |<a href="various_002etxt.html#K">K</a>|) の實行後、ウィンドウ內の全てのバッファでタイムスタンプとファイルモードとファイルサイズが比較される。Vim は變更を受けたファイルに關して、イベント |<a href="autocmd_002etxt.html#FileChangedShell">FileChangedShell</a>| に關聯付けられた任意の自動コマンドを實行するか、警告を表示する。GUI を使つてゐるときは、それらは Vim に入力フォーカスが戾つてきたときに行はれる。
</p>
<a name="E321"></a><a name="E462"></a><a name="index-E321"></a>
<a name="index-E462"></a>
<p>ファイルが Vim の外部で變更を受けたときに自動的に讀み直して欲しいなら、オプション &rsquo;<samp>autoread</samp>&rsquo; をオンにすること。しかしこれはファイルを書き込んだ時點では機能しない。ファイルが Vim 內部で變更されてゐないときだけだ。
</p>
<p>もしも質問されたくなかつたり、ファイルを自動的に再讀み込みをしたいのなら、次の設定を使ふことができる:
</p><div class="example">
<pre class="example">set buftype=nofile
</pre></div>
<p>もしくは、シェルから gvim を起動する時に
</p><div class="example">
<pre class="example">gvim file.log -c &quot;set buftype=nofile&quot;
</pre></div>

<blockquote>
<p><strong>Note:</strong> <br>
イベント |<a href="autocmd_002etxt.html#FileChangedShell">FileChangedShell</a>| に自動コマンドが定義されてゐると、警告メッセージやプロンプトは表示されない。その自動コマンドが對處するものとされてゐる。
</p></blockquote>

<p>ディレクトリに關する警告はない (例へば |<a href="pi_005fnetrw_002etxt.html#netrw_002dbrowse">netrw-browse</a>| で)。しかし新しいファイルの編輯を始めた後、同名のディレクトリが作られたときには警告される。
</p>
<p>ファイルのタイムスタンプが變更されたことに Vim が氣づいたとき、そのファイルがバッファ內で編輯されてゐるがまだ變更されてゐないならば、Vim はファイルの中身が同じかどうかを調べる。このためにはファイルを讀み直し、テキストを比較する (隱れバッファに讀み込むが、これはすぐに削除される)。內容が同じならば警告は出ない。
</p>
<p>自動警告では足りないと思つたならば、以下のコマンドが使へる。
</p>
<a name="g_t_003acheckt"></a><a name="g_t_003achecktime"></a><a name="index-_003acheckt"></a>
<a name="index-_003achecktime"></a>
<dl compact="compact">
<dt>:checkt[ime]</dt>
<dd><p>Vim の外部で變更を受けたバッファがないかどうか調べる。これはファイルのバージョンが 2 個になつてしまはないかどうかを調べ、警告する。
</p>
<p>これがオートコマンドや &quot;<code>:global</code>&quot; コマンドから呼ばれたときや、直に打ち込まれたのではないときは、實際に調べるのは副作用 (ファイルの再讀み込み) が無害となる時點まで延期される。
</p>
<p>讀み込まれてゐるバッファそれぞれについて關聯付けられたファイルが變更を受けてゐないか調べる。變更を受けてゐたら、Vim は對處動作を行ふ。すなはちバッファに變更點が無く、かつオプション &rsquo;<samp>autoread</samp>&rsquo; がオンのときは、バッファは讀み直される。さうでなければ、ファイルを讀み直すかどうかの選擇肢が與へられる。ファイルが削除されてゐたら、エラーメッセージが表示される。
</p>
<p>以前には存在しなかつたファイルが存在してゐたら、エラーメッセージが表示される。
</p>
<p>一度ファイルが調べられるとタイムスタンプ情報が更新され、再び警告されることは無い。
</p>
</dd>
<dt>:[N]checkt[ime] {filename}</dt>
<dt>:[N]checkt[ime] [N]</dt>
<dd><p>特定のバッファのタイムスタンプを調べる。バッファの指定は名前、番號またはパターンでもよい。
</p></dd>
</dl>


<a name="E813"></a><a name="E814"></a><a name="index-E813"></a>
<a name="index-E814"></a>
<p>ここでユーザーがバッファを再讀み込みすることを選ぶと、再讀み込みされる。そのバッファを含むウィンドウが表示されてゐる場合、再讀み込みはそのウィンドウの中で行はれる。そのやうなウィンドウがなければ、オートコマンドが正常に動作するやう、特殊なウィンドウが使はれる。このウィンドウを閉ぢることはできない。他にもいくつかの制限が適用される。カレントバッファの外では何も起こらないやうにするのがベストである。
</p>
<p>例へば、ウィンドウローカルなオプションをセットすると、閒違つたウィンドウの中でセットされてしまふ。ウィンドウを分割し、そこで何かをして、閉ぢることは大丈夫である (他のオートコマンドによる副作用が何もなければ)。無關係なウィンドウやバッファを閉ぢると問題を引き起こすだらう。
</p>
<p>書き込み前にはタイムスタンプが調べられる。もし變更されてゐたら、Vim はそのファイルを本當に上書きするかどうかを尋ねる。
</p>
<blockquote>
<p><strong>警告:</strong> <br>
讀込んだ後にファイルに變更がありました！！！本當に上書きしますか (y/n)？
</p></blockquote>

<p>&rsquo;y&rsquo; を打ち込むと、Vim は續けて書き込みを行ふ。&rsquo;n&rsquo; を打ち込むと、書き込みは中止される。コマンド &quot;<code>:wq</code>&quot; や &quot;<code>ZZ</code>&quot; を使つた場合には Vim は終了せず、書き込む機會が再び得られる。
</p>
<p>普通、メッセージは編輯セッションが始まつた後に誰かがファイルに書き込んだことを示してゐる。それは別の人物かもしれない。この場合、あなたの行つた變更とその人物が行つた變更が合倂されるべきか調べたいことだらう。ファイルを別の名前で書き込み、差分を調べること (これにはプログラム &quot;diff&quot; が使へる)。
</p>
<p>別の編輯セッションや別のコマンドで (例へばフィルタコマンド) そのファイルに自分自身で變更を加へたといふこともあり得る。その場合、どちらのバージョンを保管したいかは自分でお分かりだらう。
</p>
<p>何も閒違つたことはしてゐないのにこのメッセージが現れる場合が 1 つある: Win32 でサマータイムが始まる日である。Win32 ライブラリにより、Vim が時閒の差を混亂してしまふ。この問題は次の日には直る。
</p>
<a name="file_002dsearching"></a><a name="index-file_002dsearching"></a>
<a name="index-huairuJian-Suo-"></a>
<a name="g_t11_002e-huairuJian-Suo-"></a>
<h3 class="section">11. ファイル檢索</h3>

<p>{Vim が |<a href="various_002etxt.html#g_t_002bpath_005fextra">+path_extra</a>| 機能付きでコンパイルされたときのみ有效}
</p>
<p>現在の所、オプション &rsquo;<samp>path</samp>&rsquo;, &rsquo;<samp>cdpath</samp>&rsquo;, &rsquo;<samp>tags</samp>&rsquo; と |<a href="eval_002etxt.html#finddir_0028_0029">finddir()</a>|, |<a href="eval_002etxt.html#findfile_0028_0029">findfile()</a>| で、本節で說明する「ファイル檢索」にしたがつてワイルドカードの展開が行はれる。それ以外のコマンドでは |<a href="#wildcards">wildcards</a>| といふ少し異なるルールにしたがふ。
</p>
<p>ファイル檢索には以下の 3 種類がある:
</p>
<a name="starstar"></a><a name="index-_002a_002a"></a>
<dl compact="compact">
<dt>1) 下向き檢索:</dt>
<dd><p>下向き檢索にはワイルドカード &rsquo;*&rsquo; と &rsquo;**&rsquo; 及びユーザーの OS がサポートするその他のものが使へる。&rsquo;*&rsquo; と &rsquo;**&rsquo; は Vim 內部で處理されるので、全ての OS で機能する。
</p><blockquote>
<p><strong>Note:</strong><br>
&quot;**&quot; はパス名の先頭で使はれた場合のみ特別なワイルドカードとなる。
</p></blockquote>

<p>&rsquo;*&rsquo; の使用法はきはめて單純: 0 個以上の文字にマッチする。正規表現パターンでいふと &quot;.*&quot; と同じである。正規表現と異なり &quot;.&quot; は必要ないことに注意。
</p>
<p>&rsquo;**&rsquo; はもつとすばらしい。
</p><ul>
<li> これはディレクトリのみにマッチする。
</li><li> これはデフォルトで 30 段階までの深さのディレクトリにマッチするので、ディレクトリツリー全體の檢索に使へる。
</li><li> マッチする深さの最大値は &rsquo;**&rsquo; の後に數字を付け加へて指定できる。
</li></ul>
<p>だから &rsquo;/usr/**2&rsquo; は下のやうにマッチする。
</p><pre class="verbatim">/usr
/usr/include
/usr/include/sys
/usr/include/g++
/usr/lib
/usr/lib/X11
....
</pre><p>&rsquo;/usr/include/g++/std&rsquo; には、深さが3なのでマッチしない。
</p>
<p>指定可能な範圍は 0 (&rsquo;**0&rsquo; は無視される) から 100 である。負數を指定すると 30 を、100 より大きい數を指定すると 100 を指定したものとされる。システムにもパスの長さの限界が存在する場合がある。通常は 256 または 1024 バイトである。
</p><ul>
<li> &rsquo;**&rsquo; はパスの末尾にのみ使へる。後ろにパス區切り文字か、數字とパス區切り文字の組み合はせを付けてもよい。
</li></ul>

<p>&rsquo;*&rsquo; と &rsquo;**&rsquo; を組み合はせる順番は自由である。
</p><pre class="verbatim">/usr/**/sys/*
/usr/*tory/sys/**
/usr/**2/sys/*
</pre>
</dd>
<dt>2) 上向き檢索:</dt>
<dd><p>この方法ではディレクトリを指定すると、そのディレクトリから上に遡つてファイルを探す。上向き探索の上限となるディレクトリが指定できる。それはパス (オプション &rsquo;<samp>path</samp>&rsquo;) かファイル名 (オプション &rsquo;<samp>tags</samp>&rsquo;) の末尾に &rsquo;;&rsquo; で區切つて指定する。複數のディレクトリを指定したいときはそれらを &rsquo;;&rsquo; で區切る。上限ディレクトリを指定したくないときは (ルートディレクトリまで上向き檢索したいとき) &rsquo;;&rsquo; だけを付ける。
</p><pre class="verbatim">/usr/include/sys;/usr
</pre><p>で檢索されるディレクトリは:
</p><pre class="verbatim">/usr/include/sys
/usr/include
/usr
</pre><p>相對パスを使ふと上向き檢索は Vim のカレントディレクトリから始まる。相對パスの指定が &rsquo;./&rsquo; で始まり、&rsquo;<samp>cpoptions</samp>&rsquo; にフラグ &rsquo;<var>d</var>&rsquo; が含まれてゐないときはカレントファイルのディレクトリから始まる。
</p>
<p>Vim のカレントパスが /u/user_x/work/release のときに
</p><div class="example">
<pre class="example">:set path=include;/u/user_x
</pre></div>
<p>とすると、コマンド |<a href="#gf">gf</a>| でファイルを探す範圍は:
</p><pre class="verbatim">/u/user_x/work/release/include
/u/user_x/work/include
/u/user_x/include
</pre>
</dd>
<dt>3) 複合檢索:</dt>
<dd><p>Vim のカレントパスが /u/user_x/work/release のときに
</p><div class="example">
<pre class="example">set path=**;/u/user_x
</pre></div>
<p>とすると、コマンド |<a href="#gf">gf</a>| でファイルを探す範圍は:
</p><pre class="verbatim">/u/user_x/work/release/**
/u/user_x/work/**
/u/user_x/**
</pre><blockquote>
<p><strong>注意！</strong> <br>
これはかなりの時閒を食ふかもしれない。&rsquo;/u/user_x/**&rsquo; は &rsquo;/u/user_x/work/**&rsquo; や &rsquo;/u/user_x/work/release/**&rsquo; を含むからだ。つまり &rsquo;/u/user_x/work/release/**&rsquo; は 3 回、&rsquo;/u/user_x/work/**&rsquo; は 2 回繰り返して檢索される。
</p></blockquote>

<p>上の例では次のやうに設定したはうがいいかもしれない:
</p><div class="example">
<pre class="example">:set path=**,/u/user_x/**
</pre></div>
<p>これに含まれる範圍は
</p><pre class="verbatim">/u/user_x/work/release/**
/u/user_x/**
</pre><p>となり、同じディレクトリだが順番が違ふ。
</p>
<blockquote>
<p><strong>Note:</strong> <br>
現在 &quot;<code>:find</code>&quot;, &quot;<code>:sfind</code>&quot;, &quot;<code>:tabfind</code>&quot; コマンドは、&rsquo;<samp>path</samp>&rsquo; アイテムに URL や深さ制限付きのダブルスター (/usr/**2) や 上方檢索 (;) などが含まれてゐると機能しない。
</p></blockquote>
</dd>
</dl>

<hr>
<div class="header">
<p>
Up: <a href="Mu-Ci-.html#g_t_76ee_6b21" accesskey="u" rel="up">目次</a> &nbsp; [<a href="Indexes-CP.html#Indexes-CP" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>

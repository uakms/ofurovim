<!DOCTYPE html>
<html lang="ja">
<!-- Created by GNU Texinfo 6.7, http://www.gnu.org/software/texinfo/ -->
<head>

<title>tips.txt (Vim Reference Manual)</title>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<meta name="description" content="tips.txt (Vim Reference Manual)">
<meta name="keywords" content="tips.txt (Vim Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2any">
<link href="Mu-Ci-.html" rel="start" title="目次">
<link href="Indexes-CP.html" rel="index" title="Indexes CP">
<link href="Mu-Ci-.html" rel="up" title="目次">
<link href="message_002etxt.html" rel="next" title="message.txt">
<link href="howto_002etxt.html" rel="prev" title="howto.txt">
<style>
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>
<link rel="stylesheet" type="text/css" href="style.css">


</head>

<body lang="ja">
<span id="tips_002etxt"></span><div class="header">
<p>
Up: <a href="Mu-Ci-.html" accesskey="u" rel="up">目次</a> &nbsp; [<a href="Indexes-CP.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<span id="samazamana-Tips"></span><h2 class="unnumbered">さまざまな Tips</h2>
<pre class="verbatim">*tips.txt*      For Vim バージョン 8.1.  Last change: 2009 Nov 07


		  VIMリファレンスマニュアル	  by Bram Moolenaar
</pre>

<span id="tips"></span><span id="index-tips"></span>
<span id="index-Vim-woShi-utokinohintotoaidea"></span>
<p>Vim を使ふときのヒントとアイデア
</p>
<p>これは、多くのユーザーにとつて便利だらうと思ふことの一部です。wiki にはもつと多くの tips があります。<a href="http://www.vim.org">http://www.vim.org</a>
</p>
<p>ユーザーマニュアルも參照してください。ユーザーマニュアルにはたくさんの tips が含まれてゐます |<a href="usr_005ftoc_002etxt.html">usr_toc.txt</a>|。
</p>
<table>
<tr><td width="30%">|<a href="#C_002dediting">C-editing</a>|</td><td width="70%">C のプログラムを編輯する</td></tr>
<tr><td width="30%">|<a href="#ident_002dsearch">ident-search</a>|</td><td width="70%">識別子が使はれてゐる場所を檢索する</td></tr>
<tr><td width="30%">|<a href="#xterm_002dscreens">xterm-screens</a>|</td><td width="70%">xterm でのスクリーンの切り替へ</td></tr>
<tr><td width="30%">|<a href="#scroll_002dinsert">scroll-insert</a>|</td><td width="70%">插入モードでスクロールを行ふ</td></tr>
<tr><td width="30%">|<a href="#scroll_002dsmooth">scroll-smooth</a>|</td><td width="70%">スムーズにスクロールさせる</td></tr>
<tr><td width="30%">|<a href="#type_002dmistakes">type-mistakes</a>|</td><td width="70%">ありがちなタイプミスを修正する</td></tr>
<tr><td width="30%">|<a href="#count_002ditems">count-items</a>|</td><td width="70%">單語や行などの數を數へる</td></tr>
<tr><td width="30%">|<a href="#restore_002dposition">restore-position</a>|</td><td width="70%">カーソルの位置を戾す</td></tr>
<tr><td width="30%">|<a href="#rename_002dfiles">rename-files</a>|</td><td width="70%">ファイルをリネームする</td></tr>
<tr><td width="30%">|<a href="#change_002dname">change-name</a>|</td><td width="70%">複數ファイル中の名前を置換する</td></tr>
<tr><td width="30%">|<a href="#speed_002dup">speed-up</a>|</td><td width="70%">外部コマンドの實行速度を速くする</td></tr>
<tr><td width="30%">|<a href="#useful_002dmappings">useful-mappings</a>|</td><td width="70%">便利なマッピング</td></tr>
<tr><td width="30%">|<a href="#gzip_002dhelpfile">gzip-helpfile</a>|</td><td width="70%">ヘルプファイルを壓縮する</td></tr>
<tr><td width="30%">|<a href="#shell_002dwindow">shell-window</a>|</td><td width="70%">ウィンドウでシェルコマンドを實行する</td></tr>
<tr><td width="30%">|<a href="#hex_002dediting">hex-editing</a>|</td><td width="70%">バイナリ編輯</td></tr>
<tr><td width="30%">|<a href="#autocmd_002d_003c_003e">autocmd-&lt;&gt;</a>|</td><td width="70%">自動コマンドで &lt;&gt; 表記を使ふ</td></tr>
<tr><td width="30%">|<a href="#match_002dparens">match-parens</a>|</td><td width="70%">對應する括弧を强調する</td></tr>
</table>

<span id="C_002dediting"></span><span id="index-C_002dediting"></span>
<span id="index-C-nopuroguramuwoBian-Ji-suru"></span>
<span id="C-nopuroguramuwoBian-Ji-suru"></span><h3 class="section">C のプログラムを編輯する</h3>

<p>Vim には C のプログラムファイルを編輯するのを手助けする機能がたくさんあります。詳細をジャンプして確認できるやうにタグつきで機能のあらましを紹介しませう。
</p>
<table>
<tr><td width="20%">|<a href="usr_005f29_002etxt.html">usr_29.txt</a>|</td><td width="80%">ユーザーマニュアルの「プログラム內の移動」</td></tr>
<tr><td width="20%">|<a href="usr_005f30_002etxt.html">usr_30.txt</a>|</td><td width="80%">ユーザーマニュアルの「プログラムの編輯」</td></tr>
<tr><td width="20%">|<a href="indent_002etxt.html#C_002dindenting">C-indenting</a>|</td><td width="80%">テキストをタイプ中、自動的に行をインデントします。</td></tr>
<tr><td width="20%">|<a href="change_002etxt.html#g_t_003d">=</a>|</td><td width="80%">數行をインデントし直します。</td></tr>
<tr><td width="20%">|<a href="change_002etxt.html#format_002dcomments">format-comments</a>|</td><td width="80%">コメントを自動的にフォーマットします。</td></tr>
<tr><td width="20%"></td></tr>
<tr><td width="20%">|<a href="tagsrch_002etxt.html#g_t_003acheckpath">:checkpath</a>|</td><td width="80%">再歸的にインクルードされるファイルをすべて表示します。</td></tr>
<tr><td width="20%">|<a href="tagsrch_002etxt.html#g_t_005bi">[i</a>|</td><td width="80%">カーソルの下にある單語と同じものを現在のファイルとインクルードされるファイルから探します。</td></tr>
<tr><td width="20%">|<a href="tagsrch_002etxt.html#g_t_005b_005fCTRL_002dI">[_CTRL-I</a>|</td><td width="80%">&quot;[i&quot; でマッチした場所にジャンプします。</td></tr>
<tr><td width="20%">|<a href="tagsrch_002etxt.html#g_t_005bI">[I</a>|</td><td width="80%">カーソルの下にある單語と同じものを現在のファイルとインクルードされるファイルから探し出しその行のリストを表示します。</td></tr>
<tr><td width="20%"></td></tr>
<tr><td width="20%">|<a href="tagsrch_002etxt.html#g_t_005bd">[d</a>|</td><td width="80%">カーソルの下の單語の定義を現在のファイルとインクルードされるファイルから探します</td></tr>
<tr><td width="20%">|<a href="tagsrch_002etxt.html#CTRL_002d_005d">CTRL-]</a>|</td><td width="80%">カーソルの下のタグにジャンプします。(例、函數の定義)</td></tr>
<tr><td width="20%">|<a href="tagsrch_002etxt.html#CTRL_002dT">CTRL-T</a>|</td><td width="80%">CTRL-] コマンドの前に戾ります。</td></tr>
<tr><td width="20%">|<a href="tagsrch_002etxt.html#g_t_003atselect">:tselect</a>|</td><td width="80%">マッチしたタグのリストから 1 つ選びます。</td></tr>
<tr><td width="20%"></td></tr>
<tr><td width="20%">|<a href="pattern_002etxt.html#gd">gd</a>|</td><td width="80%">カーソルの下のローカル變數の宣言にジャンプする。</td></tr>
<tr><td width="20%">|<a href="pattern_002etxt.html#gD">gD</a>|</td><td width="80%">カーソルの下のグローバル變數の宣言にジャンプする。</td></tr>
<tr><td width="20%"></td></tr>
<tr><td width="20%">|<a href="editing_002etxt.html#gf">gf</a>|</td><td width="80%">カーソルの下のファイル名にジャンプする。</td></tr>
<tr><td width="20%"></td></tr>
<tr><td width="20%">|<a href="motion_002etxt.html#g_t_0025">%</a>|</td><td width="80%">對應する (), {}, [], /* */, #if, #else, #endif に移動する。</td></tr>
<tr><td width="20%">|<a href="motion_002etxt.html#g_t_005b_002f">[/</a>|</td><td width="80%">前のコメントが始まる場所に移動する。</td></tr>
<tr><td width="20%">|<a href="motion_002etxt.html#g_t_005d_002f">]/</a>|</td><td width="80%">次のコメントが終はる場所に移動する。</td></tr>
<tr><td width="20%">|<a href="motion_002etxt.html#g_t_005b_0023">[#</a>|</td><td width="80%">前の閉ぢられてゐない #if, #ifdef, #else に移動する。</td></tr>
<tr><td width="20%">|<a href="motion_002etxt.html#g_t_005d_0023">]#</a>|</td><td width="80%">次の閉ぢられてゐない #else, #endif に移動する。</td></tr>
<tr><td width="20%">|<a href="motion_002etxt.html#g_t_005b_0028">[(</a>|</td><td width="80%">前の閉ぢられてゐない &rsquo;(&rsquo; に移動する。</td></tr>
<tr><td width="20%">|<a href="motion_002etxt.html#g_t_005d_0029">])</a>|</td><td width="80%">次の閉ぢられてゐない &rsquo;)&rsquo; に移動する。</td></tr>
<tr><td width="20%">|<a href="motion_002etxt.html#g_t_005b_007b">[{</a>|</td><td width="80%">前の閉ぢられてゐない &rsquo;{&rsquo; に移動する。</td></tr>
<tr><td width="20%">|<a href="motion_002etxt.html#g_t_005d_007d">]}</a>|</td><td width="80%">次の閉ぢられてゐない &rsquo;}&rsquo; に移動する。</td></tr>
<tr><td width="20%"></td></tr>
<tr><td width="20%">|<a href="motion_002etxt.html#v_005fab">v_ab</a>|</td><td width="80%">「ブロック(&quot;[(&quot;から&quot;])&quot;まで)」を括弧を含めて選擇する。</td></tr>
<tr><td width="20%">|<a href="motion_002etxt.html#v_005fib">v_ib</a>|</td><td width="80%">「ブロック(&quot;[(&quot;から&quot;])&quot;まで)の內部」を選擇する。</td></tr>
<tr><td width="20%">|<a href="motion_002etxt.html#v_005faB">v_aB</a>|</td><td width="80%">「ブロック(&quot;[{&quot;から&quot;]}&quot;まで)」を括弧を含めて選擇する。</td></tr>
<tr><td width="20%">|<a href="motion_002etxt.html#v_005fiB">v_iB</a>|</td><td width="80%">「ブロック(&quot;[{&quot;から&quot;]}&quot;まで)の內部」を選擇する。</td></tr>
</table>

<span id="ident_002dsearch"></span><span id="index-ident_002dsearch"></span>
<span id="index-Shi-Bie-Zi-gaShi-wareteiruChang-Suo-woJian-Suo-suru"></span>
<span id="Shi-Bie-Zi-gaShi-wareteiruChang-Suo-woJian-Suo-suru"></span><h3 class="section">識別子が使はれてゐる場所を檢索する</h3>

<p>|<a href="tagsrch_002etxt.html#tags">tags</a>| が函數や變數の定義された場所へのジャンプに使へることはすでにわかりましたが、ときどき函數や變數が使はれてゐる場所にジャンプしたいことがあります。これは 2 つの方法で實現することができます:
</p><ol>
<li> |<a href="quickfix_002etxt.html#g_t_003agrep">:grep</a>| を使ふ方法。この方法はほとんどの Unix システムでうまく動作しますが遲いですし (全てのファイルを讀むため)、1 つのディレクトリの中だけしか檢索できません。
</li><li> ID ユーティリティを使ふ方法。この方法は速いですし複數のディレクトリを檢索できます。この方法は位置を記憶するためにデータベースを使用します。いくつかのプログラムを新たに入れる必要があります。そして、データベースを最新に保つことが要求されます。
</li></ol>

<span id="GNU-id_002dtools-to-Vim-woLian-Dong-saseru_002e-"></span><h4 class="unnumberedsubsec">GNU id-tools と Vim を連動させる。</h4>

<p>必要なもの:
</p><ul>
<li> The GNU id-tools がインストールされてゐること (ID を生成するには mkid が必要でマクロを使ふのにlidが必要です)。
</li><li> 現在のディレクトリに &quot;ID&quot; と呼ばれる識別子データベースファイルがあること。シェルコマンド &quot;mkid file1 file2 ..&quot; で作成可能です。
</li></ul>

<p>次の行を <samp>.vimrc</samp> に追加してください。
</p><pre class="verbatim">map _u :call ID_search()&lt;Bar&gt;execute &quot;/\\&lt;&quot; . g:word . &quot;\\&gt;&quot;&lt;CR&gt;
map _n :n&lt;Bar&gt;execute &quot;/\\&lt;&quot; . g:word . &quot;\\&gt;&quot;&lt;CR&gt;

function! ID_search()
  let g:word = expand(&quot;&lt;cword&gt;&quot;)
  let x = system(&quot;lid --key=none &quot;. g:word)
  let x = substitute(x, &quot;\n&quot;, &quot; &quot;, &quot;g&quot;)
  execute &quot;next &quot; . x
endfun
</pre>
<p>これを使ふには、單語上にカーソルを置いて、&quot;_u&quot; とタイプすれば Vim は單語を含んだファイルを讀みこみます。同じファイルで次に單語が出てくるところを檢索するには &quot;n&quot; をタイプします。&quot;_n&quot; で次のファイルに行きます。
</p>
<p>この方法は id-utils-3.2 を使つて動作を確認しました (id-utlis-3.2 は id-tools アーカイブの名前です。近くの gnu-ftp-mirror から入手してください。)
</p>
<p>[このアイデアは Andreas Kutschera さんから頂いたものです]
</p>
<span id="xterm_002dscreens"></span><span id="xterm_002dsave_002dscreen"></span><span id="index-xterm_002dscreens"></span>
<span id="index-xterm_002dsave_002dscreen"></span>
<span id="index-xterm-denosukurinnoQie-riTi-e"></span>
<span id="xterm-denosukurinnoQie-riTi-e"></span><h3 class="section">xterm でのスクリーンの切り替へ</h3>

<p>(comp.editors で質問に答へて Juergen Weigert 氏が投稿したもの)
</p>
<blockquote>
<p>:&gt; もう 1 つの質問は Vim を終了させた後にスクリーンがそのまま殘つてゐることに關してです。例へばいままで見てゐた (編輯していた) 內容がスクリーンに殘つてゐますよね。そして前に行つた ls などのコマンドの出力が消えてしまふのです(例へばスクロールバッファからなくなつてしまふ)。Vim や他の vi 風のエディタでもどうにかして前の畫面を復元する方法があるとは思ふのですが、どのやうにすれば實現できるのかわかりません。敎へていただけると嬉しいです。それでは。
</p>
<p>:どなたか詳しい方が答へて下さると思ひます。Vim も vi も xterm の設定をみて同じことをそれぞれやつてゐると思ふのですが。
</p></blockquote>

<p>これらは必ずしも同じ動作をするとは限りません、といふのはこれは termcap と terminfo の問題であるかもしれないからです。個々のタイプのターミナルの屬性を記述するデータベースには termcap と terminfo といふ 2 つのデータベースがあるといふことを知つておいてください。エントリが異なつてゐて、かつ質問にあつたプログラムのどれかが termcap を使つてゐて他のものが terminfo を使つてゐた場合、違ふ動作をすることになりえます。
</p>
<p>(|<a href="various_002etxt.html#g_t_002bterminfo">+terminfo</a>| も參照してください)
</p>
<p>この問題の場合、^[[?47h と ^[[?47l といふコントロールシーケンスが答へになります。これらは xterm のメインスクリーンバッファともう一方のバッファを切り替へるのに用ゐられます。簡單に動作させてみるには次のコマンドを打つてみてください。
</p><pre class="verbatim">echo -n &quot;^[[?47h&quot;; vim ... ; echo -n &quot;^[[?47l&quot;
</pre><p>あなたが望む動作はこれかもしれません。(ここで ^[ は ESC キャラクターを意味します。このあとデータベースではこの記號の代はりに \E を使つてゐることがわかるでせう)
</p>
<p>起動時に vim は termcap の ti 變數 (terminfo の場合: smcup) の値を echo し、終了時には te 變數 (terminfo の場合: rmcup) の値をターミナルに echo します。といふわけで、これらの 2 つの變數が上記のコントロールシーケンスを設定する正しい場所です。
</p>
<p>xterm の termcap エントリ (/etc/termcap にあります) と xterm の terminfo エントリ (infocmp -C xterm として入手します) とを比べてみてください。雙方に次のやうなエントリが含まれてゐる必要があります。
</p><pre class="verbatim">:te=\E[2J\E[?47l\E8:ti=\E7\E[?47h:
</pre>
<blockquote>
<p><strong>追伸:</strong> <br> もしなんらかの違ひを見つけた場合、だれかが (システム管理者かな？) termcap と terminfo データベースを繼續的にチェックするやうにした方がよいです。
</p></blockquote>

<blockquote>
<p><strong>Note1:</strong> <br>
feature.h で定義される FEAT_XTERM_SAVE をつけて Vim を再コンパイルすると內藏の xterm は上記の &quot;te&quot; と &quot;ti&quot; エントリを含むやうになります。
</p></blockquote>

<blockquote>
<p><strong>Note2:</strong> <br>
スクリーンのスイッチを行はないやうにし、termcap の變更も行ひたくない場合次の行を .vimrc に加へてください。
</p><pre class="verbatim">:set t_ti= t_te=
</pre></blockquote>

<span id="scroll_002dinsert"></span><span id="index-scroll_002dinsert"></span>
<span id="index-Cha-Ru-mododesukuroruwoXing-u"></span>
<span id="Cha-Ru-mododesukuroruwoXing-u"></span><h3 class="section">插入モードでスクロールを行ふ</h3>

<p>插入モードでスクリーンの外の部分を見たい場合、<kbd>CTRL-X</kbd> <kbd>CTRL-E</kbd> と <kbd>CTRL-X</kbd> <kbd>CTRL-Y</kbd> を使ふことでスクリーンをスクロールさせることができます。|<a href="insert_002etxt.html#i_005fCTRL_002dX_005fCTRL_002dE">i_CTRL-X_CTRL-E</a>|
</p>
<p>これを簡單に行ふには次のマッピングをすることができます:
</p><pre class="verbatim">:inoremap &lt;C-E&gt; &lt;C-X&gt;&lt;C-E&gt;
:inoremap &lt;C-Y&gt; &lt;C-X&gt;&lt;C-Y&gt;
</pre><p>(文字通り入力するには、&rsquo;<var>&lt;</var>&rsquo; フラグが &rsquo;<samp>cpoptions</samp>&rsquo; にないことを確認してください) しかしこれを行ふとカーソルの上/下の行のテキストをコピーする機能が使へなくなります。|<a href="insert_002etxt.html#i_005fCTRL_002dE">i_CTRL-E</a>|.
</p>
<p>カーソルの周りの前後を常に見渡せるやうに &rsquo;<samp>scrolloff</samp>&rsquo; オプションの値を大きい値に設定するのもよいです。&rsquo;<samp>scrolloff</samp>&rsquo; の値がウィンドウの高さの半分以上に設定されてゐるとカーソルが常にスクリーンの中央にあることになりテキストはカーソルの上下移動にあはせてスクロールすることになります。
</p>
<span id="scroll_002dsmooth"></span><span id="index-scroll_002dsmooth"></span>
<span id="index-sumuzunisukurorusaseru"></span>
<span id="sumuzunisukurorusaseru"></span><h3 class="section">スムーズにスクロールさせる</h3>

<p>もう少しスムーズにスクロールさせたい場合、次のマッピングを使ふこともできます:
</p><pre class="verbatim">:map &lt;C-U&gt; &lt;C-Y&gt;&lt;C-Y&gt;&lt;C-Y&gt;&lt;C-Y&gt;&lt;C-Y&gt;&lt;C-Y&gt;&lt;C-Y&gt;&lt;C-Y&gt;&lt;C-Y&gt;&lt;C-Y&gt;&lt;C-Y&gt;&lt;C-Y&gt;&lt;C-Y&gt;&lt;C-Y&gt;&lt;C-Y&gt;&lt;C-Y&gt;
:map &lt;C-D&gt; &lt;C-E&gt;&lt;C-E&gt;&lt;C-E&gt;&lt;C-E&gt;&lt;C-E&gt;&lt;C-E&gt;&lt;C-E&gt;&lt;C-E&gt;&lt;C-E&gt;&lt;C-E&gt;&lt;C-E&gt;&lt;C-E&gt;&lt;C-E&gt;&lt;C-E&gt;&lt;C-E&gt;&lt;C-E&gt;
</pre>
<p>(文字通り入力するには、&rsquo;<var>&lt;</var>&rsquo; フラグが &rsquo;<samp>cpoptions</samp>&rsquo; にないことを確認してください)
</p>
<span id="type_002dmistakes"></span><span id="index-type_002dmistakes"></span>
<span id="index-arigatinataipumisuwoXiu-Zheng-suru"></span>
<span id="arigatinataipumisuwoXiu-Zheng-suru"></span><h3 class="section">ありがちなタイプミスを修正する</h3>

<p>しよつちゆう閒違つてタイプする單語がいくつかあれば、短縮入力を修正するのに利用しませう。例へば:
</p><pre class="verbatim">:ab teh the
:ab fro for
</pre>
<span id="count_002ditems"></span><span id="index-count_002ditems"></span>
<span id="index-Dan-Yu-yaXing-nadonoShu-woShu-eru"></span>
<span id="Dan-Yu-yaXing-nadonoShu-woShu-eru"></span><h3 class="section">單語や行などの數を數へる</h3>

<p>カレントバッファの中になんらかのパターンがどのくらゐの回數現れるのかを數へるには、<code>substitute</code> コマンドを使ひ、實際に置換するのを避けるためにフラグ &rsquo;<var>n</var>&rsquo; をつけます。報告される數がそのアイテムの數です。例:
</p>
<table>
<tr><td width="50%">:%s/./&amp;/gn</td><td width="50%">文字</td></tr>
<tr><td width="50%">:%s/\i\+/&amp;/gn</td><td width="50%">單語</td></tr>
<tr><td width="50%">:%s/^//n</td><td width="50%">行</td></tr>
<tr><td width="50%">:%s/the/&amp;/gn</td><td width="50%">&quot;the&quot; (どこかしら)</td></tr>
<tr><td width="50%">:%s/\&lt;the\&gt;/&amp;/gn</td><td width="50%">&quot;the&quot; (單語一致)</td></tr>
</table>

<p>&rsquo;hlsearch&rsquo; をリセットするか、&quot;:nohlsearch&quot; をしたくなるかもしれません。マッチが1個もないときにエラーになつてほしくなければフラグ &rsquo;e&rsquo; をつけます。
</p>
<p>別の方法としては、ビジュアルモードで |<a href="editing_002etxt.html#v_005fg_005fCTRL_002dG">v_g_CTRL-G</a>| を使ひます。
</p>
<p>複數のファイルから檢索したければ |<a href="quickfix_002etxt.html#g_t_003avimgrep">:vimgrep</a>| を使ひます。
</p>
<span id="count_002dbytes"></span><span id="index-count_002dbytes"></span>
<span id="index-baitoShu-woShu-eru"></span>
<p>バイト數を數へるにはこれを使つてください。
</p>
<p>文字列を選擇してください (ブロック選擇も使へます) <br>
&quot;y&quot; でコピーしてください <br>
そして、strlen() を使ひます <br>
</p><pre class="verbatim">:echo strlen(@&quot;)
</pre><p>改行は 1 バイトとして數へられます。
</p>
<span id="restore_002dposition"></span><span id="index-restore_002dposition"></span>
<span id="index-kasorunoWei-Zhi-woLi-su"></span>
<span id="kasorunoWei-Zhi-woLi-su"></span><h3 class="section">カーソルの位置を戾す</h3>

<p>ときにはファイルのどこかに變更を加へて、テキストをスクロールすることなくカーソルを元の位置に戾すやうなマッピングを書きたくなることがあります。ファイルに書いた日附を變更する例をあげます:
</p><pre class="verbatim">:map &lt;F2&gt; msHmtgg/Last [cC]hange:\s*/e+1&lt;CR&gt;&quot;_D&quot;=strftime(&quot;%Y %b %d&quot;)&lt;CR&gt;p'tzt`s
</pre>
<p>位置を記憶する:
</p><table>
<tr><td width="20%">ms</td><td width="80%">&rsquo;s&rsquo; マークにカーソルの位置を記錄します</td></tr>
<tr><td width="20%">H</td><td width="80%">ウィンドウに表示された最初の行に移動します</td></tr>
<tr><td width="20%">mt</td><td width="80%">その行を &rsquo;t&rsquo; マークに記錄します</td></tr>
</table>

<p>位置を元に戾す:
</p><table>
<tr><td width="20%">&rsquo;t</td><td width="80%">先程のウィンドウに表示された最初の行に移動します</td></tr>
<tr><td width="20%">zt</td><td width="80%">その行がウィンドウの最初に表示されるやうにスクロールします</td></tr>
<tr><td width="20%">&lsquo;s</td><td width="80%">最初の位置に戾ります</td></tr>
</table>

<p>より高度なことについては |<a href="eval_002etxt.html#winsaveview_0028_0029">winsaveview()</a>| と |<a href="eval_002etxt.html#winrestview_0028_0029">winrestview()</a>| を參照してください。
</p>
<span id="rename_002dfiles"></span><span id="index-rename_002dfiles"></span>
<span id="index-huairuworinemusuru"></span>
<span id="huairuworinemusuru"></span><h3 class="section">ファイルをリネームする</h3>

<p>例へば以下のやうなファイルを含むディレクトリがあるとします(ディレクトリはランダムに選び出したものです :-):
</p>
<pre class="verbatim"> buffer.c
 charset.c
 digraph.c
 ...
</pre>
<p>そして *.c を *.bla にリネームしたい場合次のやうなコマンドを實行します:
</p>
<pre class="verbatim">$ vim
:r !ls *.c
:%s/\(.*\).c/mv &amp; \1.bla
:w !sh
:q!
</pre>
<span id="change_002dname"></span><span id="index-change_002dname"></span>
<span id="index-Fu-Shu-huairuZhongnoMing-Qian-woZhi-Huan-suru"></span>
<span id="Fu-Shu-huairuZhongnoMing-Qian-woZhi-Huan-suru"></span><h3 class="section">複數ファイル中の名前を置換する</h3>

<p>スクリプトファイルを使つて複數ファイル中の名前を置換する例です:
</p>
<p>以下のやうに置換コマンドと <code>:update</code> コマンドを含む &quot;<samp>subs.vim</samp>&quot; といふファイルを作成します:
</p><pre class="verbatim">:%s/Jones/Smith/g
:%s/Allen/Peter/g
:update
</pre><p>Vim で置換したい全ファイルを開き、各引數に對してこのスクリプトを實行します:
</p>
<pre class="verbatim">vim *.let
argdo source subs.vim
</pre>
<p>|<a href="editing_002etxt.html#g_t_003aargdo">:argdo</a>| も參照。
</p>
<span id="speed_002dup"></span><span id="index-speed_002dup"></span>
<span id="index-Wai-Bu-komandonoShi-Xing-Su-Du-woSu-kusuru"></span>
<span id="Wai-Bu-komandonoShi-Xing-Su-Du-woSu-kusuru"></span><h3 class="section">外部コマンドの實行速度を速くする</h3>

<p>いくつかの狀況では外部コマンドの實行速度が非常に遲くなる場合があります。これは Unix でのワイルドカード展開が行はれた場合もさうです。いくつかのスピードアップする方法を紹介しませう。
</p>
<p>もし <samp>.cshrc</samp> (もしくは他のファイル、使つてゐるシェルによります) が非常に長いならばそれを對話的に使ふ部分とさうでない用途 (セカンダリーシェルとよく呼ばれます) の部分にわけるべきです。Vim から &quot;:!ls&quot; のやうなコマンドを實行する場合、對話的に行ふ必要はありませんよね (例へば、プロンプトを出させたり)。次の行の後にそれらをおくやうにしてください。
</p>
<pre class="verbatim">if ($?prompt == 0) then
    exit 0
endif
</pre>
<p>もう 1 つの方法は &rsquo;<samp>shell</samp>&rsquo; オプションに &quot;<var>-f</var>&quot; フラグをつける方法です、例へば:
</p>
<pre class="verbatim">:set shell=csh\ -f
</pre>
<p>(オプションの中にスペースを含めるにはバックスラッシュが必要です)
</p>
<p>かうすると csh が <samp>.cshrc</samp> ファイルを讀み込まないやうにすることができます。しかしかうすることでなんらかが動作しない場合もあるかもしれません。
</p>
<span id="useful_002dmappings"></span><span id="index-useful_002dmappings"></span>
<span id="index-Bian-Li-namatupingu"></span>
<span id="Bian-Li-namatupingu"></span><h3 class="section">便利なマッピング</h3>

<p>ここでいくつか好んで使はれるマッピングを紹介します。
</p>
<span id="map_002dbacktick"></span><span id="index-map_002dbacktick"></span>
<pre class="verbatim">:map ' `
</pre><p>シングル引用符の動作をバック引用符の動作のやうにします。カーソルをマークがある行の最初の非空白文字に移動させるのではなく、マークがある桁位置に移動させます。
</p>
<span id="emacs_002dkeys"></span><span id="index-emacs_002dkeys"></span>
<span id="index-Emacs-sutairukibaindo"></span>
<p>コマンドラインでのキーバインドを Emacs スタイルにします:
</p><pre class="verbatim">&quot; 行頭へ移動
:cnoremap &lt;C-A&gt;     &lt;Home&gt;
&quot; 一文字戾る
:cnoremap &lt;C-B&gt;     &lt;Left&gt;
&quot; カーソルの下の文字を削除
:cnoremap &lt;C-D&gt;     &lt;Del&gt;
&quot; 行末へ移動
:cnoremap &lt;C-E&gt;     &lt;End&gt;
&quot; 一文字進む
:cnoremap &lt;C-F&gt;     &lt;Right&gt;
&quot; コマンドライン履歷を 1 つ進む
:cnoremap &lt;C-N&gt;     &lt;Down&gt;
&quot; コマンドライン履歷を 1 つ戾る
:cnoremap &lt;C-P&gt;     &lt;Up&gt;
&quot; 前の單語へ移動
:cnoremap &lt;Esc&gt;&lt;C-B&gt;    &lt;S-Left&gt;
&quot; 次の單語へ移動
:cnoremap &lt;Esc&gt;&lt;C-F&gt;    &lt;S-Right&gt;
</pre>
<blockquote>
<p><strong>Note:</strong> <br>
これを利用するには &rsquo;<samp>cpoptions</samp>&rsquo; から &rsquo;<var>&lt;</var>&rsquo; フラグを外しておく必要があります。|<a href="intro_002etxt.html#g_t_003c_003e">&lt;&gt;</a>|
</p></blockquote>

<span id="format_002dbullet_002dlist"></span><span id="index-format_002dbullet_002dlist"></span>
<p>このマッピングはブレットリストのフォーマットを整へるものです。それぞれのリストのエントリの前後に空行がある必要があります。式が使はれてゐるのはマッピングを部分的に解說するコメントを入れるためです。
</p>
<pre class="verbatim">:let m =     &quot;:map _f  :set ai&lt;CR&gt;&quot;   &quot; 'autoindent' をセット
:let m = m . &quot;{O&lt;Esc&gt;&quot;                &quot; アイテムの上に空行を插入
:let m = m . &quot;}{)^W&quot;                  &quot; ブレットの後のテキストに移動
:let m = m . &quot;i    &lt;CR&gt;     &lt;Esc&gt;&quot;    &quot; インデントの爲のスペースを插入
:let m = m . &quot;gq}&quot;                    &quot; ブレットの後のテキストを整形
:let m = m . &quot;{dd&quot;                    &quot; 空行を削除
:let m = m . &quot;5lDJ&quot;                   &quot; ブレットの後にテキストを置く
:execute m                           |&quot; マッピングを決定する
</pre>
<p>(&lt;&gt; 表記法 |<a href="intro_002etxt.html#g_t_003c_003e">&lt;&gt;</a>|。これらは文字どほりにタイプするといふことに注意してください。^W は &quot;^&quot; &quot;W&quot; で CTRL-W ではありません。&rsquo;<samp>cpoptions</samp>&rsquo; に &rsquo;<var>&lt;</var>&rsquo; がなければ Vim にコピー/ペーストすることができますよ。)
</p>
<p>最後のコメントは |&quot; で始まつてゐることに注意してください、これは &quot;<code>:execute</code>&quot; コマンドが直接のコメントを受け付けないからです。
</p>
<p>また &rsquo;<samp>textwidth</samp>&rsquo; を 0 以外の値にしておく必要があります。例へば:
</p><pre class="verbatim">:set tw=70
</pre>
<p>最初の行からインデントすることになりますが次のやうなマッピングでも同じことができます (<strong>Note:</strong> このマッピングは多くのスペースを含む長い 1 つの行です):
</p><pre class="verbatim">       :map _f :set ai&lt;CR&gt;}{a                               &lt;Esc&gt;WWmmkD`mi&lt;CR&gt;&lt;Esc&gt;kkddpJgq}'mJO&lt;Esc&gt;j
</pre><blockquote>
<p><strong>補足:</strong> <br>
「タブ幅を 8、端末の幅を 80 桁にして表示すると、:map と &lt;Esc&gt; の行頭が揃ふ」といふお話しらしいけど、タブ嫌ひやねん。
</p></blockquote>
<span id="collapse"></span><span id="index-collapse"></span>
<p>これら 2 つのマッピングは空行 (;b) もしくは空白文字のみからなる行 (;n) の連續を 1 行にします。
</p><pre class="verbatim">:map ;b   GoZ&lt;Esc&gt;:g/^$/.,/./-j&lt;CR&gt;Gdd
:map ;n   GoZ&lt;Esc&gt;:g/^[ &lt;Tab&gt;]*$/.,/[^ &lt;Tab&gt;]/-j&lt;CR&gt;Gdd
</pre>
<span id="gzip_002dhelpfile"></span><span id="index-gzip_002dhelpfile"></span>
<span id="index-herupuhuairuwoYa-Suo-suru"></span>
<span id="herupuhuairuwoYa-Suo-suru"></span><h3 class="section">ヘルプファイルを壓縮する</h3>

<p>ディスクスペースに空きがあまりない人はヘルプファイルを壓縮することができます。壓縮した後でもヘルプファイルを閱覽することはできます。ヘルプファイルへのアクセスは少し遲くなります。また &quot;gzip&quot; プログラムが必要です。
</p>
<ol>
<li> すべてのヘルプファイルを壓縮するには: &quot;gzip doc/*.txt&quot;

</li><li> &quot;doc/tags&quot; を編輯して &quot;.txt&quot; を &quot;.txt.gz&quot; にします。
<pre class="verbatim">:%s=\(\t.*\.txt\)\t=\1.gz\t=
</pre>
</li><li> 次の行を vimrc に追加します:
<pre class="verbatim">set helpfile={dirname}/help.txt/gz
</pre></li></ol>

<p>{dirname} はヘルプファイルのある場所です。|<a href="pi_005fgzip_002etxt.html#gzip">gzip</a>| プラグインがファイルの解凍をします。それともし壓縮された &quot;doc&quot; ディレクトリと同じ場所に他の Vim ファイルがない場合、<code>$VIMRUNTIME</code> が他の Vim ファイルがある場所になるやうにしておかなければなりません。|<a href="starting_002etxt.html#g_t_0024VIMRUNTIME">$VIMRUNTIME</a>| も參照してください。
</p>
<span id="shell_002dwindow"></span><span id="index-shell_002dwindow"></span>
<span id="index-uindoudesierukomandowoShi-Xing-suru"></span>
<span id="uindoudesierukomandowoShi-Xing-suru"></span><h3 class="section">ウィンドウでシェルコマンドを實行する</h3>

<p>|<a href="terminal_002etxt.html#terminal">terminal</a>| を參照。
</p>
<p>別の方法は、&quot;splitvt&quot; プログラムを使つて端末のスクリーンもしくはウィンドウの表示を分割するこです。このプログラムはたぶんどこかの ftp サーバーで見つけることができると思ひます。このプログラムに詳しいのは Sam Lantinga &lt;slouken@cs.ucdavis.edu&gt; です。
</p>
<p>また別の方法は &quot;window&quot; コマンドを利用する方法で、このコマンドは BSD Unix システムにあります。このコマンドは複數のウィンドウをオーバーラップさせることができます。それか &quot;screen&quot; プログラムを使ふかです。これは <a href="www.uni-erlangen.de">www.uni-erlangen.de</a> で見つけることができ、このプログラムでウィンドウの積み重ねをすることができます。
</p>
<span id="hex_002dediting"></span><span id="using_002dxxd"></span><span id="index-hex_002dediting"></span>
<span id="index-using_002dxxd"></span>
<span id="index-bainariBian-Ji-"></span>
<span id="bainariBian-Ji-"></span><h3 class="section">バイナリ編輯</h3>

<p>ユーザーマニュアルの |<a href="usr_005f23_002etxt.html#g_t23_002e4">23.4</a>| を參照してください。
</p>
<p>もしそのファイルがバイナリファイル特有の擴張子 (exe、bin など) をしてゐるときは、あなたの &lt;.vimrc&gt; に次の自動コマンドを加へることで、變換の過程を自動化しておくこともできます。&quot;*.bin&quot; をあなたの編輯したいファイルの擴張子の、コンマで區切られたリストに變へてください:
</p>
<pre class="verbatim">&quot; vim -b : edit binary using xxd-format!
augroup Binary
  au!
  au BufReadPre  *.bin let &amp;bin=1
  au BufReadPost *.bin if &amp;bin | %!xxd
  au BufReadPost *.bin set ft=xxd | endif
  au BufWritePre *.bin if &amp;bin | %!xxd -r
  au BufWritePre *.bin endif
  au BufWritePost *.bin if &amp;bin | %!xxd
  au BufWritePost *.bin set nomod | endif
augroup END
</pre>

<span id="autocmd_002d_003c_003e"></span><span id="index-autocmd_002d_003c_003e"></span>
<span id="index-Zi-Dong-komandode-_003c_003e-Biao-Ji-woShi-u"></span>
<span id="Zi-Dong-komandode-_003c_003e-Biao-Ji-woShi-u"></span><h3 class="section">自動コマンドで &lt;&gt; 表記を使ふ</h3>

<p>&lt;&gt; 表記は <code>:autocmd</code> の引數として使つても正しく解釋されません。特殊な文字を入力するのを避けるには、&lt;&gt; 表記をするための自己破壞的なマッピング行つてそれから自動コマンドの中でそのマッピングを呼び出すことで實現することもできます。例:
</p>
<span id="map_002dself_002ddestroy"></span><span id="index-map_002dself_002ddestroy"></span>
<pre class="verbatim"> &quot; この方法はファイル名を自動的にメニューリストに追加するものです。
 &quot; 自己破壞的なマッピングを使つてゐます！
 &quot; 1. ファイル名に含まれる 'dots' を \. に變更するためにバッファの 1 つの行を使
 &quot;    います。
 &quot; 2. それをレジスタ '&quot;' に格納します。
 &quot; 3. その名前をバッファメニューリストに追加します。
 &quot; 警告: この方法にはいくらか副作用があります。現在のレジスタの內容を上書きし
 &quot; たり &quot;i&quot; コマンドへのマッピングをすべて削除してしまつたりします。
 &quot;
 autocmd BufNewFile,BufReadPre * nmap i :nunmap i&lt;CR&gt;O&lt;C-R&gt;%&lt;Esc&gt;:.g/\./s/\./\\./g&lt;CR&gt;0&quot;9y$u:menu Buffers.&lt;C-R&gt;9 :buffer &lt;C-R&gt;%&lt;C-V&gt;&lt;CR&gt;&lt;CR&gt;
 autocmd BufNewFile,BufReadPre * normal i
</pre>
<p>もう 1 つのよりよい方法は &quot;<code>:execute</code>&quot; コマンドを使ふ方法です。文字列の中ではバックスラッシュを前置することで &lt;&gt; 表記が使へます。それまであつたバックスラッシュは \\ といふ風に 2 回重ねるのを忘れないでください。また &rsquo;&quot;&rsquo; の前にもバックスラッシュを前置しなければなりません。
</p><pre class="verbatim">autocmd BufNewFile,BufReadPre * exe &quot;normal O\&lt;C-R&gt;%\&lt;Esc&gt;:.g/\\./s/\\./\\\\./g\&lt;CR&gt;0\&quot;9y$u:menu Buffers.\&lt;C-R&gt;9 :buffer \&lt;C-R&gt;%\&lt;C-V&gt;\&lt;CR&gt;\&lt;CR&gt;&quot;
</pre>
<p>實際のバッファメニューではユーザー定義函數を使ふべきですが (|<a href="eval_002etxt.html#g_t_003afunction">:function</a>| を參照)、さうすると &lt;&gt; 表記は使ひませんので、ここでの例としてそれを使ふのは不適切です。
</p>
<span id="match_002dparens"></span><span id="index-match_002dparens"></span>
<span id="index-Dui-Ying-suruGua-Hu-woQiang-Diao-suru"></span>
<span id="Dui-Ying-suruGua-Hu-woQiang-Diao-suru"></span><h3 class="section">對應する括弧を强調する</h3>

<p>この例はいくつかの高度なトリックを紹介してゐます。
</p><ul>
<li> 自動コマンドイベント |<a href="autocmd_002etxt.html#CursorMoved">CursorMoved</a>| の使ひ方
</li><li> |<a href="eval_002etxt.html#searchpairpos_0028_0029">searchpairpos()</a>| を使つて對應する括弧を見つける方法
</li><li> |<a href="eval_002etxt.html#synID_0028_0029">synID()</a>| を使つてカーソルが文字列やコメントの中にあるかを判定する方法
</li><li> |<a href="pattern_002etxt.html#g_t_003amatch">:match</a>| を使つて何かを强調する方法
</li><li> |<a href="pattern_002etxt.html#pattern">pattern</a>| を使つてファイルの特定の位置にマッチさせる方法
</li></ul>

<p>これはスクリプトローカル變數を使つてゐるので、Vim script ファイル中に書かなければなりません。カーソルが文字列やコメントの中にないならば、文字列やコメントはスキップして檢索します。構文强調が有效になつてゐる必要があります。
</p>
<p>これより若干高度なバージョンがプラグイン |<a href="pi_005fparen_002etxt.html#matchparen">matchparen</a>| の中で使はれてゐます。
</p><pre class="verbatim">let s:paren_hl_on = 0
function s:Highlight_Matching_Paren()
  if s:paren_hl_on
    match none
    let s:paren_hl_on = 0
  endif

  let c_lnum = line('.')
  let c_col = col('.')

  let c = getline(c_lnum)[c_col - 1]
  let plist = split(&amp;matchpairs, ':\|,')
  let i = index(plist, c)
  if i &lt; 0
    return
  endif
  if i % 2 == 0
    let s_flags = 'nW'
    let c2 = plist[i + 1]
  else
    let s_flags = 'nbW'
    let c2 = c
    let c = plist[i - 1]
  endif
  if c == '['
    let c = '\['
    let c2 = '\]'
  endif
  let s_skip ='synIDattr(synID(line(&quot;.&quot;), col(&quot;.&quot;), 0), &quot;name&quot;) ' .
    \ '=~?  &quot;string\\|comment&quot;'
  execute 'if' s_skip '| let s_skip = 0 | endif'

  let [m_lnum, m_col] = searchpairpos(c, '', c2, s_flags, s_skip)

  if m_lnum &gt; 0 &amp;&amp; m_lnum &gt;= line('w0') &amp;&amp; m_lnum &lt;= line('w$')
    exe 'match Search /\(\%' . c_lnum . 'l\%' . c_col .
      \ 'c\)\|\(\%' . m_lnum . 'l\%' . m_col . 'c\)/'
    let s:paren_hl_on = 1
  endif
endfunction

autocmd CursorMoved,CursorMovedI * call s:Highlight_Matching_Paren()
autocmd InsertEnter * match none
</pre><hr>
<div class="header">
<p>
Up: <a href="Mu-Ci-.html" accesskey="u" rel="up">目次</a> &nbsp; [<a href="Indexes-CP.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
